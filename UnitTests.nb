(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     66786,       1700]
NotebookOptionsPosition[     63658,       1642]
NotebookOutlinePosition[     64110,       1659]
CellTagsIndexPosition[     64067,       1656]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["SVD Unit Tests", "Section",
 CellChangeTimes->{{3.854719626482838*^9, 
  3.854719630380569*^9}},ExpressionUUID->"2b604b30-b351-412e-94da-\
e1f152819ebe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getTransSVD", "[", 
    RowBox[{"ptsSrc_", ",", "ptsTgt_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "cent1", ",", "cent2", ",", "matP", ",", "matQ", ",", "mat", ",", "u", 
       ",", "w", ",", "v", ",", "r", ",", "func", ",", "vec"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"getting", " ", "the", " ", "centroid"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cent1", "=", 
       RowBox[{"Mean", "[", "ptsSrc", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cent2", "=", 
       RowBox[{"Mean", "[", "ptsTgt", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"forming", " ", "the", " ", "cross"}], "-", 
        RowBox[{"covariance", " ", "matrix"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"matP", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "-", "cent1"}], ")"}], "&"}], ",", "ptsSrc"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"matQ", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "-", "cent2"}], ")"}], "&"}], ",", "ptsTgt"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mat", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "matP", "]"}], ".", "matQ"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"SVD", " ", "decomposition"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "w", ",", "v"}], "}"}], "=", 
       RowBox[{"SingularValueDecomposition", "[", "mat", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"obtaining", " ", "the", " ", "rotation"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"v", ".", 
        RowBox[{"Transpose", "[", "u", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vec", "=", 
       RowBox[{"cent2", "-", "cent1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "transform", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"func", "[", "pts_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"npts", ",", "nmat", ",", "ncent"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ncent", "=", 
           RowBox[{"Mean", "[", "pts", "]"}]}], ";", 
          RowBox[{"(*", 
           RowBox[{
           "I", " ", "think", " ", "this", " ", "line", " ", "is", " ", "a", 
            " ", 
            RowBox[{"bug", ".", " ", "I"}], " ", "believe", " ", "that", " ", 
            "this", " ", "is", " ", "corrected", " ", "with", " ", "the", " ",
             "following", " ", 
            RowBox[{"line", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"ncent", "=", "cent1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"nmat", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "-", "ncent"}], ")"}], "&"}], ",", "pts"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"npts", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"r", ".", 
             RowBox[{"Transpose", "[", "nmat", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "+", "vec", "+", "ncent"}], ")"}], "&"}], ",", 
            "npts"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "func"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.853926132869824*^9, 3.853926138554863*^9}, {
   3.8539261831848326`*^9, 3.853926184346839*^9}, {3.8539263413318343`*^9, 
   3.853926341711834*^9}, {3.853926431151836*^9, 3.853926551662878*^9}, {
   3.8539266618319216`*^9, 3.853926674865904*^9}, {3.8539285448387637`*^9, 
   3.8539285870037737`*^9}, {3.8539287348027735`*^9, 
   3.8539287357897635`*^9}, {3.853928809390333*^9, 3.853928809729329*^9}, {
   3.853951321008234*^9, 3.853951321540227*^9}, {3.85439042724406*^9, 
   3.85439043442762*^9}, 3.8543904852066174`*^9, {3.854390559605045*^9, 
   3.854390575425205*^9}, {3.8543907112625246`*^9, 3.854390779128992*^9}, 
   3.8543909734234037`*^9, {3.8544845395118895`*^9, 3.8544845468974137`*^9}, {
   3.8544846022427444`*^9, 3.8544846059754233`*^9}, {3.8545656192047186`*^9, 
   3.854565633168626*^9}, {3.8545668809154124`*^9, 3.854566897451014*^9}, {
   3.85463174137718*^9, 3.8546317432765055`*^9}, {3.8546319239443865`*^9, 
   3.8546319581839776`*^9}, {3.8546329341839437`*^9, 3.854632936775815*^9}, {
   3.8546333257933006`*^9, 3.8546333271913*^9}, {3.854633395909602*^9, 
   3.8546333960326023`*^9}, {3.854719402699058*^9, 3.854719410120328*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"a0a94d9d-7240-44ef-80fa-2f3a33135a50"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "random", " ", "points", " ", "to", " ", "test", " ", 
    "on", " ", "in", " ", 
    RowBox[{"c", "++"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RandomSeed", "[", "0", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"randReal", " ", "[", "e_", "]"}], ":=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "e"}], ",", "e"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"perturb", "[", 
      RowBox[{"pts_", ",", "e_"}], "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "+", 
              RowBox[{"RandomReal", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "e"}], ",", "e"}], "}"}], "]"}]}], ")"}], "&"}],
            ",", "#"}], "]"}], ")"}], "&"}], ",", "pts"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"genSVDTest", " ", "[", "n_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "alignSource", ",", " ", "alignTarget", ",", " ", "mapSource", ",", 
        " ", "mapTest", ",", " ", "randVec"}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"alignSource", " ", "=", " ", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"RandomReal", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "100"}], ",", "100"}], "}"}], "]"}], ")"}], 
                "&"}], ",", 
               RowBox[{"Range", "[", "2", "]"}]}], "]"}], ")"}], "&"}], ",", 
           RowBox[{"Range", "[", "5", "]"}]}], "]"}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"randVec", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"randReal", "[", "100", "]"}], ",", " ", 
          RowBox[{"randReal", "[", "100", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Rotate", ",", " ", 
         RowBox[{"then", " ", "translate"}], ",", " ", 
         RowBox[{"then", " ", "add", " ", "random", " ", "noise"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"alignTarget", " ", "=", " ", 
        RowBox[{
         RowBox[{"perturb", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "+", "randVec"}], ")"}], "&"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{
               RowBox[{"RotationMatrix", "[", 
                RowBox[{"randReal", "[", "\[Pi]", "]"}], "]"}], ".", 
               RowBox[{"Transpose", "[", "alignSource", "]"}]}], "]"}]}], 
            "]"}], ",", " ", 
           RowBox[{"randReal", "[", "10", "]"}]}], "]"}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mapSource", " ", "=", " ", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"RandomReal", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "100"}], ",", "100"}], "}"}], "]"}], ")"}], 
                "&"}], ",", 
               RowBox[{"Range", "[", "2", "]"}]}], "]"}], ")"}], "&"}], ",", 
           RowBox[{"Range", "[", "n", "]"}]}], "]"}], " ", "//", "N"}]}], ";",
        "\[IndentingNewLine]", " ", 
       RowBox[{"mapTest", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"getTransSVD", "[", 
           RowBox[{"alignSource", ",", "alignTarget"}], "]"}], "[", 
          "mapSource", "]"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "alignSource", ",", " ", "alignTarget", ",", " ", "mapSource", ",", 
         " ", "mapTest"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ7aPgHrpq+xvHM1OPh4NoEXfbRBC9UmtuLog+kttf
AqIPTFeqANF83Ry1IPrK9ksTQPQvjsdTQfTJ0zNmgOh3l2/OBdH2ZRHzQXRy
oPlWEK21Ih5MM3QuOgCis6wWHgbRdlmyd0H0g8LjD0H0I6ePz0D0DmfhDyD6
XmbtFxC9a5UH52ogbVjiUH4DSOdy/6oA0Tbqs1/J73jjmPFWhl0BSPf8zRYD
0VPON4HpMyfmS4Nov/UucmDx1yl6IHrft1xjED3DI9ocRJu8vREAooNe6aaB
6NKTr8H0tonT/oPowwdmgOkDzuLGikB6WrkzmJ6rei4dRN9iicsA0QB6vLks

  "],
 CellLabel->"In[3]:=",ExpressionUUID->"ac5dcc1c-81fa-489b-8a3f-28a66b52c4bf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Generate", " ", "tests"}], ",", " ", 
    RowBox[{
    "then", " ", "export", " ", "them", " ", "to", " ", "the", " ", 
     "selected", " ", "file"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"svdTests", " ", "=", " ", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"genSVDTest", "[", 
          RowBox[{"#", "*", "10"}], "]"}], ")"}], "&"}], ",", 
       RowBox[{"Range", "[", "250", "]"}]}], "]"}], "//", "N"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
      "\"\<C:\\\\Users\\\\Aiden \
McIlraith\\\\Documents\\\\GitHub\\\\st-visualizer\\\\UnitTest\\\\svd.json\>\"\
", ",", " ", "svdTests"}], "]"}], ";"}], "*)"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ/avXmWf19jeOXDnTBUG0Zt++pBtAumuVXAqILrps
mweirThrwPSZtVXFILpGVaICRF9L16wH0TceXGwG0QyrH3eA6CtS23tAtF13
1yQQbb380hQQXbF58gwQ3dzjPRNEt7xTnAeiH0T6LwXR7IbrFW8C6V96HEog
OvxvoDmItvhZDqb7zuRwMex44xj06DI3iGZZuuoAiFa4mnkEREeoc7+XB9JP
fiwH0y/uZAYrAGmz3ooQEK23ZqehIkj/y6PGINrtoY8HiOZZEwemC7qWZoDo
PDauLBCdZqEU6g2kH4UZh4HopJx9wT4gc6M+hoBoAP9ArcI=
  "],
 CellLabel->"In[7]:=",ExpressionUUID->"66b5d271-859d-4d54-9f95-3b6b58155048"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"89.44135892886192`", ",", 
                 RowBox[{"-", "17.059873179130477`"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "70.6155459097603`"}], ",", 
                 RowBox[{"-", "93.24959847731117`"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"8.011303098569726`", ",", "51.56308532012372`"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"75.27622740093813`", ",", "81.7951643318458`"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1.802694588682698`"}], ",", 
                 RowBox[{"-", "43.60874868084653`"}]}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              TemplateBox[{"1"},
               "OutputSizeLimit`Skeleton"], "}"}], ",", 
             RowBox[{"{", 
              TemplateBox[{"1"},
               "OutputSizeLimit`Skeleton"], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"21.176772223397265`", ",", 
                 RowBox[{"-", "63.69108020988214`"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "114.19552774877369`"}], ",", 
                 "17.09019492402374`"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "40.35080687565061`"}], ",", 
                 RowBox[{"-", "83.19723629992612`"}]}], "}"}], ",", 
               TemplateBox[{"4"},
                "OutputSizeLimit`Skeleton"], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "7.416220290434708`"}], ",", 
                 "50.487864280734634`"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "12.377217609205935`"}], ",", 
                 RowBox[{"-", "57.957286777151765`"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "68.86609378079484`"}], ",", 
                 "53.29024806749646`"}], "}"}]}], "}"}]}], "}"}], ",", 
           TemplateBox[{"248"},
            "OutputSizeLimit`Skeleton"], ",", 
           RowBox[{"{", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton"], "}"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{49.2099609375, {2., 7.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{39.884765625, {0., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 7, 21567919161503855798, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{46.73583984375, {0., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 7, 21567919161503855798, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{34.4970703125, {0., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 7, 21567919161503855798, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{59.73046875, {0., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[21567919161503855798 === $SessionID, 
   Out[7], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{3.8547217078381524`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"7f46b9eb-850d-444e-8cc2-2c8ee112ac57"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Grow and Cover Unit Tests", "Section",
 CellChangeTimes->{{3.854719643548685*^9, 
  3.8547196464274282`*^9}},ExpressionUUID->"e54a7e83-c536-49ea-a4f2-\
0078cba5dab6"],

Cell[CellGroupData[{

Cell["Utility Functions", "Subsection",
 CellChangeTimes->{{3.8547198606405067`*^9, 
  3.854719862817569*^9}},ExpressionUUID->"77c3fdcf-1822-4b86-b1b5-\
ea64519a9c33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Epsilon]", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rotM", "[", "a_", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "a", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "a", "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "a", "]"}], ",", 
        RowBox[{"Cos", "[", "a", "]"}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hexM", "=", 
   RowBox[{"N", "[", 
    RowBox[{"rotM", "[", 
     RowBox[{"\[Pi]", "/", "3"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8547199248780746`*^9, 3.8547199254055085`*^9}, {
   3.8547199948648033`*^9, 3.8547199959850855`*^9}, 3.8547200744933925`*^9, {
   3.854720713727931*^9, 3.8547207196000085`*^9}, {3.854721561638624*^9, 
   3.854721593922825*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"f3d012e2-8e15-4601-a67c-e7d676c36a96"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getCoords", "[", 
    RowBox[{"pt_", ",", "origin_", ",", "v1_", ",", "v2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "v2"}], "}"}], "]"}], "]"}], ".", 
    RowBox[{"(", 
     RowBox[{"pt", "-", "origin"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getPt", "[", 
    RowBox[{"coords_", ",", "origin_", ",", "v1_", ",", "v2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"coords", ".", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "v2"}], "}"}]}], "+", "origin"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8554176841360683`*^9, 3.8554176842741117`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"2387883b-f32f-4285-aa50-0309bf52097a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Init Functions", "Subsection",
 CellChangeTimes->{{3.8547198803285913`*^9, 
  3.854719887618367*^9}},ExpressionUUID->"dfc7d7fc-c947-459f-9f4b-\
6790d75b4d01"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getInliers", "[", 
    RowBox[{"pts_", ",", 
     RowBox[{"{", 
      RowBox[{"origin_", ",", "vec_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intcoords", ",", 
       RowBox[{"vec2", "=", 
        RowBox[{"hexM", ".", "vec"}]}], ",", "inds"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"intcoords", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{"getCoords", "[", 
            RowBox[{"#", ",", "origin", ",", "vec", ",", "vec2"}], "]"}], 
           "]"}], "&"}], ",", "pts"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"inds", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "pts", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{
              RowBox[{
              "pts", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
              "-", 
              RowBox[{"getPt", "[", 
               RowBox[{
                RowBox[{
                "intcoords", "\[LeftDoubleBracket]", "#", 
                 "\[RightDoubleBracket]"}], ",", "origin", ",", "vec", ",", 
                "vec2"}], "]"}]}], "]"}], "<", 
            RowBox[{"\[Epsilon]", "*", 
             RowBox[{"Norm", "[", "vec", "]"}]}]}], ")"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"inds", ",", 
        RowBox[{
        "intcoords", "\[LeftDoubleBracket]", "inds", 
         "\[RightDoubleBracket]"}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"ec6c1561-47e4-406f-ae42-e2715183492b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8554181377767797`*^9, 3.855418138713029*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"3814a64f-1d44-4a24-92e9-20e957332eac"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"initGridInliers", "[", 
    RowBox[{"pts_", ",", "num_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ori", ",", "v", ",", 
       RowBox[{"in", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}]}], ",", "oriTemp", ",", "vTemp", ",", 
       "inTemp"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"oriTemp", "=", 
          RowBox[{
           RowBox[{"RandomSample", "[", 
            RowBox[{"pts", ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vTemp", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Nearest", "[", 
             RowBox[{"pts", ",", "oriTemp", ",", "2"}], "]"}], 
            "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "-", 
           "oriTemp"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"inTemp", "=", 
          RowBox[{"getInliers", "[", 
           RowBox[{"pts", ",", 
            RowBox[{"{", 
             RowBox[{"oriTemp", ",", "vTemp"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
             "inTemp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
              "]"}], ">", 
            RowBox[{"Length", "[", 
             RowBox[{
             "in", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ori", "=", "oriTemp"}], ";", "\[IndentingNewLine]", 
            RowBox[{"v", "=", "vTemp"}], ";", "\[IndentingNewLine]", 
            RowBox[{"in", "=", "inTemp"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "num"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ori", ",", "v"}], "}"}], ",", "in"}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"8b761216-3d42-4f5c-8f6c-b4bbad5e4726"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getGrid", "[", 
    RowBox[{"pts_", ",", 
     RowBox[{"{", 
      RowBox[{"inds_", ",", "intcoords_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ata", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "4", "}"}], ",", 
          RowBox[{"{", "4", "}"}]}], "]"}]}], ",", 
       RowBox[{"atb", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "4", "}"}]}], "]"}]}], ",", "a", ",", 
       RowBox[{"I2", "=", 
        RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ",", "res"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"intcoords", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "*", 
                "I2"}], "+", 
               RowBox[{
                RowBox[{"intcoords", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], "*", 
                "hexM"}]}], "]"}], ",", "I2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ata", "+=", 
          RowBox[{
           RowBox[{"Transpose", "[", "a", "]"}], ".", "a"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"atb", "+=", 
          RowBox[{
           RowBox[{"Transpose", "[", "a", "]"}], ".", 
           RowBox[{"pts", "\[LeftDoubleBracket]", 
            RowBox[{
            "inds", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "\[RightDoubleBracket]"}]}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "inds", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{
        RowBox[{"Inverse", "[", "ata", "]"}], ".", "atb"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"res", "\[LeftDoubleBracket]", 
         RowBox[{"{", 
          RowBox[{"3", ",", "4"}], "}"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"res", "\[LeftDoubleBracket]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"be8a602a-2115-41b6-8928-4ac275979e1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"refineGrid", "[", 
    RowBox[{"pts_", ",", "grid_", ",", "inliers_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ng", "=", "grid"}], ",", 
       RowBox[{"ni", "=", "inliers"}], ",", 
       RowBox[{"num", "=", 
        RowBox[{"Length", "[", 
         RowBox[{
         "inliers", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"num", "<", 
         RowBox[{"Length", "[", "pts", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Iterate\>\"", "]"}], ";"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ng", "=", 
          RowBox[{"getGrid", "[", 
           RowBox[{"pts", ",", "ni"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ni", "=", 
          RowBox[{"getInliers", "[", 
           RowBox[{"pts", ",", "ng"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
             "ni", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}], ">", "num"}], ",", "\[IndentingNewLine]", 
           RowBox[{"num", "=", 
            RowBox[{"Length", "[", 
             RowBox[{
             "ni", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ng", "=", 
       RowBox[{"getGrid", "[", 
        RowBox[{"pts", ",", "ni"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ng", ",", "ni"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"2b7c5a1d-18e5-4dd6-8694-f71a1b5ea898"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getGridAndCoords", "[", 
    RowBox[{"pts_", ",", "num_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grid", ",", "inliers", ",", "v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"grid", ",", "inliers"}], "}"}], "=", 
       RowBox[{"initGridInliers", "[", 
        RowBox[{"pts", ",", "num"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"grid", ",", "inliers"}], "}"}], "=", 
       RowBox[{"refineGrid", "[", 
        RowBox[{"pts", ",", "grid", ",", "inliers"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"hexM", ".", 
        RowBox[{
        "grid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"grid", ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Round", "[", 
            RowBox[{"getCoords", "[", 
             RowBox[{"#", ",", 
              RowBox[{
              "grid", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "grid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", "v2"}], "]"}], "]"}], "&"}], ",", "pts"}], "]"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"c5ad0a84-95cc-4f76-baa6-3bdfbe66f70e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test Displays", "Subsection",
 CellChangeTimes->{{3.8554200710342517`*^9, 
  3.8554200769114094`*^9}},ExpressionUUID->"248d711e-92b6-4b28-b8a0-\
8a992bfe0f6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Test", " ", "Function"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"getRangeRatio", "[", 
      RowBox[{"pts_", ",", "r_"}], "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "r"}], ")"}], 
            RowBox[{"Mean", "[", "#", "]"}]}], "+", 
           RowBox[{"r", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
          ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "r"}], ")"}], 
            RowBox[{"Mean", "[", "#", "]"}]}], "+", 
           RowBox[{"r", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}]}],
          "}"}], "&"}], ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"Min", ",", 
            RowBox[{"Transpose", "[", "pts", "]"}]}], "]"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{"Max", ",", 
            RowBox[{"Transpose", "[", "pts", "]"}]}], "]"}]}], "}"}], "]"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"drawFit", "[", 
      RowBox[{"pts_", ",", 
       RowBox[{"{", 
        RowBox[{"origin_", ",", "vec_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"inds_", ",", "intcoords_"}], "}"}], ",", "ptSize_"}], "]"}], 
     ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "=", 
          RowBox[{"getRangeRatio", "[", 
           RowBox[{"pts", ",", "1.2"}], "]"}]}], ",", 
         RowBox[{"outinds", "=", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "pts", "]"}], "]"}], ",", "inds"}], 
           "]"}]}], ",", "rcoords", ",", "lx", ",", "hx", ",", "ly", ",", 
         "hy", ",", 
         RowBox[{"vec2", "=", 
          RowBox[{"hexM", ".", "vec"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rcoords", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Round", "[", 
             RowBox[{"getCoords", "[", 
              RowBox[{"#", ",", "origin", ",", "vec", ",", "vec2"}], "]"}], 
             "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"r", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"r", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"r", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"r", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"r", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"r", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"r", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"r", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}]}],
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lx", ",", "ly"}], "}"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{"Min", ",", 
           RowBox[{"Transpose", "[", "rcoords", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"hx", ",", "hy"}], "}"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{"Max", ",", 
           RowBox[{"Transpose", "[", "rcoords", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"outlier", " ", "points"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Red", ",", " ", 
              RowBox[{"AbsolutePointSize", "[", "ptSize", "]"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{"Point", ",", 
                RowBox[{
                "pts", "\[LeftDoubleBracket]", "outinds", 
                 "\[RightDoubleBracket]"}]}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"inlier", " ", "points"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Green", ",", " ", 
              RowBox[{"AbsolutePointSize", "[", "ptSize", "]"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{"Point", ",", 
                RowBox[{
                "pts", "\[LeftDoubleBracket]", "inds", 
                 "\[RightDoubleBracket]"}]}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", "grid", " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Black", ",", " ", 
              RowBox[{"AbsolutePointSize", "[", 
               RowBox[{"ptSize", "*", "2"}], "]"}], ",", 
              RowBox[{"Point", "[", "origin", "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Black", ",", 
              RowBox[{"AbsoluteThickness", "[", "ptSize", "]"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{"origin", ",", 
                 RowBox[{"origin", "+", "vec"}]}], "}"}], "]"}]}], "}"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"LightGray", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"getPt", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "ly"}], "}"}], ",", "origin", ",", 
                    "vec", ",", "vec2"}], "]"}], ",", 
                   RowBox[{"getPt", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "hy"}], "}"}], ",", "origin", ",", 
                    "vec", ",", "vec2"}], "]"}]}], "}"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "lx", ",", "hx"}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"getPt", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"lx", ",", "y"}], "}"}], ",", "origin", ",", 
                    "vec", ",", "vec2"}], "]"}], ",", 
                   RowBox[{"getPt", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"hx", ",", "y"}], "}"}], ",", "origin", ",", 
                    "vec", ",", "vec2"}], "]"}]}], "}"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", "ly", ",", "hy"}], "}"}]}], "]"}]}], "}"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"inlier", " ", "grid", " ", "points"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", 
              RowBox[{"AbsolutePointSize", "[", "ptSize", "]"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Point", "[", 
                  RowBox[{"getPt", "[", 
                   RowBox[{"#", ",", "origin", ",", "vec", ",", "vec2"}], 
                   "]"}], "]"}], "&"}], ",", "intcoords"}], "]"}]}], "}"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", "r"}]}], "]"}]}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellLabel->"In[53]:=",ExpressionUUID->"12e7dff8-f568-495a-9977-88c54e98ccd6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pts", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"origin", "=", 
   RowBox[{
    RowBox[{"RandomSample", "[", 
     RowBox[{"pts", ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Nearest", "[", 
      RowBox[{"pts", ",", "origin", ",", "2"}], "]"}], "\[LeftDoubleBracket]",
      "2", "\[RightDoubleBracket]"}], "-", "origin"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grid", "=", 
   RowBox[{"{", 
    RowBox[{"origin", ",", "vec"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.855418212219881*^9, 3.855418272072364*^9}, {
  3.8554183474811783`*^9, 3.855418350959835*^9}, {3.8554183886221933`*^9, 
  3.855418393545022*^9}, {3.8554185179626737`*^9, 3.855418526854001*^9}, {
  3.8554186028293085`*^9, 3.8554186618151584`*^9}, {3.8554187821516657`*^9, 
  3.8554187985115547`*^9}, {3.855418842760935*^9, 3.855418860702612*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"c0fced0b-0eab-4351-910c-27250759478f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<C:\\\\Users\\\\Aiden McIlraith\\\\Documents\\\\GitHub\\\\st-visualizer\
\\\\hexFit.json\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pts", ",", " ", "grid", ",", " ", 
       RowBox[{"getInliers", "[", 
        RowBox[{"pts", ",", " ", "grid"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"pts", ",", " ", "grid", ",", " ", 
       RowBox[{"getInliers", "[", 
        RowBox[{"pts", ",", " ", "grid"}], "]"}]}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.855418862396053*^9, 3.8554189338637724`*^9}, {
  3.855419044278606*^9, 3.855419045703799*^9}, {3.855419089672536*^9, 
  3.8554191617283525`*^9}, {3.8554202671755095`*^9, 3.855420275375902*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"fde88ae4-842b-4571-8ccb-ff5d8634f2cc"],

Cell[BoxData["\<\"C:\\\\Users\\\\Aiden \
McIlraith\\\\Documents\\\\GitHub\\\\st-visualizer\\\\hexFit.json\"\>"], \
"Output",
 CellChangeTimes->{
  3.855419162059573*^9, 3.855419523619036*^9, 3.8554196764915066`*^9, 
   3.855419850439122*^9, {3.8554202770287704`*^9, 3.855420286932373*^9}},
 CellLabel->"Out[78]=",ExpressionUUID->"3cfabb01-ec07-455b-a8b6-6af75303f1b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"importedData", " ", "=", " ", 
   RowBox[{
   "Import", "[", 
    "\"\<C:\\\\Users\\\\Aiden \
McIlraith\\\\Documents\\\\GitHub\\\\st-visualizer\\\\hexFit.json\>\"", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plots", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"plots", ",", 
        RowBox[{"drawFit", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "4"}], "]"}]}], "]"}], ")"}], 
     "&"}], ",", "importedData"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Column", "[", "plots", "]"}]}], "Input",
 CellChangeTimes->{{3.855419191202709*^9, 3.855419251963524*^9}, {
  3.855419331457786*^9, 3.8554194178826103`*^9}, {3.8554194530742984`*^9, 
  3.855419457344658*^9}, {3.8554194897109876`*^9, 3.8554195207619505`*^9}, {
  3.8554195951122017`*^9, 3.855419720109728*^9}, {3.855419751763407*^9, 
  3.8554198284240265`*^9}, {3.855419901181919*^9, 3.8554199089302807`*^9}, {
  3.8554201455544558`*^9, 3.855420194232973*^9}, {3.8554202815687885`*^9, 
  3.8554202833097725`*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"a25d0d31-ea16-4e16-963a-fde9af3130f8"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     GraphicsBox[{
       {RGBColor[1, 0, 0], AbsolutePointSize[4], PointBox[{0, 1}], 
        PointBox[{0, 3}], PointBox[{2, 2}]}, 
       {RGBColor[0, 1, 0], AbsolutePointSize[4], PointBox[{0, 0}], 
        PointBox[{1, -1}], PointBox[{-1, 1}]}, 
       {GrayLevel[0], AbsolutePointSize[8], PointBox[{1, -1}]}, 
       {GrayLevel[0], AbsoluteThickness[4], LineBox[{{1, -1}, {0, 0}}]}, 
       {GrayLevel[
        0.85], {LineBox[{{
          6.098076211353316, -0.9019237886466842}, {-0.7320508075688772, \
-2.732050807568877}}], 
         LineBox[{{5.098076211353316, 
          0.09807621135331579}, {-1.7320508075688772`, \
-1.7320508075688772`}}], 
         LineBox[{{4.098076211353316, 
          1.098076211353316}, {-2.732050807568877, -0.7320508075688772}}], 
         LineBox[{{3.098076211353316, 
          2.098076211353316}, {-3.7320508075688767`, 0.2679491924311228}}], 
         LineBox[{{2.098076211353316, 3.098076211353316}, {-4.732050807568877,
           1.2679491924311228`}}], 
         LineBox[{{1.098076211353316, 4.098076211353316}, {-5.732050807568877,
           2.267949192431123}}]}, {
         LineBox[{{6.098076211353316, -0.9019237886466842}, {
          1.098076211353316, 4.098076211353316}}], 
         LineBox[{{
          4.732050807568877, -1.2679491924311228`}, {-0.2679491924311228, 
          3.7320508075688767`}}], 
         LineBox[{{
          3.3660254037844384`, -1.6339745962155614`}, {-1.6339745962155616`, 
          3.3660254037844384`}}], LineBox[{{2., -2.}, {-3., 3.}}], 
         LineBox[{{
          0.6339745962155614, -2.3660254037844384`}, {-4.366025403784438, 
          2.6339745962155616`}}], 
         LineBox[{{-0.7320508075688772, -2.732050807568877}, \
{-5.732050807568877, 2.267949192431123}}]}}, 
       {RGBColor[0, 0, 1], AbsolutePointSize[4], PointBox[{0., 0.}], 
        PointBox[{1., -1.}], PointBox[{-1., 1.}]}},
      PlotRange->{{-1.2999999999999998`, 2.3}, {-1.4, 3.3999999999999995`}}]},
    {
     GraphicsBox[{
       {RGBColor[1, 0, 0], AbsolutePointSize[4], PointBox[{0, 1}], 
        PointBox[{0, 3}], PointBox[{2, 2}]}, 
       {RGBColor[0, 1, 0], AbsolutePointSize[4], PointBox[{0, 0}], 
        PointBox[{1, -1}], PointBox[{-1, 1}]}, 
       {GrayLevel[0], AbsolutePointSize[8], PointBox[{1, -1}]}, 
       {GrayLevel[0], AbsoluteThickness[4], LineBox[{{1, -1}, {0, 0}}]}, 
       {GrayLevel[
        0.85], {LineBox[{{
          6.098076211353316, -0.9019237886466842}, {-0.7320508075688772, \
-2.732050807568877}}], 
         LineBox[{{5.098076211353316, 
          0.09807621135331579}, {-1.7320508075688772`, \
-1.7320508075688772`}}], 
         LineBox[{{4.098076211353316, 
          1.098076211353316}, {-2.732050807568877, -0.7320508075688772}}], 
         LineBox[{{3.098076211353316, 
          2.098076211353316}, {-3.7320508075688767`, 0.2679491924311228}}], 
         LineBox[{{2.098076211353316, 3.098076211353316}, {-4.732050807568877,
           1.2679491924311228`}}], 
         LineBox[{{1.098076211353316, 4.098076211353316}, {-5.732050807568877,
           2.267949192431123}}]}, {
         LineBox[{{6.098076211353316, -0.9019237886466842}, {
          1.098076211353316, 4.098076211353316}}], 
         LineBox[{{
          4.732050807568877, -1.2679491924311228`}, {-0.2679491924311228, 
          3.7320508075688767`}}], 
         LineBox[{{
          3.3660254037844384`, -1.6339745962155614`}, {-1.6339745962155616`, 
          3.3660254037844384`}}], LineBox[{{2., -2.}, {-3., 3.}}], 
         LineBox[{{
          0.6339745962155614, -2.3660254037844384`}, {-4.366025403784438, 
          2.6339745962155616`}}], 
         LineBox[{{-0.7320508075688772, -2.732050807568877}, \
{-5.732050807568877, 2.267949192431123}}]}}, 
       {RGBColor[0, 0, 1], AbsolutePointSize[4], PointBox[{0., 0.}], 
        PointBox[{1., -1.}], PointBox[{-1., 1.}]}},
      PlotRange->{{-1.2999999999999998`, 2.3}, {-1.4, 3.3999999999999995`}}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.8554197555514164`*^9, 3.8554197746569986`*^9}, {
   3.8554198296318407`*^9, 3.8554198505681086`*^9}, {3.8554198832367983`*^9, 
   3.8554199098126926`*^9}, 3.8554200051550035`*^9, 3.8554200957868977`*^9, 
   3.855420147228739*^9, {3.855420205218897*^9, 3.8554202130522366`*^9}, 
   3.8554202884845405`*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"fed5a2f4-c8e9-49ba-acd0-5138a40b710b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Grow Function", "Subsection",
 CellChangeTimes->{{3.854719898397009*^9, 
  3.854719900125386*^9}},ExpressionUUID->"a477de5e-d422-4d3f-9f52-\
9e0fac8719e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"growAndCover", "[", 
    RowBox[{"pts_", ",", "samples_", ",", "wid_", ",", "num_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hash", ",", 
       RowBox[{"ncoords", "=", 
        RowBox[{"{", "}"}]}], ",", "grid", ",", "coords", ",", "loc", ",", 
       RowBox[{"nghbs", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", "nghbs2", ",", "v2", 
       ",", "bd", ",", "nbd"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Compute", " ", "grid", " ", "and", " ", "coordinates"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"grid", ",", "coords"}], "}"}], "=", 
       RowBox[{"getGridAndCoords", "[", 
        RowBox[{"pts", ",", "num"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"hexM", ".", 
        RowBox[{
        "grid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Store", " ", "existing", " ", "points", " ", "in", " ", "hash"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hash", "[", 
        RowBox[{"_", ",", "_"}], "]"}], "=", "False"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Scan", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"hash", "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "]"}], "=", "True"}], ")"}], "&"}], ",", "coords"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"for", " ", "each", " ", "sample"}], ",", " ", 
        RowBox[{
         RowBox[{
         "if", " ", "its", " ", "nearest", " ", "grid", " ", "point", " ", 
          "and", " ", "or", " ", "any", " ", "of", " ", "its", " ", "6"}], 
         "-", 
         RowBox[{
         "neighbors", " ", "are", " ", "not", " ", "in", " ", "the", " ", 
          "list"}]}], ",", " ", 
        RowBox[{"add", " ", "them", " ", "to", " ", "the", " ", "list"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"nghbs2", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"nghbs", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Scan", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"loc", "=", 
            RowBox[{"Round", "[", 
             RowBox[{"getCoords", "[", 
              RowBox[{"#", ",", 
               RowBox[{
               "grid", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                ",", 
               RowBox[{
               "grid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                ",", "v2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Scan", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"(", 
                  RowBox[{"Apply", "[", 
                   RowBox[{"hash", ",", 
                    RowBox[{"loc", "+", "#"}]}], "]"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"hash", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "loc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    "loc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], "=", "True"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"ncoords", ",", 
                   RowBox[{"loc", "+", "#"}]}], "]"}]}]}], "]"}], "&"}], ",", 
             "nghbs2"}], "]"}]}], ")"}], "&"}], ",", "\[IndentingNewLine]", 
        "samples"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "growing", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"bd", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"coords", ",", "ncoords"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "queue", " ", "of", " ", "points", " ", "added", " ", "in", " ", "the",
         " ", "previous", " ", "iteration"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"nbd", "=", 
          RowBox[{"{", "}"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "queue", " ", "of", " ", "points", " ", "added", " ", "in", " ", 
           "this", " ", "iteration"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Scan", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"loc", "=", "#"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Scan", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"!", 
                    RowBox[{"(", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"hash", ",", 
                    RowBox[{"loc", "+", "#"}]}], "]"}], ")"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"hash", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "loc", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    "loc", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], "=", "True"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"ncoords", ",", 
                    RowBox[{"loc", "+", "#"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"nbd", ",", 
                    RowBox[{"loc", "+", "#"}]}], "]"}]}]}], "]"}], "&"}], ",",
                 "nghbs"}], "]"}]}], ")"}], "&"}], ",", "\[IndentingNewLine]",
            "bd"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"bd", "=", "nbd"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "wid"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"getPt", "[", 
          RowBox[{"#", ",", 
           RowBox[{
           "grid", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "grid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           ",", "v2"}], "]"}], "&"}], ",", "ncoords"}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"8e7c0eb3-d75e-430b-8147-1debc8b3b07f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Use", " ", "thresholded", " ", "deviation", " ", "from", " ", "point", " ",
    "grid", " ", "to", " ", "unit", " ", "text", " ", "hexfit", " ", 
   "functionality"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8547226573157043`*^9, 3.854722669660211*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"f29c48a7-fc2a-4409-9450-3808bf55a599"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1141.2, 574.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->Association["TryRealOnly" -> False],
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f8336a59-102d-4ad8-af98-f67afadf597a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 159, 3, 67, "Section",ExpressionUUID->"2b604b30-b351-412e-94da-e1f152819ebe"],
Cell[742, 27, 5324, 119, 504, "Input",ExpressionUUID->"a0a94d9d-7240-44ef-80fa-2f3a33135a50"],
Cell[6069, 148, 4904, 131, 257, "Input",ExpressionUUID->"ac5dcc1c-81fa-489b-8a3f-28a66b52c4bf"],
Cell[CellGroupData[{
Cell[10998, 283, 1314, 34, 67, "Input",ExpressionUUID->"66b5d271-859d-4d54-9f95-3b6b58155048"],
Cell[12315, 319, 11198, 285, 138, "Output",ExpressionUUID->"7f46b9eb-850d-444e-8cc2-2c8ee112ac57"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[23562, 610, 172, 3, 53, "Section",ExpressionUUID->"e54a7e83-c536-49ea-a4f2-0078cba5dab6"],
Cell[CellGroupData[{
Cell[23759, 617, 167, 3, 54, "Subsection",ExpressionUUID->"77c3fdcf-1822-4b86-b1b5-ea64519a9c33"],
Cell[23929, 622, 1036, 28, 67, "Input",ExpressionUUID->"f3d012e2-8e15-4601-a67c-e7d676c36a96"],
Cell[24968, 652, 803, 21, 48, "Input",ExpressionUUID->"2387883b-f32f-4285-aa50-0309bf52097a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25808, 678, 164, 3, 54, "Subsection",ExpressionUUID->"dfc7d7fc-c947-459f-9f4b-6790d75b4d01"],
Cell[25975, 683, 1827, 50, 86, "Input",ExpressionUUID->"ec6c1561-47e4-406f-ae42-e2715183492b"],
Cell[27805, 735, 172, 2, 28, "Input",ExpressionUUID->"3814a64f-1d44-4a24-92e9-20e957332eac"],
Cell[27980, 739, 2314, 61, 200, "Input",ExpressionUUID->"8b761216-3d42-4f5c-8f6c-b4bbad5e4726"],
Cell[30297, 802, 2643, 70, 143, "Input",ExpressionUUID->"be8a602a-2115-41b6-8928-4ac275979e1a"],
Cell[32943, 874, 2007, 51, 200, "Input",ExpressionUUID->"2b7c5a1d-18e5-4dd6-8694-f71a1b5ea898"],
Cell[34953, 927, 1539, 42, 105, "Input",ExpressionUUID->"c5ad0a84-95cc-4f76-baa6-3bdfbe66f70e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36529, 974, 165, 3, 54, "Subsection",ExpressionUUID->"248d711e-92b6-4b28-b8a0-8a992bfe0f6a"],
Cell[36697, 979, 8798, 217, 428, "Input",ExpressionUUID->"12e7dff8-f568-495a-9977-88c54e98ccd6"],
Cell[45498, 1198, 1579, 43, 86, "Input",ExpressionUUID->"c0fced0b-0eab-4351-910c-27250759478f"],
Cell[CellGroupData[{
Cell[47102, 1245, 844, 19, 48, "Input",ExpressionUUID->"fde88ae4-842b-4571-8ccb-ff5d8634f2cc"],
Cell[47949, 1266, 368, 6, 32, "Output",ExpressionUUID->"3cfabb01-ec07-455b-a8b6-6af75303f1b6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48354, 1277, 1465, 35, 86, "Input",ExpressionUUID->"a25d0d31-ea16-4e16-963a-fde9af3130f8"],
Cell[49822, 1314, 4564, 90, 456, "Output",ExpressionUUID->"fed5a2f4-c8e9-49ba-acd0-5138a40b710b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[54435, 1410, 165, 3, 54, "Subsection",ExpressionUUID->"a477de5e-d422-4d3f-9f52-9e0fac8719e5"],
Cell[54603, 1415, 8648, 214, 657, "Input",ExpressionUUID->"8e7c0eb3-d75e-430b-8147-1debc8b3b07f"],
Cell[63254, 1631, 376, 7, 28, "Input",ExpressionUUID->"f29c48a7-fc2a-4409-9450-3808bf55a599"]
}, Open  ]]
}, Open  ]]
}
]
*)

