(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16340,        402]
NotebookOptionsPosition[     15517,        381]
NotebookOutlinePosition[     15969,        398]
CellTagsIndexPosition[     15926,        395]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getTransSVD", "[", 
    RowBox[{"ptsSrc_", ",", "ptsTgt_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "cent1", ",", "cent2", ",", "matP", ",", "matQ", ",", "mat", ",", "u", 
       ",", "w", ",", "v", ",", "r", ",", "func", ",", "vec"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"getting", " ", "the", " ", "centroid"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cent1", "=", 
       RowBox[{"Mean", "[", "ptsSrc", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cent2", "=", 
       RowBox[{"Mean", "[", "ptsTgt", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"forming", " ", "the", " ", "cross"}], "-", 
        RowBox[{"covariance", " ", "matrix"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"matP", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "-", "cent1"}], ")"}], "&"}], ",", "ptsSrc"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"matQ", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "-", "cent2"}], ")"}], "&"}], ",", "ptsTgt"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mat", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "matP", "]"}], ".", "matQ"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"SVD", " ", "decomposition"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "w", ",", "v"}], "}"}], "=", 
       RowBox[{"SingularValueDecomposition", "[", "mat", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"obtaining", " ", "the", " ", "rotation"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"v", ".", 
        RowBox[{"Transpose", "[", "u", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vec", "=", 
       RowBox[{"cent2", "-", "cent1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "transform", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"func", "[", "pts_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"npts", ",", "nmat", ",", "ncent"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ncent", "=", 
           RowBox[{"Mean", "[", "pts", "]"}]}], ";", 
          RowBox[{"(*", 
           RowBox[{
           "I", " ", "think", " ", "this", " ", "line", " ", "is", " ", 
            RowBox[{"wrong", ".", " ", "I"}], " ", "believe", " ", "that", 
            " ", "this", " ", "is", " ", "corrected", " ", "in", " ", "my", 
            " ", 
            RowBox[{"code", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"ncent", "=", "cent1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"nmat", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "-", "ncent"}], ")"}], "&"}], ",", "pts"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"npts", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"r", ".", 
             RowBox[{"Transpose", "[", "nmat", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "+", "vec", "+", "ncent"}], ")"}], "&"}], ",", 
            "npts"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "func"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.853926132869824*^9, 3.853926138554863*^9}, {
   3.8539261831848326`*^9, 3.853926184346839*^9}, {3.8539263413318343`*^9, 
   3.853926341711834*^9}, {3.853926431151836*^9, 3.853926551662878*^9}, {
   3.8539266618319216`*^9, 3.853926674865904*^9}, {3.8539285448387637`*^9, 
   3.8539285870037737`*^9}, {3.8539287348027735`*^9, 
   3.8539287357897635`*^9}, {3.853928809390333*^9, 3.853928809729329*^9}, {
   3.853951321008234*^9, 3.853951321540227*^9}, {3.85439042724406*^9, 
   3.85439043442762*^9}, 3.8543904852066174`*^9, {3.854390559605045*^9, 
   3.854390575425205*^9}, {3.8543907112625246`*^9, 3.854390779128992*^9}, 
   3.8543909734234037`*^9, {3.8544845395118895`*^9, 3.8544845468974137`*^9}, {
   3.8544846022427444`*^9, 3.8544846059754233`*^9}, {3.8545656192047186`*^9, 
   3.854565633168626*^9}, {3.8545668809154124`*^9, 3.854566897451014*^9}, {
   3.85463174137718*^9, 3.8546317432765055`*^9}, {3.8546319239443865`*^9, 
   3.8546319581839776`*^9}, {3.8546329341839437`*^9, 3.854632936775815*^9}, {
   3.8546333257933006`*^9, 3.8546333271913*^9}, {3.854633395909602*^9, 
   3.8546333960326023`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"a0a94d9d-7240-44ef-80fa-2f3a33135a50"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getTransSVD", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "10"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.8539262070718346`*^9, 3.853926308921833*^9}, {
  3.853926350586833*^9, 3.8539263927448425`*^9}, {3.853926454740864*^9, 
  3.8539264770778885`*^9}, {3.8539265192929087`*^9, 3.8539265255958776`*^9}, {
  3.8539266804769325`*^9, 3.8539267079350214`*^9}, {3.8539268439672413`*^9, 
  3.853926844092244*^9}, {3.8539268811052413`*^9, 3.8539269361142426`*^9}, {
  3.853927028003765*^9, 3.8539270423836713`*^9}, {3.8539278165216303`*^9, 
  3.853927896545647*^9}, {3.8539283583857603`*^9, 3.8539283602017603`*^9}, {
  3.8539284500777693`*^9, 3.8539284605757604`*^9}, {3.854390530803734*^9, 
  3.8543905368133025`*^9}, {3.854390825953171*^9, 3.854390864262497*^9}, {
  3.8543910629941263`*^9, 3.8543910922661023`*^9}, {3.854566997299475*^9, 
  3.8545670083706303`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"b283d4ab-1c42-450a-935b-f0bba7944c0f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.886579864025407`*^-15"}], ",", "2.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.19999999999999696`"}], ",", 
     RowBox[{"-", "1.6000000000000003`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.19999999999999957`", ",", "0.6`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8539264777218657`*^9, 3.8539265540998793`*^9}, {
   3.853926665141905*^9, 3.853926709307991*^9}, 3.853926844807263*^9, 
   3.8539269632882643`*^9, 3.853927043478686*^9, {3.853927838103635*^9, 
   3.85392785439867*^9}, {3.8539278883646603`*^9, 3.8539278969776382`*^9}, 
   3.8539283150970073`*^9, 3.853928361027791*^9, {3.8539284556617928`*^9, 
   3.853928461122797*^9}, {3.853928547285776*^9, 3.8539285889157825`*^9}, 
   3.8543904402511826`*^9, {3.85439048880284*^9, 3.854390493313896*^9}, 
   3.8543905383694625`*^9, {3.85439073736277*^9, 3.8543907826342325`*^9}, {
   3.8543908268869095`*^9, 3.8543908648531437`*^9}, 3.8543909773944187`*^9, 
   3.8543910089160476`*^9, {3.8543910457613277`*^9, 3.8543910927736087`*^9}, 
   3.854391348365958*^9, 3.8544842622199078`*^9, 3.8544846215702124`*^9, 
   3.8545669118856115`*^9, {3.8545669994489*^9, 3.8545670089052005`*^9}, 
   3.854630898765505*^9, 3.8546315474573383`*^9, 3.8546317485447936`*^9, {
   3.854633386453615*^9, 3.8546334135251713`*^9}, 3.8546335568316436`*^9, 
   3.854633590951508*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"67b789ca-c690-4584-9f89-1396e2737029"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "random", " ", "points", " ", "to", " ", "test", " ", 
    "on", " ", "in", " ", 
    RowBox[{"c", "++"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RandomSeed", "[", "0", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"randReal", " ", "[", "e_", "]"}], ":=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "e"}], ",", "e"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"perturb", "[", 
      RowBox[{"pts_", ",", "e_"}], "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "+", 
              RowBox[{"RandomReal", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "e"}], ",", "e"}], "}"}], "]"}]}], ")"}], "&"}],
            ",", "#"}], "]"}], ")"}], "&"}], ",", "pts"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"genSVDTest", " ", "[", "n_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "alignSource", ",", " ", "alignTarget", ",", " ", "mapSource", ",", 
        " ", "mapTest", ",", " ", "randVec"}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"alignSource", " ", "=", " ", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"RandomReal", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "100"}], ",", "100"}], "}"}], "]"}], ")"}], 
                "&"}], ",", 
               RowBox[{"Range", "[", "2", "]"}]}], "]"}], ")"}], "&"}], ",", 
           RowBox[{"Range", "[", "5", "]"}]}], "]"}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"randVec", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"randReal", "[", "100", "]"}], ",", " ", 
          RowBox[{"randReal", "[", "100", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Rotate", ",", " ", 
         RowBox[{"then", " ", "translate"}], ",", " ", 
         RowBox[{"then", " ", "add", " ", "random", " ", "noise"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"alignTarget", " ", "=", " ", 
        RowBox[{
         RowBox[{"perturb", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "+", "randVec"}], ")"}], "&"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{
               RowBox[{"RotationMatrix", "[", 
                RowBox[{"randReal", "[", "\[Pi]", "]"}], "]"}], ".", 
               RowBox[{"Transpose", "[", "alignSource", "]"}]}], "]"}]}], 
            "]"}], ",", " ", 
           RowBox[{"randReal", "[", "10", "]"}]}], "]"}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mapSource", " ", "=", " ", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"RandomReal", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "100"}], ",", "100"}], "}"}], "]"}], ")"}], 
                "&"}], ",", 
               RowBox[{"Range", "[", "2", "]"}]}], "]"}], ")"}], "&"}], ",", 
           RowBox[{"Range", "[", "n", "]"}]}], "]"}], " ", "//", "N"}]}], ";",
        "\[IndentingNewLine]", " ", 
       RowBox[{"mapTest", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"getTransSVD", "[", 
           RowBox[{"alignSource", ",", "alignTarget"}], "]"}], "[", 
          "mapSource", "]"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "alignSource", ",", " ", "alignTarget", ",", " ", "mapSource", ",", 
         " ", "mapTest"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ7aPgHrpq+xvHM1OPh4NoEXfbRBC9UmtuLog+kttf
AqIPTFeqANF83Ry1IPrK9ksTQPQvjsdTQfTJ0zNmgOh3l2/OBdH2ZRHzQXRy
oPlWEK21Ih5MM3QuOgCis6wWHgbRdlmyd0H0g8LjD0H0I6ePz0D0DmfhDyD6
XmbtFxC9a5UH52ogbVjiUH4DSOdy/6oA0Tbqs1/J73jjmPFWhl0BSPf8zRYD
0VPON4HpMyfmS4Nov/UucmDx1yl6IHrft1xjED3DI9ocRJu8vREAooNe6aaB
6NKTr8H0tonT/oPowwdmgOkDzuLGikB6WrkzmJ6rei4dRN9iicsA0QB6vLks

  "],ExpressionUUID->"ac5dcc1c-81fa-489b-8a3f-28a66b52c4bf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"svdTests", " ", "=", " ", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"genSVDTest", "[", 
         RowBox[{"#", "*", "10"}], "]"}], ")"}], "&"}], ",", 
      RowBox[{"Range", "[", "250", "]"}]}], "]"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<C:\\\\Users\\\\Aiden \
McIlraith\\\\Documents\\\\GitHub\\\\st-visualizer\\\\UnitTest\\\\svd.json\>\"\
", ",", " ", "svdTests"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.854391394111081*^9, 3.8543914367319384`*^9}, {
  3.8544842459548535`*^9, 3.8544842569583178`*^9}, {3.854484337932061*^9, 
  3.8544843398761263`*^9}, {3.8544843798337154`*^9, 3.8544844167545757`*^9}, {
  3.8544844732939253`*^9, 3.8544845105586967`*^9}, {3.854484551114624*^9, 
  3.854484581722025*^9}, {3.8544846283294973`*^9, 3.854484646582914*^9}, {
  3.854484676615658*^9, 3.8544846823609023`*^9}, {3.8544847210603657`*^9, 
  3.854484778479721*^9}, {3.854485773474735*^9, 3.8544857762557344`*^9}, {
  3.8544859465621753`*^9, 3.854485947749172*^9}, {3.85456545939997*^9, 
  3.854565470621377*^9}, {3.8545669173326435`*^9, 3.854566947307266*^9}, {
  3.8546307763485527`*^9, 3.854630781249132*^9}, {3.854631579308216*^9, 
  3.8546315877672377`*^9}, {3.854633357802268*^9, 3.8546333741847315`*^9}, {
  3.854633538402499*^9, 3.854633538958502*^9}, {3.854633797173149*^9, 
  3.854633808313285*^9}},ExpressionUUID->"66b5d271-859d-4d54-9f95-\
3b6b58155048"]
},
WindowSize->{1141.2, 574.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->Association["TryRealOnly" -> False],
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f8336a59-102d-4ad8-af98-f67afadf597a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5236, 118, 504, "Input",ExpressionUUID->"a0a94d9d-7240-44ef-80fa-2f3a33135a50"],
Cell[CellGroupData[{
Cell[5819, 142, 1738, 42, 28, "Input",ExpressionUUID->"b283d4ab-1c42-450a-935b-f0bba7944c0f"],
Cell[7560, 186, 1523, 27, 35, "Output",ExpressionUUID->"67b789ca-c690-4584-9f89-1396e2737029"]
}, Open  ]],
Cell[9098, 216, 4881, 130, 257, "Input",ExpressionUUID->"ac5dcc1c-81fa-489b-8a3f-28a66b52c4bf"],
Cell[13982, 348, 1531, 31, 48, "Input",ExpressionUUID->"66b5d271-859d-4d54-9f95-3b6b58155048"]
}
]
*)

