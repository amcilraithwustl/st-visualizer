(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    246750,       5613]
NotebookOptionsPosition[    229898,       5380]
NotebookOutlinePosition[    230314,       5396]
CellTagsIndexPosition[    230271,       5393]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["3D reconstruction from spatial transcriptome data", "Title",
 CellChangeTimes->{{3.81531621937848*^9, 
  3.8153162291688833`*^9}},ExpressionUUID->"aa7319c9-a1ab-44fd-99f1-\
ab7c41d8f07e"],

Cell["Tao Ju (Dec 2020)", "Subtitle",
 CellChangeTimes->{{3.821443091819654*^9, 
  3.8214431286003156`*^9}},ExpressionUUID->"2bcf7d08-5db1-4962-b83e-\
c47cef2fe944"],

Cell[CellGroupData[{

Cell["Code", "Section",
 CellChangeTimes->{{3.8153166143060656`*^9, 
  3.8153166162573957`*^9}},ExpressionUUID->"c03e6af6-610e-4b74-884b-\
27085b74b71b"],

Cell["\<\
Need to run the code in \[OpenCurlyDoubleQuote]multimat_contour.nb\
\[CloseCurlyDoubleQuote] and \[OpenCurlyDoubleQuote]hexfit.nb\
\[CloseCurlyDoubleQuote]\
\>", "Text",
 CellChangeTimes->{{3.815690563071705*^9, 3.815690572273484*^9}, 
   3.8214409791694927`*^9, {3.82152758790724*^9, 
   3.8215275921872263`*^9}},ExpressionUUID->"3453067a-3e33-4d4b-887b-\
307016384b8c"],

Cell[CellGroupData[{

Cell["Hex grid", "Subsection",
 CellChangeTimes->{{3.8153174411495333`*^9, 
  3.815317442214181*^9}},ExpressionUUID->"0c54e5a9-25c0-4559-8d4f-\
68a70a8e16ba"],

Cell[TextData[{
 "Generate a hex grid with dimension ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[Times]", "m"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "d058d4b7-444d-42f9-a092-bf104da204e5"],
 " and spacing ",
 Cell[BoxData[
  FormBox["len", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "45684c5c-c346-43d9-9e31-e1f7d3648ae1"],
 ", whose lower-left corner is at ",
 Cell[BoxData[
  FormBox["lowleft", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "362b3778-5c21-409a-96fd-1dee4ebe2bfb"],
 ", with rotation angle ",
 Cell[BoxData[
  FormBox["rot", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "f0ba44e8-9dc1-449f-9ec3-1af41f4a957a"],
 ", and at z coordinate ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "047efb2b-dbdc-42ed-9e36-5ad582589bad"],
 ":"
}], "Text",
 CellChangeTimes->{{3.815612888158017*^9, 
  3.8156129559650564`*^9}},ExpressionUUID->"6c6d3fea-004d-4ecc-b25a-\
264b9b778cf7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"genHexGrid", "[", 
    RowBox[{
    "n_", ",", "m_", ",", "len_", ",", "lowleft_", ",", "rot_", ",", "z_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"h", "=", 
        RowBox[{"len", "*", 
         RowBox[{
          SqrtBox["3"], "/", "2"}]}]}], ",", "pts", ",", 
       RowBox[{"rotM", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "rot", "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"Sin", "[", "rot", "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sin", "[", "rot", "]"}], ",", 
            RowBox[{"Cos", "[", "rot", "]"}]}], "}"}]}], "}"}]}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"N", "[", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Append", "[", 
          RowBox[{"#", ",", "z"}], "]"}], "&"}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", "i", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"long", " ", "line"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"rotM", ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "len"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "h"}]}], "}"}]}], 
                 "+", "lowleft"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"short", " ", "line"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"rotM", ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", ".5"}], ")"}], "*", "len"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "h"}]}], "}"}]}], 
                 "+", "lowleft"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "m"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
       "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8156124180855303`*^9, 3.8156124250972214`*^9}, {
  3.8156125077602825`*^9, 3.8156125379870358`*^9}, {3.8156125755053587`*^9, 
  3.8156127203241234`*^9}, {3.815612764928097*^9, 3.8156128117210484`*^9}, {
  3.815612857405514*^9, 3.815612881651087*^9}, {3.8156129266358767`*^9, 
  3.81561300048707*^9}, {3.815613040938995*^9, 3.8156130654004593`*^9}, {
  3.8156131048111935`*^9, 3.815613112844398*^9}, {3.815613151209307*^9, 
  3.8156131988738365`*^9}, {3.815613499906843*^9, 3.815613511607327*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"8007f3b2-945b-4f19-b9a5-f27fa32b6236"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Importing", "Subsection",
 CellChangeTimes->{{3.8172096515537643`*^9, 
  3.817209660613562*^9}},ExpressionUUID->"dc029ada-62df-45e8-8eac-\
ce37a75654da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"ToFileName", "[", 
    RowBox[{"Extract", "[", 
     RowBox[{
      RowBox[{"\"\<FileName\>\"", "/.", 
       RowBox[{"NotebookInformation", "[", 
        RowBox[{"EvaluationNotebook", "[", "]"}], "]"}]}], ",", 
      RowBox[{"{", "1", "}"}], ",", "FrontEnd`FileName"}], "]"}], "]"}], 
   "]"}], ";"}]], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"91f9d196-3f9e-4486-8186-85981a9dcb4b"],

Cell[TextData[{
 "The following function takes in a tsv file, the list of slice names, index \
of column for slice name, the index for \[OpenCurlyDoubleQuote]tissue\
\[CloseCurlyDoubleQuote] flag, the indices of the column for \
\[OpenCurlyDoubleQuote]row\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]col\[CloseCurlyDoubleQuote] coordinates, the index of \
the column for \[OpenCurlyDoubleQuote]cluster\[CloseCurlyDoubleQuote],  index \
of column for feature values,  Z spacing, and a list of source+target points \
for each slice (except for the first one) for computing alignment. It returns \
",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"slices", ",", "clusters", ",", "vals", ",", "featureNames"}], 
    "}"}], TraditionalForm]],ExpressionUUID->
  "194fd316-52f9-42a6-ba95-0bc1d846c56c"],
 ", where slices are the locations of points on each slice, clusters are the \
cluster index at each point, and vals are the feature values at each point, \
and featureNames are the names of the features."
}], "Text",
 CellChangeTimes->{{3.817210455719859*^9, 3.8172105686666517`*^9}, {
  3.817216342340977*^9, 3.8172163627962184`*^9}, {3.8172176861812687`*^9, 
  3.8172176943239336`*^9}, {3.817248479181898*^9, 3.817248516941434*^9}, {
  3.817250465979241*^9, 3.817250498147005*^9}, {3.81755091788476*^9, 
  3.8175509263351126`*^9}},ExpressionUUID->"6f40898d-0c7a-41b3-a001-\
48761a349764"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"numRANSAC", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"widBuffer", "=", "2"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8215755398927093`*^9, 3.821575562048275*^9}, {
  3.8215756350689096`*^9, 3.8215756363063273`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"be1f8e57-3986-4ce2-83e0-d0f786a49074"],

Cell[BoxData[
 RowBox[{
  RowBox[{"loadTSV", "[", 
   RowBox[{
   "fname_", ",", "sliceNames_", ",", "sliceInd_", ",", "tissueInd_", ",", 
    "rowcolInds_", ",", "clusterInd_", ",", "featureInds_", ",", "zDis_", ",",
     "srctgts_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "slices", ",", "vals", ",", "clusters", ",", "tab", ",", "records", ",", 
      "nclusters", ",", "nfeatures", ",", "nm", ",", 
      RowBox[{"xyInds", "=", 
       RowBox[{"Reverse", "[", "rowcolInds", "]"}]}], ",", "names", ",", 
      "nslices"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tab", "=", 
      RowBox[{"Import", "[", "fname", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"names", "=", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"tab", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "featureInds"}], "\[RightDoubleBracket]"}], ",", 
        "\"\<No tissue\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tab", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"tab", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"nclusters", " ", "=", " ", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"tab", "\[LeftDoubleBracket]", 
           RowBox[{";;", ",", "clusterInd"}], "\[RightDoubleBracket]"}], ",", 
          "NumberQ"}], "]"}], "]"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nfeatures", "=", 
      RowBox[{"Length", "[", "featureInds", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"records", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"nm", "=", "#"}], ";", 
           RowBox[{"Select", "[", 
            RowBox[{"tab", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "sliceInd", 
                  "\[RightDoubleBracket]"}], "\[Equal]", "nm"}], "&&", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "tissueInd", 
                  "\[RightDoubleBracket]"}], "\[Equal]", "1"}]}], ")"}], 
              "&"}]}], "]"}]}], ")"}], "&"}], ",", "sliceNames"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"slices", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"records", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", ";;", ",", "xyInds"}], "\[RightDoubleBracket]"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"getTransSVD", "[", 
            RowBox[{
             RowBox[{"srctgts", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}],
              ",", 
             RowBox[{"srctgts", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", "2"}], 
              "\[RightDoubleBracket]"}]}], "]"}], "[", 
           RowBox[{"records", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", ";;", ",", "xyInds"}], 
            "\[RightDoubleBracket]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "sliceNames", "]"}]}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"clusters", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "tissueInd", 
                "\[RightDoubleBracket]"}], "\[Equal]", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"getClusterArray", "[", 
               RowBox[{
                RowBox[{"nclusters", "+", "1"}], ",", 
                RowBox[{"nclusters", "+", "1"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"getClusterArray", "[", 
               RowBox[{
                RowBox[{"nclusters", "+", "1"}], ",", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "clusterInd", 
                  "\[RightDoubleBracket]"}], "+", "1"}]}], "]"}]}], "]"}], 
            "&"}], ",", "#"}], "]"}], "&"}], ",", "records"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vals", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "tissueInd", 
                "\[RightDoubleBracket]"}], "\[Equal]", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"getClusterArray", "[", 
               RowBox[{
                RowBox[{"nfeatures", "+", "1"}], ",", 
                RowBox[{"nfeatures", "+", "1"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "featureInds", 
                 "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "]"}], "&"}],
            ",", "#"}], "]"}], "&"}], ",", "records"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Add", " ", "buffer", " ", "to", " ", "each", " ", "slice", " ", "and", 
       " ", "cover", " ", "neighboring", " ", "slices"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"nslices", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Switch", "[", 
         RowBox[{
         "i", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
          RowBox[{"growAndCover", "[", 
           RowBox[{
            RowBox[{
            "slices", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"slices", "\[LeftDoubleBracket]", 
             RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
            "widBuffer", ",", "numRANSAC"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Length", "[", "slices", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"growAndCover", "[", 
           RowBox[{
            RowBox[{
            "slices", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"slices", "\[LeftDoubleBracket]", 
             RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}], ",", 
            "widBuffer", ",", "numRANSAC"}], "]"}], ",", 
          "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
          RowBox[{"growAndCover", "[", 
           RowBox[{
            RowBox[{
            "slices", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"slices", "\[LeftDoubleBracket]", 
               RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"slices", "\[LeftDoubleBracket]", 
               RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
            ",", "widBuffer", ",", "numRANSAC"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "slices", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"slices", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{"#", ",", 
             RowBox[{"i", "*", "zDis"}]}], "]"}], "&"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
            "slices", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "nslices", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "slices", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"clusters", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"#1", ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"getClusterArray", "[", 
               RowBox[{
                RowBox[{"nclusters", "+", "1"}], ",", 
                RowBox[{"nclusters", "+", "1"}]}], "]"}], "&"}], ",", "#2"}], 
            "]"}]}], "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"clusters", ",", "nslices"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vals", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"#1", ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"getClusterArray", "[", 
               RowBox[{
                RowBox[{"nfeatures", "+", "1"}], ",", 
                RowBox[{"nfeatures", "+", "1"}]}], "]"}], "&"}], ",", "#2"}], 
            "]"}]}], "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"vals", ",", "nslices"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "add", " ", "empty", " ", "top", " ", "and", " ", "bottom", " ", 
       "slices"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"slices", "=", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"slices", ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "+", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "zDis"}], "}"}]}], ")"}], "&"}], 
            ",", 
            RowBox[{"Last", "[", "slices", "]"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "zDis"}]}], "}"}]}], ")"}], "&"}], ",", 
          RowBox[{"First", "[", "slices", "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"clusters", "=", "\[IndentingNewLine]", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"clusters", ",", "\[IndentingNewLine]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"getClusterArray", "[", 
              RowBox[{
               RowBox[{"nclusters", "+", "1"}], ",", 
               RowBox[{"nclusters", "+", "1"}]}], "]"}], "&"}], ",", 
            RowBox[{"Last", "[", "slices", "]"}]}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"getClusterArray", "[", 
            RowBox[{
             RowBox[{"nclusters", "+", "1"}], ",", 
             RowBox[{"nclusters", "+", "1"}]}], "]"}], "&"}], ",", 
          RowBox[{"First", "[", "slices", "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vals", "=", "\[IndentingNewLine]", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"vals", ",", "\[IndentingNewLine]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"getClusterArray", "[", 
              RowBox[{
               RowBox[{"nfeatures", "+", "1"}], ",", 
               RowBox[{"nfeatures", "+", "1"}]}], "]"}], "&"}], ",", 
            RowBox[{"Last", "[", "slices", "]"}]}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"getClusterArray", "[", 
            RowBox[{
             RowBox[{"nfeatures", "+", "1"}], ",", 
             RowBox[{"nfeatures", "+", "1"}]}], "]"}], "&"}], ",", 
          RowBox[{"First", "[", "slices", "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"slices", ",", "clusters", ",", "vals", ",", "names"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8172105700979757`*^9, 3.8172106512104692`*^9}, {
   3.817216346097906*^9, 3.817216367785036*^9}, {3.817216399749303*^9, 
   3.8172164144524317`*^9}, {3.8172171190432234`*^9, 
   3.8172172032446756`*^9}, {3.817217267071499*^9, 3.8172172682069664`*^9}, {
   3.8172174026759033`*^9, 3.817217414587185*^9}, {3.817217617203515*^9, 
   3.817217669127042*^9}, {3.8172177049964375`*^9, 3.817217706681246*^9}, {
   3.817217782821074*^9, 3.817217820131215*^9}, {3.8172178654193363`*^9, 
   3.817217896740556*^9}, {3.8172179729315357`*^9, 3.817218016467047*^9}, {
   3.8172182484636745`*^9, 3.817218292313233*^9}, {3.8172184093481693`*^9, 
   3.8172184281636047`*^9}, {3.817218464969282*^9, 3.8172185076588593`*^9}, {
   3.817224215572121*^9, 3.8172242429360723`*^9}, {3.8172480342681026`*^9, 
   3.8172480503340044`*^9}, 3.817248409678853*^9, {3.817248472122888*^9, 
   3.817248475331953*^9}, {3.8172485913734393`*^9, 3.817248652024939*^9}, {
   3.817250503267836*^9, 3.8172505404592924`*^9}, {3.8175509108211184`*^9, 
   3.817550913567814*^9}, {3.8175532439810467`*^9, 3.8175532992333813`*^9}, {
   3.817553349340482*^9, 3.8175534678872185`*^9}, {3.8175536320627604`*^9, 
   3.81755364929959*^9}, {3.817553731781518*^9, 3.817553738688708*^9}, {
   3.8175538644412427`*^9, 3.817553873592766*^9}, {3.8214849129254074`*^9, 
   3.821484956796611*^9}, {3.821485050432217*^9, 3.821485156088133*^9}, {
   3.8214851861428843`*^9, 3.8214852029089365`*^9}, {3.821485349214264*^9, 
   3.8214854139555893`*^9}, {3.821575003748038*^9, 3.8215750239835196`*^9}, {
   3.82157519723197*^9, 3.8215751987882376`*^9}, {3.8215753117350883`*^9, 
   3.8215753248629045`*^9}, {3.821575445640066*^9, 3.8215754700145903`*^9}, {
   3.8215755058037467`*^9, 3.821575506980193*^9}, {3.8215755720885506`*^9, 
   3.8215757464594927`*^9}, {3.821575874760121*^9, 3.8215758957222576`*^9}, {
   3.821575928640771*^9, 3.821576048721281*^9}, {3.8215761129440613`*^9, 
   3.8215761363020773`*^9}, {3.821576184081604*^9, 3.821576202820779*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"0a801fe1-858d-42d7-bca4-bad4ab170a86"],

Cell[TextData[{
 "This helper function produces an array of length ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "5ce0950c-f9a8-404b-9476-508da90b8cda"],
 ", which is all zero except a 1 in the ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "3388a662-93fe-48d5-a0c6-e7b3a26510d5"],
 "-th spot."
}], "Text",
 CellChangeTimes->{{3.8172164582080564`*^9, 
  3.817216481103177*^9}},ExpressionUUID->"55cc209b-f7f3-4139-b7aa-\
b3e24d1be777"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getClusterArray", "[", 
    RowBox[{"n_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"arr", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "n", "}"}]}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"arr", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
       "=", "1"}], ";", "arr"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8172104043919945`*^9, 3.8172104638773108`*^9}, 
   3.817216434070591*^9, {3.817216500092698*^9, 3.8172165426900663`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"de5dd6c1-46d0-4823-9147-2bcad58941ee"],

Cell["\<\
This function computes a rigid transformation function from a set of \
corresponding points\
\>", "Text",
 CellChangeTimes->{{3.8172352599357066`*^9, 3.8172353087667575`*^9}, {
  3.817235372001601*^9, 
  3.817235373736396*^9}},ExpressionUUID->"900e6303-4de9-4e09-8aa6-\
3cc06050e1c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getTransSVD", "[", 
    RowBox[{"ptsSrc_", ",", "ptsTgt_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "cent1", ",", "cent2", ",", "matP", ",", "matQ", ",", "mat", ",", "u", 
       ",", "w", ",", "v", ",", "r", ",", "func", ",", "vec"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"getting", " ", "the", " ", "centroid"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cent1", "=", 
       RowBox[{"Mean", "[", "ptsSrc", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cent2", "=", 
       RowBox[{"Mean", "[", "ptsTgt", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"forming", " ", "the", " ", "cross"}], "-", 
        RowBox[{"covariance", " ", "matrix"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"matP", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "-", "cent1"}], ")"}], "&"}], ",", "ptsSrc"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"matQ", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "-", "cent2"}], ")"}], "&"}], ",", "ptsTgt"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mat", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "matP", "]"}], ".", "matQ"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"SVD", " ", "decomposition"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "w", ",", "v"}], "}"}], "=", 
       RowBox[{"SingularValueDecomposition", "[", "mat", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"obtaining", " ", "the", " ", "rotation"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"v", ".", 
        RowBox[{"Transpose", "[", "u", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vec", "=", 
       RowBox[{"cent2", "-", "cent1"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "transform", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"func", "[", "pts_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"npts", ",", "nmat", ",", "ncent"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ncent", "=", 
           RowBox[{"Mean", "[", "pts", "]"}]}], ";", 
          RowBox[{"(*", 
           RowBox[{
           "I", " ", "think", " ", "this", " ", "line", " ", "is", " ", "a", 
            " ", 
            RowBox[{"bug", ".", " ", "I"}], " ", "believe", " ", "that", " ", 
            "this", " ", "is", " ", "corrected", " ", "with", " ", "the", " ",
             "following", " ", 
            RowBox[{"line", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"ncent", "=", "cent1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"nmat", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "-", "ncent"}], ")"}], "&"}], ",", "pts"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"npts", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"r", ".", 
             RowBox[{"Transpose", "[", "nmat", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "+", "vec", "+", "ncent"}], ")"}], "&"}], ",", 
            "npts"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "func"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.817235296041217*^9, 3.817235301359762*^9}, {
   3.8172353316960397`*^9, 3.8172353356971607`*^9}, {3.8172353899745383`*^9, 
   3.8172354352369347`*^9}, {3.8172354744176283`*^9, 3.817235627264553*^9}, {
   3.8172475501541243`*^9, 3.817247551633195*^9}, 3.8534063775587807`*^9, {
   3.8534082110740356`*^9, 3.8534082145646687`*^9}, 3.858785584913804*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"9d873f5d-84d3-4a9f-bd34-218664b7e974"]
}, Open  ]],

Cell[CellGroupData[{

Cell["2D contours", "Subsection",
 CellChangeTimes->{{3.815746701346137*^9, 
  3.815746709429308*^9}},ExpressionUUID->"acc245aa-57c4-4ef2-8402-\
96a69ee049d4"],

Cell["\<\
This function takes in a set of 3D points on the same z plane, values at each \
point, and a shrinking factor, and creates contour curves on that z plane for \
each material, plus triangles with materials on each plane.\
\>", "Text",
 CellChangeTimes->{{3.815746733250992*^9, 3.815746754961687*^9}, {
  3.8157467974375315`*^9, 3.815746851606809*^9}, {3.8157469871226673`*^9, 
  3.815747002620307*^9}, {3.815747115391768*^9, 3.8157471268423324`*^9}, {
  3.8214958821971755`*^9, 
  3.82149590398993*^9}},ExpressionUUID->"5c8d01cf-4b9b-45a1-903a-\
6f4293beae9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getSectionContours", "[", 
    RowBox[{"pts_", ",", "vals_", ",", "shrink_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tris", ",", "npts", ",", 
       RowBox[{"z", "=", 
        RowBox[{"pts", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], ",", "reg", 
       ",", "verts", ",", "segs", ",", "segmats", ",", "fverts", ",", "ftris",
        ",", "fmats", ",", " ", 
       RowBox[{"nmat", "=", 
        RowBox[{"Length", "[", 
         RowBox[{
         "vals", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], ",", "ctrs"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"npts", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}], "&"}], 
         ",", "pts"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reg", "=", 
       RowBox[{"DelaunayMesh", "[", "npts", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tris", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"First", ",", 
         RowBox[{"MeshCells", "[", 
          RowBox[{"reg", ",", "2"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "verts", ",", "segs", ",", "segmats", ",", "fverts", ",", "ftris", 
         ",", "fmats"}], "}"}], "=", 
       RowBox[{"contourTriMultiDC", "[", 
        RowBox[{"npts", ",", "tris", ",", "vals"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ctrs", "=", 
       RowBox[{"getContourAllMats2D", "[", 
        RowBox[{
        "verts", ",", "segs", ",", "segmats", ",", "nmat", ",", "shrink"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Append", "[", 
                 RowBox[{"#", ",", "z"}], "]"}], "&"}], ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "]"}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "}"}], "&"}], ",", "ctrs"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"#", ",", "z"}], "]"}], "&"}], ",", "fverts"}], "]"}], 
          ",", "ftris", ",", "fmats"}], "}"}]}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8157468545164256`*^9, 3.815747219705245*^9}, 
   3.8157484109571767`*^9, {3.8214958152176523`*^9, 3.8214958263564186`*^9}, {
   3.821495942790702*^9, 3.8214959470097136`*^9}, {3.821496003212301*^9, 
   3.821496010006118*^9}, {3.8214963620316873`*^9, 3.8214963647274127`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"8ca24405-95f6-4caf-97fd-3d34dcdf1676"],

Cell["\<\
This function returns a list of contour sets for all sections:\
\>", "Text",
 CellChangeTimes->{{3.8157478229737844`*^9, 
  3.8157478330709925`*^9}},ExpressionUUID->"f3b53dcd-2dec-45fa-8932-\
5ef65622f6af"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getSectionContoursAll", "[", 
    RowBox[{"sections_", ",", "vals_", ",", "shrink_"}], "]"}], ":=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"getSectionContours", "[", 
        RowBox[{"#1", ",", "#2", ",", "shrink"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"sections", ",", "vals"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8157478363424416`*^9, 3.815747884823414*^9}, {
  3.821496087383746*^9, 3.8214960927932115`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"01ad5d79-2e2b-4b6b-b7b9-5b3b20134f6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["3D contours", "Subsection",
 CellChangeTimes->{{3.815317478490703*^9, 3.8153174798503137`*^9}, {
  3.8156907296764545`*^9, 3.815690731948414*^9}, {3.8157465933823843`*^9, 
  3.815746595102563*^9}, {3.8157489386618285`*^9, 
  3.8157489400701504`*^9}},ExpressionUUID->"e749e80e-2ea2-484c-a9b7-\
3461176d002b"],

Cell["\<\
This function takes in a list of 3D points, values at each point, and a \
shrinking factor, and contour surfaces for each material.\
\>", "Text",
 CellChangeTimes->{{3.8157489485441246`*^9, 
  3.8157489981765428`*^9}},ExpressionUUID->"ca9c1781-ad54-470d-9718-\
bcffb690a90e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getVolumeContours", "[", 
    RowBox[{"pts_", ",", "vals_", ",", "shrink_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "reg", ",", "tets", ",", "verts", ",", "segs", ",", "segmats", ",", 
       RowBox[{"nmat", "=", 
        RowBox[{"Length", "[", 
         RowBox[{
         "vals", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"globalReg", "=", 
       RowBox[{"(", 
        RowBox[{"reg", "=", 
         RowBox[{"DelaunayMesh", "[", "pts", "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tets", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"First", ",", 
         RowBox[{"MeshCells", "[", 
          RowBox[{"reg", ",", "3"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"verts", ",", "segs", ",", "segmats"}], "}"}], "=", 
       RowBox[{"contourTetMultiDC", "[", 
        RowBox[{"pts", ",", "tets", ",", "vals"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"getContourAllMats3D", "[", 
       RowBox[{
       "verts", ",", "segs", ",", "segmats", ",", "nmat", ",", "shrink"}], 
       "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.815749005556035*^9, 3.815749104795885*^9}, {
  3.8504134335983458`*^9, 3.850413439285574*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"a0c1a5da-d095-4e40-85fe-f78a9fe5c49f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getTets", "[", "sections_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pts", ",", "inds", ",", "reg", ",", "tets"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pts", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"Join", ",", "sections"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inds", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"Join", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "#"}], "}"}], "&"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", 
               RowBox[{
               "sections", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "sections", "]"}]}], "}"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reg", "=", 
       RowBox[{"DelaunayMesh", "[", "pts", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tets", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"First", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"inds", "\[LeftDoubleBracket]", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "\[RightDoubleBracket]"}], "&"}], "*)"}], ",", 
         RowBox[{"MeshCells", "[", 
          RowBox[{"reg", ",", "3"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Scan", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Union", "[", "#", "]"}], "]"}], "\[Equal]", "1"}], ",", 
           RowBox[{"Print", "[", "#", "]"}]}], "]"}], "&"}], ",", "tets"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"reg", ",", "pts", ",", "tets"}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8156137941696296`*^9, 3.815613851221702*^9}, {
   3.815613890332238*^9, 3.8156138953088975`*^9}, {3.81561392745572*^9, 
   3.815613996083311*^9}, {3.8156140502067575`*^9, 3.815614141974429*^9}, {
   3.8156142547383423`*^9, 3.815614260342701*^9}, {3.8156143735998726`*^9, 
   3.815614457293338*^9}, {3.8156145524323893`*^9, 3.8156145683158836`*^9}, {
   3.815690440899578*^9, 3.8156904530510187`*^9}, 3.815690526168574*^9, {
   3.8156906042628284`*^9, 3.815690605038475*^9}, {3.851076971975455*^9, 
   3.8510770271671114`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"3e347b3d-b25a-4280-a9c1-fc35991cd09e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Drawing", "Subsection",
 CellChangeTimes->{{3.8157472358805704`*^9, 
  3.815747236729165*^9}},ExpressionUUID->"e2a0c75c-87c9-4f20-b825-\
e873f9b64d9b"],

Cell[TextData[{
 "Draws a list of contour curve sets (one set per section), on the chosen \
sections ",
 Cell[BoxData[
  FormBox["secs", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "de49cfff-e3c8-4a6a-9c62-70def8d92e6e"],
 " with the chosen materials ",
 Cell[BoxData[
  FormBox["mats", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ec52e26c-ce22-43b1-b675-512aa9e3edce"],
 ", with thickness ",
 Cell[BoxData[
  FormBox["thk", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "42f59c98-28a3-4fa0-be9c-dbcb0a2879bd"],
 ":"
}], "Text",
 CellChangeTimes->{{3.8157477260938044`*^9, 
  3.8157477745188007`*^9}},ExpressionUUID->"b7cb6ee8-f015-4f8f-8759-\
ea45484879d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"drawSectionContours", "[", 
    RowBox[{"ctrsList_", ",", "secs_", ",", "mats_", ",", "thk_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"verts", ",", "segs", ",", 
       RowBox[{"nmat", "=", 
        RowBox[{"Length", "[", 
         RowBox[{
         "ctrsList", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], ",", "m", ",", "s"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"s", "=", "#"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"jet", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", ".5"}], ")"}], "/", "nmat"}], "*", 
                    ".8"}], "+", ".1"}], "]"}], ",", 
                 RowBox[{"Thickness", "[", "thk", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"verts", ",", "segs"}], "}"}], "=", 
                   RowBox[{"ctrsList", "\[LeftDoubleBracket]", 
                    RowBox[{"s", ",", "#"}], "\[RightDoubleBracket]"}]}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{
                    "verts", "\[LeftDoubleBracket]", "#", 
                    "\[RightDoubleBracket]"}], "]"}], "&"}], ",", "segs"}], 
                   "]"}]}]}], "}"}], "&"}], ",", "\[IndentingNewLine]", 
              "mats"}], "]"}]}], ")"}], "&"}], ",", "\[IndentingNewLine]", 
         "secs"}], "]"}], ",", 
       RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
       RowBox[{"RotationAction", "\[Rule]", "\"\<Clip\>\""}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.815747272075384*^9, 3.8157472791010485`*^9}, {
   3.8157475324967403`*^9, 3.8157475378112116`*^9}, {3.815747646287707*^9, 
   3.815747723179186*^9}, {3.8157477869309063`*^9, 3.8157478021996517`*^9}, 
   3.8172095730055*^9, {3.8172499817346773`*^9, 3.8172499914261813`*^9}, 
   3.817250410348048*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"fedd38e3-881c-4f7e-adff-9bc784db2c62"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"drawSectionContoursBlkLast", "[", 
    RowBox[{"ctrsList_", ",", "secs_", ",", "mats_", ",", "thk_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"verts", ",", "segs", ",", 
       RowBox[{"nmat", "=", 
        RowBox[{"Length", "[", 
         RowBox[{
         "ctrsList", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], ",", "m", ",", "s"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"s", "=", "#"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"#", "\[Equal]", "nmat"}], ",", "Black", ",", 
                   RowBox[{"jet", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", ".5"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"nmat", "-", "1"}], ")"}]}], "*", ".8"}], "+", 
                    ".1"}], "]"}]}], "]"}], ",", 
                 RowBox[{"Thickness", "[", "thk", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"verts", ",", "segs"}], "}"}], "=", 
                   RowBox[{"ctrsList", "\[LeftDoubleBracket]", 
                    RowBox[{"s", ",", "#"}], "\[RightDoubleBracket]"}]}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{
                    "verts", "\[LeftDoubleBracket]", "#", 
                    "\[RightDoubleBracket]"}], "]"}], "&"}], ",", "segs"}], 
                   "]"}]}]}], "}"}], "&"}], ",", "\[IndentingNewLine]", 
              "mats"}], "]"}]}], ")"}], "&"}], ",", "\[IndentingNewLine]", 
         "secs"}], "]"}], ",", 
       RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
       RowBox[{"RotationAction", "\[Rule]", "\"\<Clip\>\""}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8175544942689075`*^9, 3.8175544968278637`*^9}, {
  3.817554527673583*^9, 3.817554545750533*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"065dad0a-17c8-43a5-bd5a-cb8c1a468691"],

Cell[BoxData[
 RowBox[{
  RowBox[{"drawSectionContoursBlk", "[", 
   RowBox[{"ctrsList_", ",", "secs_", ",", "mats_", ",", "thk_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"verts", ",", "segs", ",", 
      RowBox[{"nmat", "=", 
       RowBox[{"Length", "[", 
        RowBox[{
        "ctrsList", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ",", "m", ",", "s"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s", "=", "#"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Thickness", "[", "thk", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"verts", ",", "segs"}], "}"}], "=", 
                  RowBox[{"ctrsList", "\[LeftDoubleBracket]", 
                   RowBox[{"s", ",", "#"}], "\[RightDoubleBracket]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{
                    "verts", "\[LeftDoubleBracket]", "#", 
                    "\[RightDoubleBracket]"}], "]"}], "&"}], ",", "segs"}], 
                  "]"}]}]}], "}"}], "&"}], ",", "\[IndentingNewLine]", 
             "mats"}], "]"}]}], ")"}], "&"}], ",", "\[IndentingNewLine]", 
        "secs"}], "]"}], ",", 
      RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
      RowBox[{"RotationAction", "\[Rule]", "\"\<Clip\>\""}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.817249644969082*^9, 3.817249652897225*^9}, {
  3.8172500000111485`*^9, 3.8172500002130537`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"52e700e5-3c44-4b71-a8b3-466f4f075413"],

Cell[BoxData[
 RowBox[{
  RowBox[{"view", "[", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"contours3D", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"color3D", ",", "\[IndentingNewLine]", 
          RowBox[{"drawContourByMats3DGrayLast", "[", 
           RowBox[{"ctrs3D", ",", "types3D", ",", 
            RowBox[{"If", "[", 
             RowBox[{"transparent", ",", "opacity", ",", "1"}], "]"}]}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"drawContourByMats3DGray", "[", 
           RowBox[{"ctrs3D", ",", "types3D", ",", 
            RowBox[{"If", "[", 
             RowBox[{"transparent", ",", "opacity", ",", "1"}], "]"}]}], 
           "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{"contours2D", ",", "\[IndentingNewLine]", "\"\<None\>\"", ",", 
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\"\<Curves\>\"", ",",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"color2D", ",", "\[IndentingNewLine]", 
          RowBox[{"drawSectionContoursBlkLast", "[", 
           RowBox[{"ctrs2D", ",", 
            RowBox[{"sections", "+", "1"}], ",", "types2D", ",", 
            "thickness"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"drawSectionContoursBlk", "[", 
           RowBox[{"ctrs2D", ",", 
            RowBox[{"sections", "+", "1"}], ",", "types2D", ",", 
            "thickness"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        "\"\<Points\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"drawPointMats3DDotNew", "[", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Join", ",", 
            RowBox[{"slices", "\[LeftDoubleBracket]", 
             RowBox[{"sections", "+", "1"}], "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{"Apply", "[", 
           RowBox[{"Join", ",", 
            RowBox[{"sliceTypes", "\[LeftDoubleBracket]", 
             RowBox[{"sections", "+", "1"}], "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "typeNames", "]"}], "+", "1"}], ",", 
          "types2D", ",", "ptSize"}], "]"}], ",", "\[IndentingNewLine]", 
        "\"\<Regions\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"drawTriMats3D", "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{"Length", "[", "typeNames", "]"}], "+", "1"}], ",", 
             "types2D", ",", "1"}], "]"}], "&"}], ",", 
          RowBox[{"tris2D", "\[LeftDoubleBracket]", 
           RowBox[{"sections", "+", "1"}], "\[RightDoubleBracket]"}]}], 
         "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", "range"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"800", ",", "600"}], "}"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"types2D", ",", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "typeNames", "]"}], "]"}], ",", 
        "\"\<Select 2D types\>\""}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#1", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{"#2", ",", 
             RowBox[{"jet", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#1", "-", ".5"}], ")"}], "/", 
                 RowBox[{"Length", "[", "typeNames", "]"}]}], "*", ".8"}], 
               "+", ".1"}], "]"}]}], "]"}]}], ")"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "typeNames", "]"}], "]"}], ",", 
          "typeNames"}], "}"}]}], "]"}], ",", 
      RowBox[{"ControlType", "->", "CheckboxBar"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<Select none\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"types2D", "=", 
       RowBox[{"{", "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<Select all\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"types2D", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "typeNames", "]"}], "]"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "contours2D", ",", "\"\<Curves\>\"", ",", "\"\<Show slices as \>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<None\>\"", ",", "\"\<Points\>\"", ",", "\"\<Curves\>\"", ",", 
        "\"\<Regions\>\""}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sections", ",", 
        RowBox[{"{", "1", "}"}], ",", "\"\<Select slices\>\""}], "}"}], ",", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"Length", "[", "slices", "]"}], "-", "2"}], "]"}], ",", 
      RowBox[{"ControlType", "->", "CheckboxBar"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"color2D", ",", "True", ",", "\"\<Color curves\>\""}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"thickness", ",", "0.003", ",", "\"\<Curve thickness\>\""}], 
       "}"}], ",", "0.001", ",", "0.01"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ptSize", ",", "3", ",", "\"\<Point size\>\""}], "}"}], ",", 
      "1", ",", "20", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
    "Delimiter", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"types3D", ",", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "typeNames", "]"}], "]"}], ",", 
        "\"\<Select 3D types\>\""}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#1", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{"#2", ",", 
             RowBox[{"jet", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#1", "-", ".5"}], ")"}], "/", 
                 RowBox[{"Length", "[", "typeNames", "]"}]}], "*", ".8"}], 
               "+", ".1"}], "]"}]}], "]"}]}], ")"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "typeNames", "]"}], "]"}], ",", 
          "typeNames"}], "}"}]}], "]"}], ",", 
      RowBox[{"ControlType", "->", "CheckboxBar"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<Select none\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"types3D", "=", 
       RowBox[{"{", "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<Select all\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"types3D", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "typeNames", "]"}], "]"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"contours3D", ",", "False", ",", "\"\<Show 3D surface\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"color3D", ",", "True", ",", "\"\<Color surface\>\""}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"transparent", ",", "False", ",", "\"\<Transparent mode\>\""}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"opacity", ",", "0.5", ",", "\"\<Opacity (1 is opaque)\>\""}], 
       "}"}], ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlPlacement", "\[Rule]", "Top"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8214907406749163`*^9, 3.821490786438346*^9}, {
   3.8214908310103436`*^9, 3.8214912336156483`*^9}, 3.821491367298685*^9, 
   3.821491484071681*^9, {3.8214916485457225`*^9, 3.8214916488305907`*^9}, {
   3.8214917117479343`*^9, 3.821491738942135*^9}, {3.8214921187640123`*^9, 
   3.821492125755717*^9}, {3.8214924185949326`*^9, 3.8214924192496257`*^9}, 
   3.8214924594795227`*^9, {3.8214974116397266`*^9, 3.821497422715519*^9}, {
   3.8214974583337927`*^9, 3.821497489311248*^9}, {3.8214975367749605`*^9, 
   3.8214975471300893`*^9}, 3.821497638982849*^9, {3.821577006091942*^9, 
   3.8215770217240405`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"ad2eaf6f-a874-40ba-a7eb-02f944dd33ab"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.815316618234096*^9, 
  3.8153166196097355`*^9}},ExpressionUUID->"9238b1c6-6f23-40f9-9bfd-\
5ce822384b15"],

Cell[CellGroupData[{

Cell["Running example", "Subsection",
 CellChangeTimes->{{3.81569047476709*^9, 
  3.8156904787502623`*^9}},ExpressionUUID->"3a30eb08-693d-453b-84db-\
149beb708ad2"],

Cell[CellGroupData[{

Cell["Input", "Subsubsection",
 CellChangeTimes->{{3.815748131676546*^9, 
  3.815748133981448*^9}},ExpressionUUID->"566c908e-c1c3-4599-8cf0-\
517242780ba5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sec1", "=", 
   RowBox[{"genHexGrid", "[", 
    RowBox[{"6", ",", "5", ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"\[Pi]", "/", "20"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sec2", "=", 
   RowBox[{"genHexGrid", "[", 
    RowBox[{"6", ",", "5", ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sec3", "=", 
   RowBox[{"genHexGrid", "[", 
    RowBox[{"6", ",", "5", ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", ".5"}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], "/", "20"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"Map", "[", 
       RowBox[{"Point", ",", "sec1"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Blue", ",", 
      RowBox[{"Map", "[", 
       RowBox[{"Point", ",", "sec2"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Green", ",", 
      RowBox[{"Map", "[", 
       RowBox[{"Point", ",", "sec3"}], "]"}]}], "}"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8156128042025924`*^9, 3.8156128330110083`*^9}, {
  3.8156132040144053`*^9, 3.8156132292445173`*^9}, {3.8156132753457813`*^9, 
  3.81561332883055*^9}, {3.815613382481238*^9, 3.815613384405328*^9}, {
  3.815614160941472*^9, 3.815614198041957*^9}, {3.8157460614315476`*^9, 
  3.81574609746745*^9}, {3.815748198320412*^9, 3.8157482118379955`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"c74d8b9b-ad27-4ad7-9954-32ceb9f077cf"],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[1, 0, 0], Point3DBox[{0., 0., 0.}], 
    Point3DBox[{0.9876883405951378, 0.15643446504023087`, 0.}], 
    Point3DBox[{1.9753766811902755`, 0.31286893008046174`, 0.}], 
    Point3DBox[{2.9630650217854133`, 0.46930339512069263`, 0.}], 
    Point3DBox[{3.950753362380551, 0.6257378601609235, 0.}], 
    Point3DBox[{4.938441702975689, 0.7821723252011543, 0.}], 
    Point3DBox[{0.35836794954530027`, 0.9335804264972017, 0.}], 
    Point3DBox[{1.346056290140438, 1.0900148915374326`, 0.}], 
    Point3DBox[{2.333744630735576, 1.2464493565776635`, 0.}], 
    Point3DBox[{3.3214329713307134`, 1.4028838216178943`, 0.}], 
    Point3DBox[{4.309121311925852, 1.5593182866581252`, 0.}], 
    Point3DBox[{-0.2709524415045372, 1.7107263879541725`, 0.}], 
    Point3DBox[{0.7167358990906005, 1.8671608529944035`, 0.}], 
    Point3DBox[{1.7044242396857383`, 2.0235953180346344`, 0.}], 
    Point3DBox[{2.692112580280876, 2.180029783074865, 0.}], 
    Point3DBox[{3.679800920876014, 2.336464248115096, 0.}], 
    Point3DBox[{4.667489261471152, 2.492898713155327, 0.}], 
    Point3DBox[{0.08741550804076309, 2.6443068144513746`, 0.}], 
    Point3DBox[{1.0751038486359008`, 2.8007412794916053`, 0.}], 
    Point3DBox[{2.062792189231039, 2.957175744531836, 0.}], 
    Point3DBox[{3.050480529826176, 3.113610209572067, 0.}], 
    Point3DBox[{4.038168870421314, 3.270044674612298, 0.}], 
    Point3DBox[{-0.5419048830090744, 3.421452775908345, 0.}], 
    Point3DBox[{0.4457834575860634, 3.577887240948576, 0.}], 
    Point3DBox[{1.433471798181201, 3.734321705988807, 0.}], 
    Point3DBox[{2.421160138776339, 3.8907561710290377`, 0.}], 
    Point3DBox[{3.4088484793714766`, 4.047190636069269, 0.}], 
    Point3DBox[{4.396536819966615, 4.203625101109499, 0.}]}, 
   {RGBColor[0, 0, 1], Point3DBox[{0., 0., 1.}], Point3DBox[{1., 0., 1.}], 
    Point3DBox[{2., 0., 1.}], Point3DBox[{3., 0., 1.}], 
    Point3DBox[{4., 0., 1.}], Point3DBox[{5., 0., 1.}], 
    Point3DBox[{0.5, 0.8660254037844386, 1.}], 
    Point3DBox[{1.5, 0.8660254037844386, 1.}], 
    Point3DBox[{2.5, 0.8660254037844386, 1.}], 
    Point3DBox[{3.5, 0.8660254037844386, 1.}], 
    Point3DBox[{4.5, 0.8660254037844386, 1.}], 
    Point3DBox[{0., 1.7320508075688772`, 1.}], 
    Point3DBox[{1., 1.7320508075688772`, 1.}], 
    Point3DBox[{2., 1.7320508075688772`, 1.}], 
    Point3DBox[{3., 1.7320508075688772`, 1.}], 
    Point3DBox[{4., 1.7320508075688772`, 1.}], 
    Point3DBox[{5., 1.7320508075688772`, 1.}], 
    Point3DBox[{0.5, 2.598076211353316, 1.}], 
    Point3DBox[{1.5, 2.598076211353316, 1.}], 
    Point3DBox[{2.5, 2.598076211353316, 1.}], 
    Point3DBox[{3.5, 2.598076211353316, 1.}], 
    Point3DBox[{4.5, 2.598076211353316, 1.}], 
    Point3DBox[{0., 3.4641016151377544`, 1.}], 
    Point3DBox[{1., 3.4641016151377544`, 1.}], 
    Point3DBox[{2., 3.4641016151377544`, 1.}], 
    Point3DBox[{3., 3.4641016151377544`, 1.}], 
    Point3DBox[{4., 3.4641016151377544`, 1.}], 
    Point3DBox[{5., 3.4641016151377544`, 1.}]}, 
   {RGBColor[0, 1, 0], Point3DBox[{1., 0.5, 2.}], 
    Point3DBox[{1.9876883405951378`, 0.34356553495976916`, 2.}], 
    Point3DBox[{2.9753766811902755`, 0.18713106991953826`, 2.}], 
    Point3DBox[{3.9630650217854133`, 0.030696604879307365`, 2.}], 
    Point3DBox[{4.950753362380551, -0.12573786016092348`, 2.}], 
    Point3DBox[{5.938441702975689, -0.2821723252011543, 2.}], 
    Point3DBox[{1.6293203910498375`, 1.277145961456971, 2.}], 
    Point3DBox[{2.617008731644975, 1.12071149641674, 2.}], 
    Point3DBox[{3.6046970722401133`, 0.9642770313765091, 2.}], 
    Point3DBox[{4.592385412835251, 0.8078425663362783, 2.}], 
    Point3DBox[{5.580073753430389, 0.6514081012960473, 2.}], 
    Point3DBox[{1.2709524415045372`, 2.2107263879541725`, 2.}], 
    Point3DBox[{2.258640782099675, 2.054291922913942, 2.}], 
    Point3DBox[{3.2463291226948128`, 1.8978574578737109`, 2.}], 
    Point3DBox[{4.23401746328995, 1.74142299283348, 2.}], 
    Point3DBox[{5.221705803885088, 1.5849885277932492`, 2.}], 
    Point3DBox[{6.2093941444802265`, 1.4285540627530182`, 2.}], 
    Point3DBox[{1.9002728325543747`, 2.9878723494111434`, 2.}], 
    Point3DBox[{2.8879611731495123`, 2.8314378843709127`, 2.}], 
    Point3DBox[{3.8756495137446505`, 2.675003419330682, 2.}], 
    Point3DBox[{4.863337854339788, 2.5185689542904512`, 2.}], 
    Point3DBox[{5.851026194934926, 2.36213448925022, 2.}], 
    Point3DBox[{1.5419048830090745`, 3.921452775908345, 2.}], 
    Point3DBox[{2.5295932236042122`, 3.7650183108681143`, 2.}], 
    Point3DBox[{3.51728156419935, 3.608583845827883, 2.}], 
    Point3DBox[{4.504969904794487, 3.4521493807876524`, 2.}], 
    Point3DBox[{5.4926582453896255`, 3.2957149157474217`, 2.}], 
    Point3DBox[{6.480346585984764, 3.139280450707191, 2.}]}},
  ImageSize->{360., 360.},
  ImageSizeRaw->Automatic,
  ViewAngle->0.41014667703051544`,
  ViewPoint->{0.7502010189662668, -2.969698011412894, 1.4380862811918746`},
  ViewVertical->{0.003988551999335937, -0.040629241731682024`, 
   0.9991663305822795}]], "Output",
 CellChangeTimes->{
  3.815612833785643*^9, 3.815613229907196*^9, {3.8156133006188526`*^9, 
   3.8156133290814257`*^9}, 3.8156133847981424`*^9, 3.8156141992184*^9, 
   3.8156145544314437`*^9, 3.815690484817486*^9, 3.815692293948492*^9, {
   3.8156942604785714`*^9, 3.815694320951104*^9}, 3.8156945253440504`*^9, {
   3.8157460682343173`*^9, 3.815746099975258*^9}, {3.815748113916978*^9, 
   3.8157481429072084`*^9}, 3.8157482329239798`*^9, 3.8157508960856175`*^9, {
   3.8157511623142724`*^9, 3.815751174579435*^9}, 3.821484803106967*^9, 
   3.8214852159817395`*^9, 3.8214962314310536`*^9, 3.8303936342960033`*^9, 
   3.830421145253312*^9, 3.8510763861498685`*^9, 3.857325938886179*^9, 
   3.8574180186147175`*^9, 3.8583406985312405`*^9, 3.858780104066719*^9, 
   3.8587857059250956`*^9, 3.8587863600845904`*^9, 3.864558221850148*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"9e34e2a4-9563-4a8e-96f4-daaee3ddef33"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"secs", "=", 
   RowBox[{"{", 
    RowBox[{"sec1", ",", "sec2", ",", "sec3"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.815748234183385*^9, 3.8157482403580146`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"1f1bd815-81df-41e0-a846-ddaa75dc9dc9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nMat", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SeedRandom", "[", "2", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"range", "=", 
   RowBox[{"getRangeRatio", "[", 
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"Join", ",", "secs"}], "]"}], ",", "1.0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"centers", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"#", ",", "nMat"}], "]"}], "&"}], ",", "range"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"secvals", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pt", "=", "#"}], ";", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Norm", "[", 
             RowBox[{"pt", "-", "#"}], "]"}]}], "&"}], ",", "centers"}], 
         "]"}]}], ")"}], "&"}], ",", "secs", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8157482942208643`*^9, 3.815748337540224*^9}, {
  3.8157485894893684`*^9, 3.815748623625141*^9}, {3.8157486711335697`*^9, 
  3.815748674660894*^9}, {3.8157487608219533`*^9, 3.8157487611657896`*^9}, {
  3.8157509038599243`*^9, 3.815750910141944*^9}, {3.8157511602252593`*^9, 
  3.8157511730771494`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"f5a2af76-969d-4a6c-971c-cb7300ebb56a"],

Cell[BoxData[
 TemplateBox[{
  "RandomReal", "parb", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.9876883405951378`\\\", \\\",\\\", \\\"0.15643446504023087`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"1.9753766811902755`\\\", \\\",\\\", \\\"0.31286893008046174`\\\", \\\",\\\
\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"5\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"2.333744630735576`\\\", \\\",\\\", \\\"1.2464493565776635`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"3.3214329713307134`\\\", \\\",\\\", \\\"1.4028838216178943`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\
\\\", \\\"74\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]\\) should have \
between \\!\\(\\*RowBox[{\\\"0\\\"}]\\) and \\!\\(\\*RowBox[{\\\"2\\\"}]\\) \
parameters.\"", 2, 24, 1, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558222109148*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"33682d5b-e1d2-41cd-a0b6-ad51a68b24a4"],

Cell[BoxData[
 TemplateBox[{
  "RandomReal", "parb", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.9876883405951378`\\\", \\\",\\\", \\\"0.15643446504023087`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"1.9753766811902755`\\\", \\\",\\\", \\\"0.31286893008046174`\\\", \\\",\\\
\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"5\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"2.333744630735576`\\\", \\\",\\\", \\\"1.2464493565776635`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"3.3214329713307134`\\\", \\\",\\\", \\\"1.4028838216178943`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\
\\\", \\\"74\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]\\) should have \
between \\!\\(\\*RowBox[{\\\"0\\\"}]\\) and \\!\\(\\*RowBox[{\\\"2\\\"}]\\) \
parameters.\"", 2, 25, 2, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582221931505`*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"17c42ee4-5e40-4245-b0d9-57a059ccc5fb"],

Cell[BoxData[
 TemplateBox[{
  "RandomReal", "parb", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.9876883405951378`\\\", \\\",\\\", \\\"0.15643446504023087`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"1.9753766811902755`\\\", \\\",\\\", \\\"0.31286893008046174`\\\", \\\",\\\
\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"5\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"2.333744630735576`\\\", \\\",\\\", \\\"1.2464493565776635`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"3.3214329713307134`\\\", \\\",\\\", \\\"1.4028838216178943`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\
\\\", \\\"74\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]\\) should have \
between \\!\\(\\*RowBox[{\\\"0\\\"}]\\) and \\!\\(\\*RowBox[{\\\"2\\\"}]\\) \
parameters.\"", 2, 25, 3, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.86455822221515*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"e53142cd-75dc-4207-bde5-9c1fadd7021f"],

Cell[BoxData[
 TemplateBox[{
  "RandomReal", "parb", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.9876883405951378`\\\", \\\",\\\", \\\"0.15643446504023087`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"1.9753766811902755`\\\", \\\",\\\", \\\"0.31286893008046174`\\\", \\\",\\\
\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"5\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"2.333744630735576`\\\", \\\",\\\", \\\"1.2464493565776635`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"3.3214329713307134`\\\", \\\",\\\", \\\"1.4028838216178943`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\
\\\", \\\"74\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]\\) should have \
between \\!\\(\\*RowBox[{\\\"0\\\"}]\\) and \\!\\(\\*RowBox[{\\\"2\\\"}]\\) \
parameters.\"", 2, 25, 4, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582222301517`*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"d21e99fd-2428-46de-999b-b2add08a7b25"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"RandomReal\\\", \
\\\"::\\\", \\\"parb\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 25, 5, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558222248148*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"7b9c05d8-7704-4c55-bdf9-41cdcedb9f5c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2D contouring", "Subsubsection",
 CellChangeTimes->{{3.8157479525862246`*^9, 
  3.815747954345391*^9}},ExpressionUUID->"4bf27cb5-72d0-4197-a3b0-\
fca1f1fd89f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"shrink", "=", "0.05"}], ";"}]], "Input",
 CellChangeTimes->{{3.8157509985818853`*^9, 3.8157510015554686`*^9}, {
  3.821496254213353*^9, 3.8214962671132917`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"80eca101-fd87-4149-9d67-ae943ce94659"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ctrs2D", ",", "tris2D"}], "}"}], "=", 
   RowBox[{"getSectionContoursAll", "[", 
    RowBox[{"secs", ",", "secvals", ",", "shrink"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8157478987767844`*^9, 3.8157479907520995`*^9}, {
   3.815748489095058*^9, 3.815748489485878*^9}, {3.815748629986121*^9, 
   3.815748630316964*^9}, {3.8157509319705567`*^9, 3.8157509341295395`*^9}, 
   3.815751005652522*^9, {3.821496234774489*^9, 3.8214962390604753`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"6c5a8e1e-ab6a-430b-8741-4cd96827f2f0"],

Cell[BoxData[
 TemplateBox[{
  "Set", "shape", 
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"verts$7348\\\", \
\\\",\\\", \\\"segs$7348\\\", \\\",\\\", \\\"segmats$7348\\\", \\\",\\\", \
\\\"fverts$7348\\\", \\\",\\\", \\\"ftris$7348\\\", \\\",\\\", \\\"fmats$7348\
\\\"}], \\\"}\\\"}]\\) and \\!\\(\\*RowBox[{\\\"contourTriMultiDC\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0.9876883405951378`\\\", \\\",\\\", \
\\\"0.15643446504023087`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1.9753766811902755`\\\", \\\",\\\", \
\\\"0.31286893008046174`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"5\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"2.333744630735576`\\\", \\\",\\\", \
\\\"1.2464493565776635`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"3.3214329713307134`\\\", \\\",\\\", \
\\\"1.4028838216178943`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"18\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}]}], \\\"]\\\"}]\\) are not the same shape.\"", 2, 27, 6, 
   21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558222588149*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"af456350-62af-4131-8ed8-05aac128c6b2"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"verts$7348\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"", 2, 27, 7, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558222683152*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"b87be95b-ec84-4f6f-af5d-420c5d29e47d"],

Cell[BoxData[
 TemplateBox[{
  "Append", "normal", 
   "\"Nonatomic expression expected at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Append\\\", \
\\\"[\\\", RowBox[{\\\"verts$7348\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"]\\\"}]\\).\"", 2, 27, 8, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558222788151*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"6b3f5af2-6c49-416e-a996-43f31f50a072"],

Cell[BoxData[
 TemplateBox[{
  "Append", "normal", 
   "\"Nonatomic expression expected at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Append\\\", \
\\\"[\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0.`\\\"}], \\\"]\\\"}]\\).\"", 2,
    27, 9, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582228061495`*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"88099e59-7aaf-476e-8532-30f73b619f01"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"Append\\\", \\\"[\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"0.`\\\"}], \\\"]\\\"}]\\) cannot be used as \
a part specification.\"", 2, 27, 10, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558222878147*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"1ea6bcf7-01c5-4a33-ba34-c6efab549f41"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"verts$7348\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"", 2, 27, 11, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558222892148*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"52a5ce18-9f7e-4bf6-bc4b-61720548b276"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"segs$7348\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"", 2, 27, 12, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558222904147*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"bbfbbc35-1341-4fd0-bd5a-96af8141188e"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 27, 13, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558222915148*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"926be006-a60e-4fb3-bffd-d8bd09b87774"],

Cell[BoxData[
 TemplateBox[{
  "Append", "normal", 
   "\"Nonatomic expression expected at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Append\\\", \
\\\"[\\\", RowBox[{\\\"segs$7348\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"]\\\"}]\\).\"", 2, 27, 14, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558222926147*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"af336c02-7dfa-46d0-833f-90ff78534000"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Append\\\", \\\"::\\\", \
\\\"normal\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 27, 15, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582229381514`*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"f14bdeb3-7158-42e2-a6f4-fa77a623a9cf"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"Append\\\", \\\"[\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"0.`\\\"}], \\\"]\\\"}]\\) cannot be used as \
a part specification.\"", 2, 27, 16, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582229491496`*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"01eee32d-5cf6-45f0-9cc7-76b85dbc8708"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"Append\\\", \\\"[\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"0.`\\\"}], \\\"]\\\"}]\\) cannot be used as \
a part specification.\"", 2, 27, 17, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582229601483`*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"0ff7faf6-b964-400b-a569-95837082f612"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"pkspec1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 27, 18, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558222970149*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"159ace04-beab-4623-8f34-030bf4eee374"],

Cell[BoxData[
 TemplateBox[{
  "Set", "shape", 
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"verts$7448\\\", \
\\\",\\\", \\\"segs$7448\\\", \\\",\\\", \\\"segmats$7448\\\", \\\",\\\", \
\\\"fverts$7448\\\", \\\",\\\", \\\"ftris$7448\\\", \\\",\\\", \\\"fmats$7448\
\\\"}], \\\"}\\\"}]\\) and \\!\\(\\*RowBox[{\\\"contourTriMultiDC\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"3.`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"4.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"5.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.5`\\\", \\\",\\\", \
\\\"0.8660254037844386`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1.5`\\\", \\\",\\\", \\\"0.8660254037844386`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2.5`\\\", \\\",\\\", \
\\\"0.8660254037844386`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"3.5`\\\", \\\",\\\", \\\"0.8660254037844386`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"18\\\", \
\\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"Transpose\\\", \
\\\"[\\\", RowBox[{\\\"-\\\", SqrtBox[RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}]]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"9\\\", \\\"\[RightSkeleton]\\\"}], \\\",\
\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"18\\\", \
\\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) are not the same \
shape.\"", 2, 27, 19, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558222982151*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"c3f3ea56-2a9e-466f-a749-fcaa59d0e561"],

Cell[BoxData[
 TemplateBox[{
  "Set", "shape", 
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"verts$7456\\\", \
\\\",\\\", \\\"segs$7456\\\", \\\",\\\", \\\"segmats$7456\\\", \\\",\\\", \
\\\"fverts$7456\\\", \\\",\\\", \\\"ftris$7456\\\", \\\",\\\", \\\"fmats$7456\
\\\"}], \\\"}\\\"}]\\) and \\!\\(\\*RowBox[{\\\"contourTriMultiDC\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1.`\\\", \\\",\\\", \\\"0.5`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1.9876883405951378`\\\", \\\",\\\", \
\\\"0.34356553495976916`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"2.9753766811902755`\\\", \\\",\\\", \
\\\"0.18713106991953826`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"5\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"3.6046970722401133`\\\", \\\",\\\", \
\\\"0.9642770313765091`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"4.592385412835251`\\\", \\\",\\\", \\\"0.8078425663362783`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"18\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"9\
\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"35\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"]\\\"}]\\) are not the same shape.\
\"", 2, 27, 20, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558223030158*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"421f92b5-c896-4a84-a55f-fb5473b1814d"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Set\\\", \\\"::\\\", \\\
\"shape\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 27, 21, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582230421476`*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"c11c5022-8f87-4f49-8e67-5e1bc1618e98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{"Map", "[", 
         RowBox[{"Point", ",", "sec1"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Blue", ",", 
        RowBox[{"Map", "[", 
         RowBox[{"Point", ",", "sec2"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Green", ",", 
        RowBox[{"Map", "[", 
         RowBox[{"Point", ",", "sec3"}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"drawSectionContours", "[", 
    RowBox[{"ctrs2D", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "secs", "]"}], "]"}], ",", 
     RowBox[{"Range", "[", "nMat", "]"}], ",", "0.005"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.815748022710928*^9, 3.8157480523938227`*^9}, {
   3.8157484292644873`*^9, 3.815748435834362*^9}, {3.815748705483249*^9, 
   3.8157487109466553`*^9}, 3.8157488756439457`*^9, 3.8157489259048815`*^9, {
   3.815750946041868*^9, 3.8157509651527824`*^9}, 3.81575116569566*^9, {
   3.830421172547283*^9, 3.8304211772533026`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"cb3e0fc5-e239-4fa2-8956-c4e4d9bb97c7"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"verts$7348\\\"}]\\) cannot be used \
as a part specification.\"", 2, 28, 22, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558223150145*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"758ba8e3-7814-41d3-b7de-fdaf870f4c30"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"Line\\\", \\\"[\\\", \
RowBox[{\\\"Append\\\", \\\"[\\\", RowBox[{\\\"1\\\", \\\",\\\", \
\\\"0.`\\\"}], \\\"]\\\"}], \\\"]\\\"}]\\) cannot be used as a part \
specification.\"", 2, 28, 23, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558223164158*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"ed16295f-4809-4b12-9a30-2f19d3bf9632"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"segs$7348\\\"}]\\) cannot be used \
as a part specification.\"", 2, 28, 24, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558223179147*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"34d7a99e-d053-4a5a-aac3-5a315b5b6f1b"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"pkspec1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 28, 25, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582231891446`*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"d3a89d28-47e8-4791-96a2-881d7b7286a6"],

Cell[BoxData[
 Graphics3DBox[{{
    {RGBColor[1, 0, 0], Point3DBox[{0., 0., 0.}], 
     Point3DBox[{0.9876883405951378, 0.15643446504023087`, 0.}], 
     Point3DBox[{1.9753766811902755`, 0.31286893008046174`, 0.}], 
     Point3DBox[{2.9630650217854133`, 0.46930339512069263`, 0.}], 
     Point3DBox[{3.950753362380551, 0.6257378601609235, 0.}], 
     Point3DBox[{4.938441702975689, 0.7821723252011543, 0.}], 
     Point3DBox[{0.35836794954530027`, 0.9335804264972017, 0.}], 
     Point3DBox[{1.346056290140438, 1.0900148915374326`, 0.}], 
     Point3DBox[{2.333744630735576, 1.2464493565776635`, 0.}], 
     Point3DBox[{3.3214329713307134`, 1.4028838216178943`, 0.}], 
     Point3DBox[{4.309121311925852, 1.5593182866581252`, 0.}], 
     Point3DBox[{-0.2709524415045372, 1.7107263879541725`, 0.}], 
     Point3DBox[{0.7167358990906005, 1.8671608529944035`, 0.}], 
     Point3DBox[{1.7044242396857383`, 2.0235953180346344`, 0.}], 
     Point3DBox[{2.692112580280876, 2.180029783074865, 0.}], 
     Point3DBox[{3.679800920876014, 2.336464248115096, 0.}], 
     Point3DBox[{4.667489261471152, 2.492898713155327, 0.}], 
     Point3DBox[{0.08741550804076309, 2.6443068144513746`, 0.}], 
     Point3DBox[{1.0751038486359008`, 2.8007412794916053`, 0.}], 
     Point3DBox[{2.062792189231039, 2.957175744531836, 0.}], 
     Point3DBox[{3.050480529826176, 3.113610209572067, 0.}], 
     Point3DBox[{4.038168870421314, 3.270044674612298, 0.}], 
     Point3DBox[{-0.5419048830090744, 3.421452775908345, 0.}], 
     Point3DBox[{0.4457834575860634, 3.577887240948576, 0.}], 
     Point3DBox[{1.433471798181201, 3.734321705988807, 0.}], 
     Point3DBox[{2.421160138776339, 3.8907561710290377`, 0.}], 
     Point3DBox[{3.4088484793714766`, 4.047190636069269, 0.}], 
     Point3DBox[{4.396536819966615, 4.203625101109499, 0.}]}, 
    {RGBColor[0, 0, 1], Point3DBox[{0., 0., 1.}], Point3DBox[{1., 0., 1.}], 
     Point3DBox[{2., 0., 1.}], Point3DBox[{3., 0., 1.}], 
     Point3DBox[{4., 0., 1.}], Point3DBox[{5., 0., 1.}], 
     Point3DBox[{0.5, 0.8660254037844386, 1.}], 
     Point3DBox[{1.5, 0.8660254037844386, 1.}], 
     Point3DBox[{2.5, 0.8660254037844386, 1.}], 
     Point3DBox[{3.5, 0.8660254037844386, 1.}], 
     Point3DBox[{4.5, 0.8660254037844386, 1.}], 
     Point3DBox[{0., 1.7320508075688772`, 1.}], 
     Point3DBox[{1., 1.7320508075688772`, 1.}], 
     Point3DBox[{2., 1.7320508075688772`, 1.}], 
     Point3DBox[{3., 1.7320508075688772`, 1.}], 
     Point3DBox[{4., 1.7320508075688772`, 1.}], 
     Point3DBox[{5., 1.7320508075688772`, 1.}], 
     Point3DBox[{0.5, 2.598076211353316, 1.}], 
     Point3DBox[{1.5, 2.598076211353316, 1.}], 
     Point3DBox[{2.5, 2.598076211353316, 1.}], 
     Point3DBox[{3.5, 2.598076211353316, 1.}], 
     Point3DBox[{4.5, 2.598076211353316, 1.}], 
     Point3DBox[{0., 3.4641016151377544`, 1.}], 
     Point3DBox[{1., 3.4641016151377544`, 1.}], 
     Point3DBox[{2., 3.4641016151377544`, 1.}], 
     Point3DBox[{3., 3.4641016151377544`, 1.}], 
     Point3DBox[{4., 3.4641016151377544`, 1.}], 
     Point3DBox[{5., 3.4641016151377544`, 1.}]}, 
    {RGBColor[0, 1, 0], Point3DBox[{1., 0.5, 2.}], 
     Point3DBox[{1.9876883405951378`, 0.34356553495976916`, 2.}], 
     Point3DBox[{2.9753766811902755`, 0.18713106991953826`, 2.}], 
     Point3DBox[{3.9630650217854133`, 0.030696604879307365`, 2.}], 
     Point3DBox[{4.950753362380551, -0.12573786016092348`, 2.}], 
     Point3DBox[{5.938441702975689, -0.2821723252011543, 2.}], 
     Point3DBox[{1.6293203910498375`, 1.277145961456971, 2.}], 
     Point3DBox[{2.617008731644975, 1.12071149641674, 2.}], 
     Point3DBox[{3.6046970722401133`, 0.9642770313765091, 2.}], 
     Point3DBox[{4.592385412835251, 0.8078425663362783, 2.}], 
     Point3DBox[{5.580073753430389, 0.6514081012960473, 2.}], 
     Point3DBox[{1.2709524415045372`, 2.2107263879541725`, 2.}], 
     Point3DBox[{2.258640782099675, 2.054291922913942, 2.}], 
     Point3DBox[{3.2463291226948128`, 1.8978574578737109`, 2.}], 
     Point3DBox[{4.23401746328995, 1.74142299283348, 2.}], 
     Point3DBox[{5.221705803885088, 1.5849885277932492`, 2.}], 
     Point3DBox[{6.2093941444802265`, 1.4285540627530182`, 2.}], 
     Point3DBox[{1.9002728325543747`, 2.9878723494111434`, 2.}], 
     Point3DBox[{2.8879611731495123`, 2.8314378843709127`, 2.}], 
     Point3DBox[{3.8756495137446505`, 2.675003419330682, 2.}], 
     Point3DBox[{4.863337854339788, 2.5185689542904512`, 2.}], 
     Point3DBox[{5.851026194934926, 2.36213448925022, 2.}], 
     Point3DBox[{1.5419048830090745`, 3.921452775908345, 2.}], 
     Point3DBox[{2.5295932236042122`, 3.7650183108681143`, 2.}], 
     Point3DBox[{3.51728156419935, 3.608583845827883, 2.}], 
     Point3DBox[{4.504969904794487, 3.4521493807876524`, 2.}], 
     Point3DBox[{5.4926582453896255`, 3.2957149157474217`, 2.}], 
     Point3DBox[{6.480346585984764, 3.139280450707191, 
      2.}]}}, {{{$CellContext`jet[0.18000000000000002`], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Part[
             Part[
              Append[$CellContext`verts$7348, 0.], 
              Append[1, 0.]], $CellContext`verts$7348]], 
           Line[
            Append[1, 0.]]]}], StandardForm], {{0., 0., 
       0.}}]}, {$CellContext`jet[0.3400000000000001], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Part[
             Part[
              Append[$CellContext`segs$7348, 0.], 
              Append[1, 0.]], $CellContext`segs$7348]], 
           Line[
            Append[1, 0.]]]}], StandardForm], {{0., 0., 
       0.}}]}, {$CellContext`jet[0.5], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Part[
             Part[
              Append[$CellContext`segmats$7348, 0.], 
              Append[1, 0.]], $CellContext`segmats$7348]], 
           Line[
            Append[1, 0.]]]}], StandardForm], {{0., 0., 
       0.}}]}, {$CellContext`jet[0.66], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Append[1, 0.]], 
           Line[
            Append[1, 0.]]]}], StandardForm], {{0., 0., 
       0.}}]}}, {{$CellContext`jet[0.18000000000000002`], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Part[
             Part[
              Append[$CellContext`verts$7448, 1.], 
              Append[1, 1.]], $CellContext`verts$7448]], 
           Line[
            Append[1, 1.]]]}], StandardForm], {{0., 0., 
       0.}}]}, {$CellContext`jet[0.3400000000000001], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Part[
             Part[
              Append[$CellContext`segs$7448, 1.], 
              Append[1, 1.]], $CellContext`segs$7448]], 
           Line[
            Append[1, 1.]]]}], StandardForm], {{0., 0., 
       0.}}]}, {$CellContext`jet[0.5], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Part[
             Part[
              Append[$CellContext`segmats$7448, 1.], 
              Append[1, 1.]], $CellContext`segmats$7448]], 
           Line[
            Append[1, 1.]]]}], StandardForm], {{0., 0., 
       0.}}]}, {$CellContext`jet[0.66], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Append[1, 1.]], 
           Line[
            Append[1, 1.]]]}], StandardForm], {{0., 0., 
       0.}}]}}, {{$CellContext`jet[0.18000000000000002`], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Part[
             Part[
              Append[$CellContext`verts$7456, 2.], 
              Append[1, 2.]], $CellContext`verts$7456]], 
           Line[
            Append[1, 2.]]]}], StandardForm], {{0., 0., 
       0.}}]}, {$CellContext`jet[0.3400000000000001], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Part[
             Part[
              Append[$CellContext`segs$7456, 2.], 
              Append[1, 2.]], $CellContext`segs$7456]], 
           Line[
            Append[1, 2.]]]}], StandardForm], {{0., 0., 
       0.}}]}, {$CellContext`jet[0.5], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Part[
             Part[
              Append[$CellContext`segmats$7456, 2.], 
              Append[1, 2.]], $CellContext`segmats$7456]], 
           Line[
            Append[1, 2.]]]}], StandardForm], {{0., 0., 
       0.}}]}, {$CellContext`jet[0.66], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Append[1, 2.]], 
           Line[
            Append[1, 2.]]]}], StandardForm], {{0., 0., 0.}}]}}}},
  ImageSize->{360., 360.},
  ImageSizeRaw->Automatic,
  ViewAngle->0.32964039369486337`,
  ViewCenter->{{0.5, 0.5, 0.5}, {0.5314548376557499, 0.5879241466111658}},
  ViewPoint->{-0.6953308739807209, -2.8248804110112054`, 1.7281682901773106`},
  ViewVertical->{-0.14914021627480964`, -0.04898626759714608, 
   0.9876019144758701}]], "Output",
 CellChangeTimes->{{3.8157511681245046`*^9, 3.815751176077721*^9}, 
   3.8214848033968315`*^9, {3.8214962423709126`*^9, 3.8214962797773333`*^9}, 
   3.8214963791016607`*^9, 3.8303936425283833`*^9, {3.8304211524159975`*^9, 
   3.8304211777716317`*^9}, 3.8510763863212824`*^9, 3.8573259391081686`*^9, 
   3.857418018836747*^9, 3.8583406988182654`*^9, 3.8587801044897823`*^9, 
   3.8587857063901625`*^9, 3.858786360408554*^9, 3.8645582232091436`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"4f1f3afd-c8fb-4fb4-9e8d-de4394edac3b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"drawTriMats3D", "[", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"nMat", "+", "1"}], ",", 
        RowBox[{"Range", "[", "nMat", "]"}], ",", "1"}], "]"}], "&"}], ",", 
     "tris2D"}], "]"}], ",", 
   RowBox[{"drawSectionContours", "[", 
    RowBox[{"ctrs2D", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "secs", "]"}], "]"}], ",", 
     RowBox[{"Range", "[", "nMat", "]"}], ",", "0.005"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8214966859744897`*^9, 3.8214967869250536`*^9}, {
  3.82149681943979*^9, 3.8214968392194986`*^9}, {3.821496992758175*^9, 
  3.821497046370861*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"74b00150-5abb-4cc8-95fc-80e5962f7c5c"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"verts$7348\\\"}]\\) cannot be used \
as a part specification.\"", 2, 29, 26, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582232661457`*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"b3e0a95f-2c41-47a2-bae6-3c401b8eb66a"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"Line\\\", \\\"[\\\", \
RowBox[{\\\"Append\\\", \\\"[\\\", RowBox[{\\\"1\\\", \\\",\\\", \
\\\"0.`\\\"}], \\\"]\\\"}], \\\"]\\\"}]\\) cannot be used as a part \
specification.\"", 2, 29, 27, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558223279146*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"7473dafb-e50e-49fe-8ac5-3736b12d9152"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"segs$7348\\\"}]\\) cannot be used \
as a part specification.\"", 2, 29, 28, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582232891455`*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"f1fb0382-e1b3-4d3d-a855-16d544ee35c1"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"pkspec1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 29, 29, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558223300985*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"c5fdbec6-ca5c-41d7-bea1-7fba3b119146"],

Cell[BoxData[
 TemplateBox[{
  "Show", "gcomb", 
   "\"Could not combine the graphics objects in \
\\!\\(\\*RowBox[{\\\"Show\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"drawTriMats3D\\\", \\\"[\\\", \
RowBox[{\\\"fverts$7348\\\", \\\",\\\", \\\"ftris$7348\\\", \\\",\\\", \
\\\"fmats$7348\\\", \\\",\\\", \\\"5\\\", \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \
\\\"4\\\"}], \\\"}\\\"}], \\\",\\\", \\\"1\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"drawTriMats3D\\\", \\\"[\\\", RowBox[{\\\"fverts$7448\\\", \
\\\",\\\", \\\"ftris$7448\\\", \\\",\\\", \\\"fmats$7448\\\", \\\",\\\", \
\\\"5\\\", \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \
\\\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"4\\\"}], \\\"}\\\"}], \\\",\\\
\", \\\"1\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"drawTriMats3D\\\", \\\"[\
\\\", RowBox[{\\\"fverts$7456\\\", \\\",\\\", \\\"ftris$7456\\\", \\\",\\\", \
\\\"fmats$7456\\\", \\\",\\\", \\\"5\\\", \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \
\\\"4\\\"}], \\\"}\\\"}], \\\",\\\", \\\"1\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \
\\\",\\\", Graphics3DBox[List[List[List[jet[0.18000000000000002`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.3400000000000001`], Thickness[0.005`], \
Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], List[jet[0.5`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.66`], Thickness[0.005`], Part[Line[Append[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]]], List[List[jet[0.18000000000000002`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.3400000000000001`], Thickness[0.005`], \
Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], List[jet[0.5`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.66`], Thickness[0.005`], Part[Line[Append[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]]], List[List[jet[0.18000000000000002`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.3400000000000001`], Thickness[0.005`], \
Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], List[jet[0.5`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.66`], Thickness[0.005`], Part[Line[Append[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]]]], Rule[Lighting, \\\"Neutral\\\"], \
Rule[RotationAction, \\\"Clip\\\"]]}], \\\"]\\\"}]\\).\"", 2, 29, 30, 
   21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582233124285`*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"ea13ac1f-53d9-46d3-bb81-bc55c78a5f45"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"drawTriMats3D", "[", 
      RowBox[{
      "fverts$7348", ",", "ftris$7348", ",", "fmats$7348", ",", "5", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", "1"}], "]"}],
      ",", 
     RowBox[{"drawTriMats3D", "[", 
      RowBox[{
      "fverts$7448", ",", "ftris$7448", ",", "fmats$7448", ",", "5", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", "1"}], "]"}],
      ",", 
     RowBox[{"drawTriMats3D", "[", 
      RowBox[{
      "fverts$7456", ",", "ftris$7456", ",", "fmats$7456", ",", "5", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", "1"}], 
      "]"}]}], "}"}], ",", 
   Graphics3DBox[{{{$CellContext`jet[0.18000000000000002`], Text3DBox[
        FormBox[
         GraphicsBox[
          {Thickness[0.005], Part[
            Line[
             Part[
              Part[
               Append[$CellContext`verts$7348, 0.], 
               Append[1, 0.]], $CellContext`verts$7348]], 
            Line[
             Append[1, 0.]]]}], StandardForm], {{0., 0., 
        0.}}]}, {$CellContext`jet[0.3400000000000001], Text3DBox[
        FormBox[
         GraphicsBox[
          {Thickness[0.005], Part[
            Line[
             Part[
              Part[
               Append[$CellContext`segs$7348, 0.], 
               Append[1, 0.]], $CellContext`segs$7348]], 
            Line[
             Append[1, 0.]]]}], StandardForm], {{0., 0., 
        0.}}]}, {$CellContext`jet[0.5], Text3DBox[
        FormBox[
         GraphicsBox[
          {Thickness[0.005], Part[
            Line[
             Part[
              Part[
               Append[$CellContext`segmats$7348, 0.], 
               Append[1, 0.]], $CellContext`segmats$7348]], 
            Line[
             Append[1, 0.]]]}], StandardForm], {{0., 0., 
        0.}}]}, {$CellContext`jet[0.66], Text3DBox[
        FormBox[
         GraphicsBox[
          {Thickness[0.005], Part[
            Line[
             Append[1, 0.]], 
            Line[
             Append[1, 0.]]]}], StandardForm], {{0., 0., 
        0.}}]}}, {{$CellContext`jet[0.18000000000000002`], Text3DBox[
        FormBox[
         GraphicsBox[
          {Thickness[0.005], Part[
            Line[
             Part[
              Part[
               Append[$CellContext`verts$7448, 1.], 
               Append[1, 1.]], $CellContext`verts$7448]], 
            Line[
             Append[1, 1.]]]}], StandardForm], {{0., 0., 
        0.}}]}, {$CellContext`jet[0.3400000000000001], Text3DBox[
        FormBox[
         GraphicsBox[
          {Thickness[0.005], Part[
            Line[
             Part[
              Part[
               Append[$CellContext`segs$7448, 1.], 
               Append[1, 1.]], $CellContext`segs$7448]], 
            Line[
             Append[1, 1.]]]}], StandardForm], {{0., 0., 
        0.}}]}, {$CellContext`jet[0.5], Text3DBox[
        FormBox[
         GraphicsBox[
          {Thickness[0.005], Part[
            Line[
             Part[
              Part[
               Append[$CellContext`segmats$7448, 1.], 
               Append[1, 1.]], $CellContext`segmats$7448]], 
            Line[
             Append[1, 1.]]]}], StandardForm], {{0., 0., 
        0.}}]}, {$CellContext`jet[0.66], Text3DBox[
        FormBox[
         GraphicsBox[
          {Thickness[0.005], Part[
            Line[
             Append[1, 1.]], 
            Line[
             Append[1, 1.]]]}], StandardForm], {{0., 0., 
        0.}}]}}, {{$CellContext`jet[0.18000000000000002`], Text3DBox[
        FormBox[
         GraphicsBox[
          {Thickness[0.005], Part[
            Line[
             Part[
              Part[
               Append[$CellContext`verts$7456, 2.], 
               Append[1, 2.]], $CellContext`verts$7456]], 
            Line[
             Append[1, 2.]]]}], StandardForm], {{0., 0., 
        0.}}]}, {$CellContext`jet[0.3400000000000001], Text3DBox[
        FormBox[
         GraphicsBox[
          {Thickness[0.005], Part[
            Line[
             Part[
              Part[
               Append[$CellContext`segs$7456, 2.], 
               Append[1, 2.]], $CellContext`segs$7456]], 
            Line[
             Append[1, 2.]]]}], StandardForm], {{0., 0., 
        0.}}]}, {$CellContext`jet[0.5], Text3DBox[
        FormBox[
         GraphicsBox[
          {Thickness[0.005], Part[
            Line[
             Part[
              Part[
               Append[$CellContext`segmats$7456, 2.], 
               Append[1, 2.]], $CellContext`segmats$7456]], 
            Line[
             Append[1, 2.]]]}], StandardForm], {{0., 0., 
        0.}}]}, {$CellContext`jet[0.66], Text3DBox[
        FormBox[
         GraphicsBox[
          {Thickness[0.005], Part[
            Line[
             Append[1, 2.]], 
            Line[
             Append[1, 2.]]]}], StandardForm], {{0., 0., 0.}}]}}},
    Lighting->"Neutral",
    RotationAction->"Clip"]}], "]"}]], "Output",
 CellChangeTimes->{{3.821496771902111*^9, 3.8214967874797945`*^9}, 
   3.821496839531345*^9, 3.8214969962865114`*^9, {3.8214970408064723`*^9, 
   3.8214970469655795`*^9}, 3.8303936425832496`*^9, 3.830421152480825*^9, 
   3.8510763864652805`*^9, 3.8573259392781725`*^9, 3.857418018997754*^9, 
   3.8583406989842343`*^9, 3.8587801047057967`*^9, 3.8587857065401497`*^9, 
   3.858786360565583*^9, 3.8645582233790054`*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"723ac7c6-74fc-4522-bcd1-9358d39c56e2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3D contouring", "Subsubsection",
 CellChangeTimes->{{3.8157481574253206`*^9, 
  3.815748158974578*^9}},ExpressionUUID->"d5b22986-f191-4168-8cbd-\
3d138fcef4f3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vals", "=", 
   RowBox[{"Apply", "[", 
    RowBox[{"Join", ",", "secvals"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pts", "=", 
   RowBox[{"Apply", "[", 
    RowBox[{"Join", ",", "secs"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8157482942208643`*^9, 3.815748337540224*^9}, {
  3.8157485894893684`*^9, 3.815748623625141*^9}, {3.8157486711335697`*^9, 
  3.815748674660894*^9}, {3.8157487608219533`*^9, 3.8157487611657896`*^9}, {
  3.8157509038599243`*^9, 3.815750921010769*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"cb0a2943-18a1-4cf6-836e-f3f240885a6f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ctrs3D", "=", 
   RowBox[{"getVolumeContours", "[", 
    RowBox[{"pts", ",", "vals", ",", "shrink"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8157509864336605`*^9, 3.8157510091468587`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"24a3fba4-e601-4bd9-b6ce-481ceaf93404"],

Cell[BoxData[
 TemplateBox[{
  "Set", "shape", 
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"verts$7512\\\", \
\\\",\\\", \\\"segs$7512\\\", \\\",\\\", \\\"segmats$7512\\\"}], \
\\\"}\\\"}]\\) and \\!\\(\\*RowBox[{\\\"contourTetMultiDC\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}]\\) are not the same shape.\"", 2, 32, 31, 21632383870260713754, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582235110064`*^9},
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"832660d2-ce91-47c7-beb5-210cb2a155fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"drawPointMats3DDot", "[", 
    RowBox[{"pts", ",", "vals"}], "]"}], ",", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "show", " ", "contour", " ", "curves", " ", "on", " ", "section", " ", 
      "2"}], ",", " ", 
     RowBox[{"for", " ", "all", " ", "materials"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"drawSectionContours", "[", 
    RowBox[{"ctrs2D", ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"Range", "[", "nMat", "]"}], ",", "0.005"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "show", " ", "contour", " ", "surface", " ", "for", " ", "materials", " ",
      "1", " ", "and", " ", "3"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"drawContourByMats3D", "[", 
    RowBox[{"ctrs3D", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", ".8"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"RotationAction", "->", "\"\<Clip\>\""}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.815751030777094*^9, 3.8157510780486135`*^9}, {
  3.8157511169594455`*^9, 3.815751148462947*^9}, {3.81575120434723*^9, 
  3.815751256062848*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"51433e1e-a20e-4787-89f0-b80454a0cefa"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"verts$7448\\\"}]\\) cannot be used \
as a part specification.\"", 2, 33, 32, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582235650363`*^9},
 CellLabel->
  "During evaluation of \
In[33]:=",ExpressionUUID->"8a1ea3c9-e6fa-4a92-84d6-8f4e4ff401aa"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"Line\\\", \\\"[\\\", \
RowBox[{\\\"Append\\\", \\\"[\\\", RowBox[{\\\"1\\\", \\\",\\\", \
\\\"1.`\\\"}], \\\"]\\\"}], \\\"]\\\"}]\\) cannot be used as a part \
specification.\"", 2, 33, 33, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558223577022*^9},
 CellLabel->
  "During evaluation of \
In[33]:=",ExpressionUUID->"a064de8a-7919-40c9-a72f-04a0ee0e2159"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"segs$7448\\\"}]\\) cannot be used \
as a part specification.\"", 2, 33, 34, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558223588007*^9},
 CellLabel->
  "During evaluation of \
In[33]:=",ExpressionUUID->"777e4b8e-956f-401b-a36c-40d0e7356a23"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"pkspec1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 33, 35, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558223600009*^9},
 CellLabel->
  "During evaluation of \
In[33]:=",ExpressionUUID->"fbb8596a-2d31-43a5-be04-031d919a3017"],

Cell[BoxData[
 TemplateBox[{
  "Show", "gcomb", 
   "\"Could not combine the graphics objects in \
\\!\\(\\*RowBox[{\\\"Show\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"drawPointMats3DDot\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\
\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0.9876883405951378`\\\", \\\",\\\", \
\\\"0.15643446504023087`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1.9753766811902755`\\\", \\\",\\\", \
\\\"0.31286893008046174`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"6\\\", \\\"\[RightSkeleton]\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"3.3214329713307134`\\\", \
\\\",\\\", \\\"1.4028838216178943`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"74\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
Graphics3DBox[List[List[List[jet[0.18000000000000002`], Thickness[0.005`], \
Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.3400000000000001`], Thickness[0.005`], \
Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], List[jet[0.5`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.66`], Thickness[0.005`], Part[Line[Append[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]]]], Rule[Lighting, \\\"Neutral\\\"], \
Rule[RotationAction, \\\"Clip\\\"]], \\\",\\\", RowBox[{RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"19\\\", \\\"\[RightSkeleton]\\\"}], \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\",\\\", RowBox[{\\\"RotationAction\\\", \\\"\[Rule]\\\", \
\\\"\\\\\\\"Clip\\\\\\\"\\\"}]}], \\\"]\\\"}]\\).\"", 2, 33, 36, 
   21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582236100073`*^9},
 CellLabel->
  "During evaluation of \
In[33]:=",ExpressionUUID->"efd23a6d-2e0a-4944-888d-53bcf1c38815"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"drawPointMats3DDot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0.9876883405951378`", ",", "0.15643446504023087`", ",", 
                 "0.`"}], "}"}], ",", 
               TemplateBox[{"80"},
                "OutputSizeLimit`Skeleton"], ",", 
               RowBox[{"{", 
                RowBox[{
                "5.4926582453896255`", ",", "3.2957149157474217`", ",", 
                 "2.`"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "6.480346585984764`", ",", "3.139280450707191`", ",", "2.`"}],
                 "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              TemplateBox[{"1"},
               "OutputSizeLimit`Skeleton"], "}"}]}], "]"}], ",", 
           Graphics3DBox[{{$CellContext`jet[0.18000000000000002`], Text3DBox[
               FormBox[
                GraphicsBox[
                 {Thickness[0.005], Part[
                   Line[
                    Part[
                    Part[
                    Append[$CellContext`verts$7448, 1.], 
                    Append[1, 1.]], $CellContext`verts$7448]], 
                   Line[
                    Append[1, 1.]]]}], StandardForm], {{0., 0., 
               0.}}]}, {$CellContext`jet[0.3400000000000001], Text3DBox[
               FormBox[
                GraphicsBox[
                 {Thickness[0.005], Part[
                   Line[
                    Part[
                    Part[
                    Append[$CellContext`segs$7448, 1.], 
                    Append[1, 1.]], $CellContext`segs$7448]], 
                   Line[
                    Append[1, 1.]]]}], StandardForm], {{0., 0., 
               0.}}]}, {$CellContext`jet[0.5], Text3DBox[
               FormBox[
                GraphicsBox[
                 {Thickness[0.005], Part[
                   Line[
                    Part[
                    Part[
                    Append[$CellContext`segmats$7448, 1.], 
                    Append[1, 1.]], $CellContext`segmats$7448]], 
                   Line[
                    Append[1, 1.]]]}], StandardForm], {{0., 0., 
               0.}}]}, {$CellContext`jet[0.66], Text3DBox[
               FormBox[
                GraphicsBox[
                 {Thickness[0.005], Part[
                   Line[
                    Append[1, 1.]], 
                   Line[
                    Append[1, 1.]]]}], StandardForm], {{0., 0., 0.}}]}},
            Lighting->"Neutral",
            RotationAction->"Clip"], ",", 
           TemplateBox[{"1"},
            "OutputSizeLimit`Skeleton"], ",", 
           TemplateBox[{"1"},
            "OutputSizeLimit`Skeleton"]}], "]"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{49.2099609375, {2., 7.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{39.884765625, {0., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 33, 21632383870260713754, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{46.73583984375, {0., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 33, 21632383870260713754, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{34.4970703125, {0., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 33, 21632383870260713754, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{59.73046875, {0., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[21632383870260713754 === $SessionID, 
   Out[33], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{
  3.8157510811391435`*^9, {3.8157511302181416`*^9, 3.8157511489097357`*^9}, {
   3.8157511871914372`*^9, 3.8157512130315733`*^9}, 3.821484803710683*^9, 
   3.8303936464918537`*^9, 3.8304212001134415`*^9, 3.851076386804171*^9, 
   3.857325939738165*^9, 3.857418019407717*^9, 3.8583406994112396`*^9, 
   3.858780105168484*^9, 3.858785706900069*^9, 3.8587863610905895`*^9, 
   3.8645582237330074`*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"c5a1eda5-4f1b-4433-8ef4-682bedbbe839"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"drawSectionContours", "[", 
       RowBox[{"ctrs2D", ",", "sections", ",", "materials2D", ",", "0.005"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"drawContourByMats3D", "[", 
       RowBox[{"ctrs3D", ",", "materials3D", ",", ".8"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"getRangeRatio", "[", 
        RowBox[{"pts", ",", "1.1"}], "]"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sections", ",", 
        RowBox[{"{", "1", "}"}]}], "}"}], ",", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "secs", "]"}], "]"}], ",", 
      RowBox[{"ControlType", "->", "CheckboxBar"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"materials2D", ",", 
        RowBox[{"{", "1", "}"}]}], "}"}], ",", 
      RowBox[{"Range", "[", "nMat", "]"}], ",", 
      RowBox[{"ControlType", "->", "CheckboxBar"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"materials3D", ",", 
        RowBox[{"{", "1", "}"}]}], "}"}], ",", 
      RowBox[{"Range", "[", "nMat", "]"}], ",", 
      RowBox[{"ControlType", "->", "CheckboxBar"}]}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.815751317065193*^9, 3.815751478098366*^9}, 
   3.815751534326501*^9},
 CellLabel->"In[34]:=",ExpressionUUID->"8953a462-8afc-47c2-8017-6dd4e1e271aa"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Synthetic sections", "Subsection",
 CellChangeTimes->{{3.8156136136439*^9, 
  3.815613615636965*^9}},ExpressionUUID->"b30cdcd0-07ca-4da4-95d3-\
8771a32923f9"],

Cell[CellGroupData[{

Cell["Input points and values", "Subsubsection",
 CellChangeTimes->{{3.815691085004133*^9, 3.815691085531883*^9}, {
  3.815691251055891*^9, 3.8156912528340664`*^9}, {3.8157479426509523`*^9, 
  3.815747946683031*^9}},ExpressionUUID->"12096f98-c9ed-4b0c-a51f-\
09bcc71f0ee3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", "20"}], ";", 
  RowBox[{"m", "=", "20"}], ";"}]], "Input",
 CellChangeTimes->{{3.815692389042617*^9, 3.8156923999585733`*^9}, {
  3.8156924742366266`*^9, 3.815692475408083*^9}, {3.8156952568599944`*^9, 
  3.815695259328844*^9}, {3.8156957270259*^9, 3.8156957285721693`*^9}, {
  3.815696293928835*^9, 3.815696295403146*^9}, {3.830421232895211*^9, 
  3.830421233920154*^9}, {3.830423968131013*^9, 3.830423999153322*^9}, {
  3.83042460250395*^9, 3.8304246035915103`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"a2438075-0a9d-4410-b2dc-f599fa09b3c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"secs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"genHexGrid", "[", 
      RowBox[{"n", ",", "m", ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "0"}], "]"}], ",", 
     RowBox[{"genHexGrid", "[", 
      RowBox[{"n", ",", "m", ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", ".05", ",", "2"}], "]"}], ",", 
     RowBox[{"genHexGrid", "[", 
      RowBox[{"n", ",", "m", ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", 
       RowBox[{"-", ".02"}], ",", "4"}], "]"}], ",", 
     RowBox[{"genHexGrid", "[", 
      RowBox[{"n", ",", "m", ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", "6"}], "]"}], ",", 
     RowBox[{"genHexGrid", "[", 
      RowBox[{"n", ",", "m", ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", ".04", ",", "8"}], "]"}], ",", 
     RowBox[{"genHexGrid", "[", 
      RowBox[{"n", ",", "m", ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", 
       RowBox[{"-", ".02"}], ",", "10"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8156134425478983`*^9, 3.815613486061371*^9}, {
  3.8156135180662785`*^9, 3.815613544632742*^9}, {3.8156144996013546`*^9, 
  3.815614511896544*^9}, {3.815691156856158*^9, 3.8156911819516473`*^9}, {
  3.8156913964734745`*^9, 3.815691414333265*^9}, {3.8156923963452444`*^9, 
  3.815692417757352*^9}, {3.8304270858880806`*^9, 3.8304270953692093`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"f95b3fb1-ecd8-43dc-863a-414998fb7c2a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nMat", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"range", "=", 
   RowBox[{"getRangeRatio", "[", 
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"Join", ",", "secs"}], "]"}], ",", "0.5"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dim", "=", 
   RowBox[{"getMaxDim", "[", 
    RowBox[{"Apply", "[", 
     RowBox[{"Join", ",", "secs"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"centers", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"#", ",", 
         RowBox[{"nMat", "-", "1"}]}], "]"}], "&"}], ",", "range"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"secvals", "=", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pt", "=", "#"}], ";", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Norm", "[", 
                   RowBox[{"pt", "-", "#"}], "]"}]}], "&"}], ",", "centers"}],
                "]"}], ",", 
              RowBox[{
               RowBox[{"-", "dim"}], "/", "10"}]}], "]"}]}], ")"}], "&"}], 
         ",", 
         RowBox[{"secs", "\[LeftDoubleBracket]", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pt", "=", "#"}], ";", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"-", "dim"}], ")"}], "&"}], ",", "centers"}], "]"}],
               ",", 
              RowBox[{
               RowBox[{"-", "dim"}], "/", "10"}]}], "]"}]}], ")"}], "&"}], 
         ",", 
         RowBox[{
         "secs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pt", "=", "#"}], ";", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"-", "dim"}], ")"}], "&"}], ",", "centers"}], "]"}], 
            ",", 
            RowBox[{
             RowBox[{"-", "dim"}], "/", "10"}]}], "]"}]}], ")"}], "&"}], ",", 
       RowBox[{"secs", "\[LeftDoubleBracket]", 
        RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8156907617577486`*^9, 3.8156908167935357`*^9}, {
   3.8156908545442486`*^9, 3.8156909302315288`*^9}, {3.8156911990457845`*^9, 
   3.8156912256035843`*^9}, {3.815691296733304*^9, 3.815691311794381*^9}, {
   3.815695606918955*^9, 3.8156956438757057`*^9}, {3.8156956785015497`*^9, 
   3.815695735651863*^9}, {3.815748813393056*^9, 3.8157488364401054`*^9}, {
   3.8157515457140875`*^9, 3.8157515547807765`*^9}, 3.8304212569633875`*^9, 
   3.830423215062687*^9, 3.830423509724991*^9, 3.8304256969085646`*^9, {
   3.8304259042105656`*^9, 3.8304259489664288`*^9}, {3.830425980289633*^9, 
   3.8304260581211076`*^9}, 3.8304263337430243`*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"a729648a-8239-451a-bff9-d98660e89aa5"],

Cell[BoxData[
 TemplateBox[{
  "RandomReal", "parb", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1.`\\\", \\\",\\\", \\\
\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"3.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"4.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"5.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"6.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"7.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"8.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"9.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2330\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"}\\\"}]\\) should have between \\!\\(\\*RowBox[{\\\"0\\\"}]\\) and \\!\\(\
\\*RowBox[{\\\"2\\\"}]\\) parameters.\"", 2, 40, 37, 21632383870260713754, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582238868217`*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"770fb255-8630-4e46-b1ae-e1900dad2053"],

Cell[BoxData[
 TemplateBox[{
  "RandomReal", "parb", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1.`\\\", \\\",\\\", \\\
\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"3.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"4.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"5.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"6.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"7.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"8.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"9.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2330\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"}\\\"}]\\) should have between \\!\\(\\*RowBox[{\\\"0\\\"}]\\) and \\!\\(\
\\*RowBox[{\\\"2\\\"}]\\) parameters.\"", 2, 41, 38, 21632383870260713754, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582239008245`*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"3c3e5911-e767-4129-8919-d046db487461"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "permspec", 
   "\"Invalid permutation specification found at position \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \
SqrtBox[RowBox[{SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"1.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\"2\\\"], \
\\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \
\\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \
\\\"2\\\"]}]}]]}], \\\",\\\", RowBox[{RowBox[{\\\"-\\\", \
FractionBox[\\\"1\\\", \\\"10\\\"]}], \\\" \\\", RowBox[{\\\"getMaxDim\\\", \
\\\"[\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"3.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"4.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"5.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"6.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"7.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"8.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"9.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2330\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]}]}], \
\\\"]\\\"}]\\).\"", 2, 41, 39, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558223962833*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"d58f134e-024f-42a2-8aff-0cd1889574e3"],

Cell[BoxData[
 TemplateBox[{
  "RandomReal", "parb", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1.`\\\", \\\",\\\", \\\
\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"3.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"4.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"5.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"6.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"7.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"8.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"9.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2330\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"}\\\"}]\\) should have between \\!\\(\\*RowBox[{\\\"0\\\"}]\\) and \\!\\(\
\\*RowBox[{\\\"2\\\"}]\\) parameters.\"", 2, 41, 40, 21632383870260713754, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558223995823*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"a558d4ee-2985-43f4-b0ef-e38a92194f31"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "permspec", 
   "\"Invalid permutation specification found at position \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \
SqrtBox[RowBox[{SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"1.9987502603949663`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"2\\\"], \\\"+\\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\"2\\\"], \
\\\"+\\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.0499791692706784`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"2\\\"]}]]}], \\\",\\\", RowBox[{RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", \
\\\"10\\\"]}], \\\" \\\", RowBox[{\\\"getMaxDim\\\", \\\"[\\\", RowBox[{\\\"{\
\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"1.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \\\",\\\", \\\"0.`\\\", \\\
\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"3.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \\\"\[RightSkeleton]\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"8.`\\\", \\\",\\\", \\\"0.`\\\
\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"9.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2330\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]}]}], \\\"]\\\"}]\\).\"", 2,
    41, 41, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582240068226`*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"62458798-929f-48ca-ae4b-d38299c4c792"],

Cell[BoxData[
 TemplateBox[{
  "RandomReal", "parb", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1.`\\\", \\\",\\\", \\\
\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"3.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"4.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"5.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"6.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"7.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"8.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"9.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2330\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"}\\\"}]\\) should have between \\!\\(\\*RowBox[{\\\"0\\\"}]\\) and \\!\\(\
\\*RowBox[{\\\"2\\\"}]\\) parameters.\"", 2, 41, 42, 21632383870260713754, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558224022822*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"7f86f395-b8e4-4f7c-91c2-1fee8436267a"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"RandomReal\\\", \
\\\"::\\\", \\\"parb\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 41, 43, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582240348225`*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"13606430-63ed-423d-9f20-d7d17d867ead"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "permspec", 
   "\"Invalid permutation specification found at position \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \
SqrtBox[RowBox[{SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\"2\\\"], \
\\\"+\\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.0999583385413567`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"2\\\"], \\\"+\\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.9975005207899326`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"2\\\"]}]]}], \\\",\\\", RowBox[{RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", \
\\\"10\\\"]}], \\\" \\\", RowBox[{\\\"getMaxDim\\\", \\\"[\\\", RowBox[{\\\"{\
\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"1.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \\\",\\\", \\\"0.`\\\", \\\
\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"3.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \\\"\[RightSkeleton]\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"8.`\\\", \\\",\\\", \\\"0.`\\\
\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"9.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2330\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]}]}], \\\"]\\\"}]\\).\"", 2,
    41, 44, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582240698233`*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"147fa611-c57a-4edd-a6da-28bd65b5484d"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Transpose\\\", \\\"::\\\
\", \\\"permspec\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 41, 45, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558224085823*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"df922885-80ea-4c39-9939-838c24133bf4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["centers"], "Input",
 CellChangeTimes->{{3.8304230959126716`*^9, 3.8304231264141884`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"2ca92df7-fc68-4aea-b85d-01aace17a949"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"Transpose", "[", 
          RowBox[{"getRangeRatio", "[", 
           RowBox[{
            RowBox[{"RandomReal", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
                TemplateBox[{"2335"},
                 "OutputSizeLimit`Skeleton"], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "15.825567831231751`", ",", "17.10121521793171`", ",", 
                  "10.`"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "16.82536783789833`", ",", "17.081216551238377`", ",", 
                  "10.`"}], "}"}]}], "}"}], ",", "4"}], "]"}], ",", 
            RowBox[{"{", 
             TemplateBox[{"1"},
              "OutputSizeLimit`Skeleton"], "}"}]}], "]"}], "]"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{49.2099609375, {2., 7.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{39.884765625, {0., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 42, 21632383870260713754, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{46.73583984375, {0., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 42, 21632383870260713754, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{34.4970703125, {0., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 42, 21632383870260713754, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{59.73046875, {0., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[21632383870260713754 === $SessionID, 
   Out[42], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{{3.8304230972592416`*^9, 3.8304231266625223`*^9}, 
   3.8304232179320917`*^9, 3.830423360965454*^9, 3.8304235122568197`*^9, 
   3.8304239708654137`*^9, 3.8304240010920486`*^9, {3.8304246059691*^9, 
   3.830424617876525*^9}, {3.830425685160454*^9, 3.830425732492546*^9}, 
   3.8304263358088503`*^9, {3.83042637396826*^9, 3.830426404485757*^9}, 
   3.8304270990032806`*^9, 3.8510763870216827`*^9, 3.8573259400431542`*^9, 
   3.857418019670946*^9, 3.8583406996363735`*^9, 3.8587801055384827`*^9, 
   3.8587857072969465`*^9, 3.8587863616225624`*^9, 3.864558225540428*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"e419842a-52a1-4a2b-a215-23d165a6f53d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2D contouring", "Subsubsection",
 CellChangeTimes->{{3.8157479525862246`*^9, 
  3.815747954345391*^9}},ExpressionUUID->"22c41ed2-3bab-4671-8c9f-\
cd97e7050d5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"shrink", "=", "0.05"}], ";"}]], "Input",
 CellChangeTimes->{{3.8157509985818853`*^9, 3.8157510015554686`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"a0d42bc1-6476-4471-843b-61d010a52683"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ctrs2D", ",", "tris2D"}], "}"}], "=", 
   RowBox[{"getSectionContoursAll", "[", 
    RowBox[{"secs", ",", "secvals", ",", "shrink"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8157478987767844`*^9, 3.8157479907520995`*^9}, {
   3.815748489095058*^9, 3.815748489485878*^9}, {3.815748629986121*^9, 
   3.815748630316964*^9}, {3.8157509319705567`*^9, 3.8157509341295395`*^9}, 
   3.815751005652522*^9, 3.8214971192995024`*^9},
 CellLabel->"In[44]:=",ExpressionUUID->"1f108619-b55d-4770-90dd-b9c6934c063e"],

Cell[BoxData[
 TemplateBox[{
  "Set", "shape", 
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"verts$7591\\\", \
\\\",\\\", \\\"segs$7591\\\", \\\",\\\", \\\"segmats$7591\\\", \\\",\\\", \
\\\"fverts$7591\\\", \\\",\\\", \\\"ftris$7591\\\", \\\",\\\", \\\"fmats$7591\
\\\"}], \\\"}\\\"}]\\) and contourTriMultiDC[{<<390>>}, <<2>>] are not the \
same shape.\"", 2, 44, 46, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.86455822689545*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"e895f0c7-98f9-4d7e-bc7b-adf818938382"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"verts$7591\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"", 2, 44, 47, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582279014215`*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"a26eda67-b87e-421c-b88c-6b3614ff0a88"],

Cell[BoxData[
 TemplateBox[{
  "Append", "normal", 
   "\"Nonatomic expression expected at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Append\\\", \
\\\"[\\\", RowBox[{\\\"verts$7591\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"]\\\"}]\\).\"", 2, 44, 48, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582289064207`*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"942f0052-77fb-433d-9e57-06fda8a34b01"],

Cell[BoxData[
 TemplateBox[{
  "Append", "normal", 
   "\"Nonatomic expression expected at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Append\\\", \
\\\"[\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0.`\\\"}], \\\"]\\\"}]\\).\"", 2,
    44, 49, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558229911423*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"5871614d-6101-486d-8f6d-469e22688c94"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"Append\\\", \\\"[\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"0.`\\\"}], \\\"]\\\"}]\\) cannot be used as \
a part specification.\"", 2, 44, 50, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558230915449*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"493ffad3-7a71-46f7-8691-484fd490a266"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"verts$7591\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"", 2, 44, 51, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582319214497`*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"d6e18e05-4b52-4fe2-aa57-84734c6b50ad"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"segs$7591\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"", 2, 44, 52, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582329274235`*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"ccbd5fd4-7341-4dbb-bfc5-94808c772879"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 44, 53, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558233932428*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"7f204e7d-f12a-46cf-bbae-dc91ebe3e054"],

Cell[BoxData[
 TemplateBox[{
  "Append", "normal", 
   "\"Nonatomic expression expected at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Append\\\", \
\\\"[\\\", RowBox[{\\\"segs$7591\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"]\\\"}]\\).\"", 2, 44, 54, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582349374495`*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"4bfc16f4-d416-4c24-8318-d79efb6792e2"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Append\\\", \\\"::\\\", \
\\\"normal\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 44, 55, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558235942421*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"781e1d08-abb6-4aa4-879a-0c49eb2355fe"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"Append\\\", \\\"[\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"0.`\\\"}], \\\"]\\\"}]\\) cannot be used as \
a part specification.\"", 2, 44, 56, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.86455823694742*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"33cddeed-8e4b-4037-bc57-0732090928ac"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"Append\\\", \\\"[\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"0.`\\\"}], \\\"]\\\"}]\\) cannot be used as \
a part specification.\"", 2, 44, 57, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582379534407`*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"d2d444da-777c-4dc6-aec9-724e8389018c"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"pkspec1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 44, 58, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582389564247`*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"8c3d9635-15f2-4299-a8f7-287ec2fa2a66"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "permspec", 
   "\"Invalid permutation specification found at position \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \
SqrtBox[RowBox[{SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"1.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\"2\\\"], \
\\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \
\\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \
\\\"2\\\"]}]}]]}], \\\",\\\", RowBox[{RowBox[{\\\"-\\\", \
FractionBox[\\\"1\\\", \\\"10\\\"]}], \\\" \\\", RowBox[{\\\"getMaxDim\\\", \
\\\"[\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"3.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"4.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"5.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"6.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"7.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"8.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"9.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2330\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]}]}], \
\\\"]\\\"}]\\).\"", 2, 44, 59, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.86455823997742*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"dc0f11cc-5d6c-481e-a686-16765aa4d0d6"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "permspec", 
   "\"Invalid permutation specification found at position \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \
SqrtBox[RowBox[{SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"1.9987502603949663`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"2\\\"], \\\"+\\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\"2\\\"], \
\\\"+\\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.0499791692706784`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"2\\\"]}]]}], \\\",\\\", RowBox[{RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", \
\\\"10\\\"]}], \\\" \\\", RowBox[{\\\"getMaxDim\\\", \\\"[\\\", RowBox[{\\\"{\
\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"1.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \\\",\\\", \\\"0.`\\\", \\\
\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"3.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \\\"\[RightSkeleton]\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"8.`\\\", \\\",\\\", \\\"0.`\\\
\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"9.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2330\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]}]}], \\\"]\\\"}]\\).\"", 2,
    44, 60, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582410114193`*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"ac6f0bf3-5729-4849-9321-3f71c5aa9d1c"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "permspec", 
   "\"Invalid permutation specification found at position \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \
SqrtBox[RowBox[{SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\"2\\\"], \
\\\"+\\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.0999583385413567`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"2\\\"], \\\"+\\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.9975005207899326`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"2\\\"]}]]}], \\\",\\\", RowBox[{RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", \
\\\"10\\\"]}], \\\" \\\", RowBox[{\\\"getMaxDim\\\", \\\"[\\\", RowBox[{\\\"{\
\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"1.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \\\",\\\", \\\"0.`\\\", \\\
\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"3.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \\\"\[RightSkeleton]\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"8.`\\\", \\\",\\\", \\\"0.`\\\
\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"9.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2330\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]}]}], \\\"]\\\"}]\\).\"", 2,
    44, 61, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582420324197`*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"be90fc06-28a4-459d-aad1-30c64f3c10d9"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Transpose\\\", \\\"::\\\
\", \\\"permspec\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 44, 62, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582430374193`*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"b93fd9ba-dcef-4f89-bd03-c2759479faba"],

Cell[BoxData[
 TemplateBox[{
  "Set", "shape", 
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"verts$7661\\\", \
\\\",\\\", \\\"segs$7661\\\", \\\",\\\", \\\"segmats$7661\\\", \\\",\\\", \
\\\"fverts$7661\\\", \\\",\\\", \\\"ftris$7661\\\", \\\",\\\", \\\"fmats$7661\
\\\"}], \\\"}\\\"}]\\) and contourTriMultiDC[<<439856360 bytes>>] are not the \
same shape.\"", 2, 44, 63, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582444344215`*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"1c3ae3f9-f8de-4af6-aeb8-fc93a2432cbd"],

Cell[BoxData[
 TemplateBox[{
  "Set", "shape", 
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"verts$7667\\\", \
\\\",\\\", \\\"segs$7667\\\", \\\",\\\", \\\"segmats$7667\\\", \\\",\\\", \
\\\"fverts$7667\\\", \\\",\\\", \\\"ftris$7667\\\", \\\",\\\", \\\"fmats$7667\
\\\"}], \\\"}\\\"}]\\) and contourTriMultiDC[<<440137856 bytes>>] are not the \
same shape.\"", 2, 44, 64, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582458004494`*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"a697ecb2-1160-4065-8e5c-8dc1a4f3b655"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Set\\\", \\\"::\\\", \\\
\"shape\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 44, 65, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582468164234`*^9},
 CellLabel->
  "During evaluation of \
In[44]:=",ExpressionUUID->"355b7d6d-26c2-4bb0-8b4a-4fbb239794cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"drawSectionContours", "[", 
  RowBox[{"ctrs2D", ",", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "secs", "]"}], "]"}], ",", 
   RowBox[{"Range", "[", "nMat", "]"}], ",", "0.005"}], "]"}]], "Input",
 CellChangeTimes->{{3.830421321837194*^9, 3.8304213442842155`*^9}, 
   3.830423163630627*^9},
 CellLabel->"In[45]:=",ExpressionUUID->"86ffd5d9-942f-4261-b5ee-89b568f7fc61"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"verts$7591\\\"}]\\) cannot be used \
as a part specification.\"", 2, 45, 66, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582474566126`*^9},
 CellLabel->
  "During evaluation of \
In[45]:=",ExpressionUUID->"98fcf57f-97ad-43bf-a2e2-45d82cdb7ba5"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"Line\\\", \\\"[\\\", \
RowBox[{\\\"Append\\\", \\\"[\\\", RowBox[{\\\"1\\\", \\\",\\\", \
\\\"0.`\\\"}], \\\"]\\\"}], \\\"]\\\"}]\\) cannot be used as a part \
specification.\"", 2, 45, 67, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558247471613*^9},
 CellLabel->
  "During evaluation of \
In[45]:=",ExpressionUUID->"a3dc8df5-9320-4980-a356-2670244262e1"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"segs$7591\\\"}]\\) cannot be used \
as a part specification.\"", 2, 45, 68, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558247481612*^9},
 CellLabel->
  "During evaluation of \
In[45]:=",ExpressionUUID->"aff1f859-2d3b-42cb-b549-31a804231c43"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"pkspec1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 45, 69, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558247495659*^9},
 CellLabel->
  "During evaluation of \
In[45]:=",ExpressionUUID->"bf40ddfe-5d6b-438a-b8a8-dcc399c37587"],

Cell[BoxData[
 Graphics3DBox[{{{$CellContext`jet[0.18000000000000002`], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`verts$7591, 0.], 
             Append[1, 0.]], $CellContext`verts$7591]], 
          Line[
           Append[1, 0.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.3400000000000001], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`segs$7591, 0.], 
             Append[1, 0.]], $CellContext`segs$7591]], 
          Line[
           Append[1, 0.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.5], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`segmats$7591, 0.], 
             Append[1, 0.]], $CellContext`segmats$7591]], 
          Line[
           Append[1, 0.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.66], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Append[1, 0.]], 
          Line[
           Append[1, 0.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.8200000000000001], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[0.05, 0.], 
             Append[1, 0.]], 0.05]], 
          Line[
           Append[1, 0.]]]}], StandardForm], {{0., 0., 
      0.}}]}}, {{$CellContext`jet[0.18000000000000002`], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`verts$7661, 2.], 
             Append[1, 2.]], $CellContext`verts$7661]], 
          Line[
           Append[1, 2.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.3400000000000001], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`segs$7661, 2.], 
             Append[1, 2.]], $CellContext`segs$7661]], 
          Line[
           Append[1, 2.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.5], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`segmats$7661, 2.], 
             Append[1, 2.]], $CellContext`segmats$7661]], 
          Line[
           Append[1, 2.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.66], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Append[1, 2.]], 
          Line[
           Append[1, 2.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.8200000000000001], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[0.05, 2.], 
             Append[1, 2.]], 0.05]], 
          Line[
           Append[1, 2.]]]}], StandardForm], {{0., 0., 
      0.}}]}}, {{$CellContext`jet[0.18000000000000002`], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`verts$7667, 4.], 
             Append[1, 4.]], $CellContext`verts$7667]], 
          Line[
           Append[1, 4.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.3400000000000001], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`segs$7667, 4.], 
             Append[1, 4.]], $CellContext`segs$7667]], 
          Line[
           Append[1, 4.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.5], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`segmats$7667, 4.], 
             Append[1, 4.]], $CellContext`segmats$7667]], 
          Line[
           Append[1, 4.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.66], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Append[1, 4.]], 
          Line[
           Append[1, 4.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.8200000000000001], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[0.05, 4.], 
             Append[1, 4.]], 0.05]], 
          Line[
           Append[1, 4.]]]}], StandardForm], {{0., 0., 
      0.}}]}}, {{$CellContext`jet[0.18000000000000002`], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`verts$7677, 6.], 
             Append[1, 6.]], $CellContext`verts$7677]], 
          Line[
           Append[1, 6.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.3400000000000001], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`segs$7677, 6.], 
             Append[1, 6.]], $CellContext`segs$7677]], 
          Line[
           Append[1, 6.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.5], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`segmats$7677, 6.], 
             Append[1, 6.]], $CellContext`segmats$7677]], 
          Line[
           Append[1, 6.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.66], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Append[1, 6.]], 
          Line[
           Append[1, 6.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.8200000000000001], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[0.05, 6.], 
             Append[1, 6.]], 0.05]], 
          Line[
           Append[1, 6.]]]}], StandardForm], {{0., 0., 
      0.}}]}}, {{$CellContext`jet[0.18000000000000002`], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`verts$7679, 8.], 
             Append[1, 8.]], $CellContext`verts$7679]], 
          Line[
           Append[1, 8.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.3400000000000001], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`segs$7679, 8.], 
             Append[1, 8.]], $CellContext`segs$7679]], 
          Line[
           Append[1, 8.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.5], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`segmats$7679, 8.], 
             Append[1, 8.]], $CellContext`segmats$7679]], 
          Line[
           Append[1, 8.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.66], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Append[1, 8.]], 
          Line[
           Append[1, 8.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.8200000000000001], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[0.05, 8.], 
             Append[1, 8.]], 0.05]], 
          Line[
           Append[1, 8.]]]}], StandardForm], {{0., 0., 
      0.}}]}}, {{$CellContext`jet[0.18000000000000002`], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`verts$7681, 10.], 
             Append[1, 10.]], $CellContext`verts$7681]], 
          Line[
           Append[1, 10.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.3400000000000001], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`segs$7681, 10.], 
             Append[1, 10.]], $CellContext`segs$7681]], 
          Line[
           Append[1, 10.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.5], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[$CellContext`segmats$7681, 10.], 
             Append[1, 10.]], $CellContext`segmats$7681]], 
          Line[
           Append[1, 10.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.66], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Append[1, 10.]], 
          Line[
           Append[1, 10.]]]}], StandardForm], {{0., 0., 
      0.}}]}, {$CellContext`jet[0.8200000000000001], Text3DBox[
      FormBox[
       GraphicsBox[
        {Thickness[0.005], Part[
          Line[
           Part[
            Part[
             Append[0.05, 10.], 
             Append[1, 10.]], 0.05]], 
          Line[
           Append[1, 10.]]]}], StandardForm], {{0., 0., 0.}}]}}},
  ImageSize->{360., 360.},
  ImageSizeRaw->Automatic,
  Lighting->"Neutral",
  RotationAction->"Clip",
  ViewAngle->0.3927781343751375,
  ViewPoint->{-2.058298946402655, -2.412717546307311, -1.179915034643835},
  ViewVertical->{-0.07366021750034435, -0.12885688019837047`, \
-0.9889236961380512}]], "Output",
 CellChangeTimes->{
  3.821497240009808*^9, 3.830393671176016*^9, {3.830421238165166*^9, 
   3.83042126171466*^9}, 3.830421344808689*^9, 3.830421740368598*^9, {
   3.8304227489418993`*^9, 3.8304227599889555`*^9}, 3.830422993099698*^9, 
   3.8304231661998577`*^9, 3.830423220474723*^9, 3.8304233631306715`*^9, 
   3.8304235156643*^9, 3.83042397329245*^9, 3.830424003475448*^9, {
   3.830424609249696*^9, 3.8304246195506153`*^9}, {3.830425689979955*^9, 
   3.830425735599883*^9}, 3.830426070323036*^9, 3.8304263384382124`*^9, {
   3.830426375689621*^9, 3.830426405437442*^9}, 3.8304271016576767`*^9, 
   3.8510763876461773`*^9, 3.857325940761957*^9, 3.857418020363944*^9, 
   3.858340700378975*^9, 3.858780106151482*^9, 3.858785707933071*^9, 
   3.858786362596092*^9, 3.864558247515656*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"9005cd1e-5c3a-4dae-b9b7-c82e21c681b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"drawTriMats3D", "[", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"nMat", "+", "1"}], ",", 
         RowBox[{"Range", "[", "nMat", "]"}], ",", "1"}], "]"}], "&"}], ",", 
      "tris2D"}], "]"}], ",", 
    RowBox[{"drawSectionContours", "[", 
     RowBox[{"ctrs2D", ",", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "secs", "]"}], "]"}], ",", 
      RowBox[{"Range", "[", "nMat", "]"}], ",", "0.005"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.815748022710928*^9, 3.8157480523938227`*^9}, {
   3.8157484292644873`*^9, 3.815748435834362*^9}, {3.815748705483249*^9, 
   3.8157487109466553`*^9}, 3.8157488756439457`*^9, 3.8157489259048815`*^9, {
   3.815750946041868*^9, 3.8157509651527824`*^9}, 3.81575116569566*^9, 
   3.815751602361216*^9, {3.821497136116603*^9, 3.821497157911785*^9}, 
   3.821497227152176*^9, {3.830394545149005*^9, 3.830394563289857*^9}, {
   3.8304212813294635`*^9, 3.8304212900777473`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"9c2d9517-1690-43b4-a986-24f02ddcf54f"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"verts$7591\\\"}]\\) cannot be used \
as a part specification.\"", 2, 46, 70, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558247579629*^9},
 CellLabel->
  "During evaluation of \
In[46]:=",ExpressionUUID->"04e69fae-9ad3-4822-b52e-142112520ca5"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"Line\\\", \\\"[\\\", \
RowBox[{\\\"Append\\\", \\\"[\\\", RowBox[{\\\"1\\\", \\\",\\\", \
\\\"0.`\\\"}], \\\"]\\\"}], \\\"]\\\"}]\\) cannot be used as a part \
specification.\"", 2, 46, 71, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582475936255`*^9},
 CellLabel->
  "During evaluation of \
In[46]:=",ExpressionUUID->"3b56bc01-a2f1-4875-9b64-bb008fd02384"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"segs$7591\\\"}]\\) cannot be used \
as a part specification.\"", 2, 46, 72, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582476046276`*^9},
 CellLabel->
  "During evaluation of \
In[46]:=",ExpressionUUID->"c945bf69-d247-410b-93ff-e56079d1dc3a"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"pkspec1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 46, 73, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558247615656*^9},
 CellLabel->
  "During evaluation of \
In[46]:=",ExpressionUUID->"f48cb506-c2dc-4463-bcea-9ce9413a37ce"],

Cell[BoxData[
 TemplateBox[{
  "Show", "gcomb", 
   "\"Could not combine the graphics objects in \
\\!\\(\\*RowBox[{\\\"Show\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"drawTriMats3D\\\", \\\"[\\\", \
RowBox[{\\\"fverts$7591\\\", \\\",\\\", \\\"ftris$7591\\\", \\\",\\\", \
\\\"fmats$7591\\\", \\\",\\\", \\\"6\\\", \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \
\\\"4\\\", \\\",\\\", \\\"5\\\"}], \\\"}\\\"}], \\\",\\\", \\\"1\\\"}], \\\"]\
\\\"}], \\\",\\\", RowBox[{\\\"drawTriMats3D\\\", \\\"[\\\", \
RowBox[{\\\"fverts$7661\\\", \\\",\\\", \\\"ftris$7661\\\", \\\",\\\", \
\\\"fmats$7661\\\", \\\",\\\", \\\"6\\\", \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \
\\\"4\\\", \\\",\\\", \\\"5\\\"}], \\\"}\\\"}], \\\",\\\", \\\"1\\\"}], \\\"]\
\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"drawTriMats3D\\\
\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"drawTriMats3D\\\", \\\"[\\\", RowBox[{\\\"fverts$7681\\\", \
\\\",\\\", \\\"ftris$7681\\\", \\\",\\\", \\\"fmats$7681\\\", \\\",\\\", \
\\\"6\\\", \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \
\\\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \
\\\"5\\\"}], \\\"}\\\"}], \\\",\\\", \\\"1\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \
\\\",\\\", Graphics3DBox[List[List[List[jet[0.18000000000000002`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.3400000000000001`], Thickness[0.005`], \
Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], List[jet[0.5`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.66`], Thickness[0.005`], Part[Line[Append[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]], List[jet[0.8200000000000001`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]]], List[List[jet[0.18000000000000002`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.3400000000000001`], Thickness[0.005`], \
Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], List[jet[0.5`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.66`], Thickness[0.005`], Part[Line[Append[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]], List[jet[0.8200000000000001`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]]], List[List[jet[0.18000000000000002`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.3400000000000001`], Thickness[0.005`], \
Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], List[jet[0.5`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.66`], Thickness[0.005`], Part[Line[Append[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]], List[jet[0.8200000000000001`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]]], List[List[jet[0.18000000000000002`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.3400000000000001`], Thickness[0.005`], \
Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], List[jet[0.5`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.66`], Thickness[0.005`], Part[Line[Append[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]], List[jet[0.8200000000000001`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]]], List[List[jet[0.18000000000000002`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.3400000000000001`], Thickness[0.005`], \
Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], List[jet[0.5`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.66`], Thickness[0.005`], Part[Line[Append[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]], List[jet[0.8200000000000001`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]]], List[List[jet[0.18000000000000002`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.3400000000000001`], Thickness[0.005`], \
Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], List[jet[0.5`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.66`], Thickness[0.005`], Part[Line[Append[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]], List[jet[0.8200000000000001`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]]]], Rule[Lighting, \\\"Neutral\\\"], \
Rule[RotationAction, \\\"Clip\\\"]]}], \\\"]\\\"}]\\).\"", 2, 46, 74, 
   21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582476306534`*^9},
 CellLabel->
  "During evaluation of \
In[46]:=",ExpressionUUID->"8205e3ce-f8f4-4f69-883c-6438452e125e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3D contouring", "Subsubsection",
 CellChangeTimes->{{3.8157481574253206`*^9, 
  3.815748158974578*^9}},ExpressionUUID->"c6e0cb55-86e6-449f-be8d-\
8bcb2c9454e5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vals", "=", 
   RowBox[{"Apply", "[", 
    RowBox[{"Join", ",", "secvals"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pts", "=", 
   RowBox[{"Apply", "[", 
    RowBox[{"Join", ",", "secs"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pts", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"#", "+", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.0001"}], ",", "0.0001"}], "}"}], "]"}]}], ")"}], 
      "&"}], ",", "pts", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8157482942208643`*^9, 3.815748337540224*^9}, {
  3.8157485894893684`*^9, 3.815748623625141*^9}, {3.8157486711335697`*^9, 
  3.815748674660894*^9}, {3.8157487608219533`*^9, 3.8157487611657896`*^9}, {
  3.8157509038599243`*^9, 3.815750921010769*^9}, {3.8304218674885054`*^9, 
  3.830421869875792*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"844d5003-ac54-4275-9f9f-b5634c45f3d9"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "permspec", 
   "\"Invalid permutation specification found at position \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \
SqrtBox[RowBox[{SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"1.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\"2\\\"], \
\\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \
\\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \
\\\"2\\\"]}]}]]}], \\\",\\\", RowBox[{RowBox[{\\\"-\\\", \
FractionBox[\\\"1\\\", \\\"10\\\"]}], \\\" \\\", RowBox[{\\\"getMaxDim\\\", \
\\\"[\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"3.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"4.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"5.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"6.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"7.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"8.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"9.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2330\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]}]}], \
\\\"]\\\"}]\\).\"", 2, 47, 75, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558248286656*^9},
 CellLabel->
  "During evaluation of \
In[47]:=",ExpressionUUID->"a0e303f8-86f0-4bf2-aa02-6c7c11ffe5ed"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "permspec", 
   "\"Invalid permutation specification found at position \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \
SqrtBox[RowBox[{SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"1.9987502603949663`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"2\\\"], \\\"+\\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\"2\\\"], \
\\\"+\\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.0499791692706784`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"2\\\"]}]]}], \\\",\\\", RowBox[{RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", \
\\\"10\\\"]}], \\\" \\\", RowBox[{\\\"getMaxDim\\\", \\\"[\\\", RowBox[{\\\"{\
\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"1.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \\\",\\\", \\\"0.`\\\", \\\
\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"3.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \\\"\[RightSkeleton]\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"8.`\\\", \\\",\\\", \\\"0.`\\\
\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"9.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2330\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]}]}], \\\"]\\\"}]\\).\"", 2,
    47, 76, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582488956556`*^9},
 CellLabel->
  "During evaluation of \
In[47]:=",ExpressionUUID->"36874d4c-fd83-4dad-b390-36bf753b659f"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "permspec", 
   "\"Invalid permutation specification found at position \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \
SqrtBox[RowBox[{SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\"2\\\"], \
\\\"+\\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.0999583385413567`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"2\\\"], \\\"+\\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.9975005207899326`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"2\\\"]}]]}], \\\",\\\", RowBox[{RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", \
\\\"10\\\"]}], \\\" \\\", RowBox[{\\\"getMaxDim\\\", \\\"[\\\", RowBox[{\\\"{\
\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"1.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \\\",\\\", \\\"0.`\\\", \\\
\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"3.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \\\"\[RightSkeleton]\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"8.`\\\", \\\",\\\", \\\"0.`\\\
\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"9.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2330\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]}]}], \\\"]\\\"}]\\).\"", 2,
    47, 77, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582495016255`*^9},
 CellLabel->
  "During evaluation of \
In[47]:=",ExpressionUUID->"7e8c379f-ee9a-4841-8e84-2460a1dfc360"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Transpose\\\", \\\"::\\\
\", \\\"permspec\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 47, 78, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582500986557`*^9},
 CellLabel->
  "During evaluation of \
In[47]:=",ExpressionUUID->"f1acb646-5144-4895-816b-8745b6a57a3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ctrs3D", "=", 
   RowBox[{"getVolumeContours", "[", 
    RowBox[{"pts", ",", "vals", ",", "shrink"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8157509864336605`*^9, 3.8157510091468587`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"a15b96a1-2f6c-4d0d-a9ee-7aa32cf75f13"],

Cell[BoxData[
 TemplateBox[{
  "Set", "shape", 
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"verts$7732\\\", \
\\\",\\\", \\\"segs$7732\\\", \\\",\\\", \\\"segmats$7732\\\"}], \
\\\"}\\\"}]\\) and contourTetMultiDC[<<2198668608 bytes>>] are not the same \
shape.\"", 2, 50, 79, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582518817573`*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"49121ba2-298c-4614-b314-91d5e3b9a844"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "permspec", 
   "\"Invalid permutation specification found at position \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \
SqrtBox[RowBox[{SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"1.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\"2\\\"], \
\\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \
\\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \
\\\"2\\\"]}]}]]}], \\\",\\\", RowBox[{RowBox[{\\\"-\\\", \
FractionBox[\\\"1\\\", \\\"10\\\"]}], \\\" \\\", RowBox[{\\\"getMaxDim\\\", \
\\\"[\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"3.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"4.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"5.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"6.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"7.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"8.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"9.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\
\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2330\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]}]}], \
\\\"]\\\"}]\\).\"", 2, 50, 80, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582528927307`*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"bda5758f-25d9-4ceb-9e61-affd326a8c1d"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "permspec", 
   "\"Invalid permutation specification found at position \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \
SqrtBox[RowBox[{SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"1.9987502603949663`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"2\\\"], \\\"+\\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\"2\\\"], \
\\\"+\\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.0499791692706784`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"2\\\"]}]]}], \\\",\\\", RowBox[{RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", \
\\\"10\\\"]}], \\\" \\\", RowBox[{\\\"getMaxDim\\\", \\\"[\\\", RowBox[{\\\"{\
\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"1.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \\\",\\\", \\\"0.`\\\", \\\
\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"3.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \\\"\[RightSkeleton]\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"8.`\\\", \\\",\\\", \\\"0.`\\\
\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"9.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2330\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]}]}], \\\"]\\\"}]\\).\"", 2,
    50, 81, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558253914727*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"3aa93de7-e37d-4722-a801-f6073efd3ced"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "permspec", 
   "\"Invalid permutation specification found at position \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \
SqrtBox[RowBox[{SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \\\"2\\\"], \
\\\"+\\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.0999583385413567`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"2\\\"], \\\"+\\\", SuperscriptBox[RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"2.9975005207899326`\\\", \\\"\[VeryThinSpace]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}], \
\\\"2\\\"]}]]}], \\\",\\\", RowBox[{RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", \
\\\"10\\\"]}], \\\" \\\", RowBox[{\\\"getMaxDim\\\", \\\"[\\\", RowBox[{\\\"{\
\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"1.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2.`\\\", \\\",\\\", \\\"0.`\\\", \\\
\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"3.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \\\"\[RightSkeleton]\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"8.`\\\", \\\",\\\", \\\"0.`\\\
\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"9.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2330\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]}]}], \\\"]\\\"}]\\).\"", 2,
    50, 82, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582549367733`*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"48c1dde3-a81d-422f-80a1-4b51107abe9b"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Transpose\\\", \\\"::\\\
\", \\\"permspec\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 50, 83, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558255942731*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"36a481b8-723d-41e0-badd-a9c21697c72e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "show", " ", "contour", " ", "curves", " ", "on", " ", "section", " ", 
     "2"}], ",", " ", 
    RowBox[{"for", " ", "all", " ", "materials"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"drawSectionContours", "[", 
    RowBox[{"ctrs2D", ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"Range", "[", "nMat", "]"}], ",", "0.005"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "show", " ", "contour", " ", "surface", " ", "for", " ", "materials", " ",
      "1", " ", "and", " ", "3"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"drawContourByMats3D", "[", 
    RowBox[{"ctrs3D", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", ".8"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"RotationAction", "->", "\"\<Clip\>\""}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.815751030777094*^9, 3.8157510780486135`*^9}, {
   3.8157511169594455`*^9, 3.815751148462947*^9}, {3.81575120434723*^9, 
   3.815751256062848*^9}, {3.815751638835785*^9, 3.8157516673677435`*^9}, 
   3.830421881730835*^9, {3.830423313653555*^9, 3.830423314613068*^9}, 
   3.830423381109667*^9},
 CellLabel->"In[51]:=",ExpressionUUID->"59066f84-16e1-464f-b7f7-db6c3ccf977e"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"verts$7661\\\"}]\\) cannot be used \
as a part specification.\"", 2, 51, 84, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582560491962`*^9},
 CellLabel->
  "During evaluation of \
In[51]:=",ExpressionUUID->"d6e8317d-be68-47ba-ae7a-5b770ba3ae18"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"Line\\\", \\\"[\\\", \
RowBox[{\\\"Append\\\", \\\"[\\\", RowBox[{\\\"1\\\", \\\",\\\", \
\\\"2.`\\\"}], \\\"]\\\"}], \\\"]\\\"}]\\) cannot be used as a part \
specification.\"", 2, 51, 85, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558256061198*^9},
 CellLabel->
  "During evaluation of \
In[51]:=",ExpressionUUID->"53d5e5cd-7313-407c-8e3d-afb7fadb525d"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{\\\"segs$7661\\\"}]\\) cannot be used \
as a part specification.\"", 2, 51, 86, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864558256073206*^9},
 CellLabel->
  "During evaluation of \
In[51]:=",ExpressionUUID->"3cae2609-b0be-46d0-a5b5-2f922bd17a37"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"pkspec1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 51, 87, 21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582560831985`*^9},
 CellLabel->
  "During evaluation of \
In[51]:=",ExpressionUUID->"63c665a8-6d96-4a6b-b2f6-c210377d4c81"],

Cell[BoxData[
 TemplateBox[{
  "Show", "gcomb", 
   "\"Could not combine the graphics objects in \
\\!\\(\\*RowBox[{\\\"Show\\\", \\\"[\\\", \
RowBox[{Graphics3DBox[List[List[List[jet[0.18000000000000002`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.3400000000000001`], Thickness[0.005`], \
Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], List[jet[0.5`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], Line[Append[Skeleton[2]]]]], \
List[jet[0.66`], Thickness[0.005`], Part[Line[Append[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]], List[jet[0.8200000000000001`], \
Thickness[0.005`], Part[Line[Part[Skeleton[2]]], \
Line[Append[Skeleton[2]]]]]]], Rule[Lighting, \\\"Neutral\\\"], \
Rule[RotationAction, \\\"Clip\\\"]], \\\",\\\", \
RowBox[{\\\"drawContourByMats3D\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"getContourAllMats3D\\\", \\\"[\\\", \
RowBox[{\\\"verts$7732\\\", \\\",\\\", \\\"segs$7732\\\", \\\",\\\", \
\\\"segmats$7732\\\", \\\",\\\", \\\"2\\\", \\\",\\\", \\\"0.05`\\\"}], \\\"]\
\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \
\\\"3\\\"}], \\\"}\\\"}], \\\",\\\", \\\"0.8`\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"RotationAction\\\", \\\"\[Rule]\\\", \
\\\"\\\\\\\"Clip\\\\\\\"\\\"}]}], \\\"]\\\"}]\\).\"", 2, 51, 88, 
   21632383870260713754, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8645582560952024`*^9},
 CellLabel->
  "During evaluation of \
In[51]:=",ExpressionUUID->"1a6e854c-ac4c-49f5-93d8-a174ea622398"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   Graphics3DBox[{{$CellContext`jet[0.18000000000000002`], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Part[
             Part[
              Append[$CellContext`verts$7661, 2.], 
              Append[1, 2.]], $CellContext`verts$7661]], 
           Line[
            Append[1, 2.]]]}], StandardForm], {{0., 0., 
       0.}}]}, {$CellContext`jet[0.3400000000000001], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Part[
             Part[
              Append[$CellContext`segs$7661, 2.], 
              Append[1, 2.]], $CellContext`segs$7661]], 
           Line[
            Append[1, 2.]]]}], StandardForm], {{0., 0., 
       0.}}]}, {$CellContext`jet[0.5], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Part[
             Part[
              Append[$CellContext`segmats$7661, 2.], 
              Append[1, 2.]], $CellContext`segmats$7661]], 
           Line[
            Append[1, 2.]]]}], StandardForm], {{0., 0., 
       0.}}]}, {$CellContext`jet[0.66], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Append[1, 2.]], 
           Line[
            Append[1, 2.]]]}], StandardForm], {{0., 0., 
       0.}}]}, {$CellContext`jet[0.8200000000000001], Text3DBox[
       FormBox[
        GraphicsBox[
         {Thickness[0.005], Part[
           Line[
            Part[
             Part[
              Append[0.05, 2.], 
              Append[1, 2.]], 0.05]], 
           Line[
            Append[1, 2.]]]}], StandardForm], {{0., 0., 0.}}]}},
    Lighting->"Neutral",
    RotationAction->"Clip"], ",", 
   RowBox[{"drawContourByMats3D", "[", 
    RowBox[{
     RowBox[{"getContourAllMats3D", "[", 
      RowBox[{
      "verts$7732", ",", "segs$7732", ",", "segmats$7732", ",", "2", ",", 
       "0.05`"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", "0.8`"}], "]"}], ",", 
   RowBox[{"RotationAction", "\[Rule]", "\<\"Clip\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8304218822970877`*^9, 3.8304231755099273`*^9, 3.830423224717909*^9, 
   3.8304233155440636`*^9, {3.8304233661747646`*^9, 3.830423382057707*^9}, 
   3.8304235206460676`*^9, 3.830423976615923*^9, 3.8304240093884883`*^9, 
   3.8304246267703495`*^9, 3.8304260777236214`*^9, 3.8304263488948593`*^9, 
   3.8304264289080596`*^9, 3.830427114944767*^9, 3.8510763900621696`*^9, 
   3.8573259432983365`*^9, 3.857418022807152*^9, 3.8583407028720493`*^9, 
   3.8587801086126957`*^9, 3.8587857104136477`*^9, 3.8587863653499284`*^9, 
   3.8645582561181693`*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"b44b23d2-68d5-4c1f-a8e2-4989b83750b2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"drawPointMultiMats3DDot", "[", 
       RowBox[{"pts", ",", "vals", ",", "materialsPts", ",", "0.01"}], "]"}], 
      ",", 
      RowBox[{"drawSectionContours", "[", 
       RowBox[{"ctrs2D", ",", "sections", ",", "materials2D", ",", "0.005"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"drawContourByMats3D", "[", 
       RowBox[{"ctrs3D", ",", "materials3D", ",", ".8"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"getRangeRatio", "[", 
        RowBox[{"pts", ",", "1.1"}], "]"}]}], ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sections", ",", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "secs", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "secs", "]"}], "]"}], ",", 
      RowBox[{"ControlType", "->", "CheckboxBar"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"materialsPts", ",", 
        RowBox[{
         RowBox[{"Range", "[", "nMat", "]"}], "\[LeftDoubleBracket]", 
         RowBox[{";;", 
          RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
      RowBox[{"Range", "[", "nMat", "]"}], ",", 
      RowBox[{"ControlType", "->", "CheckboxBar"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"materials2D", ",", 
        RowBox[{
         RowBox[{"Range", "[", "nMat", "]"}], "\[LeftDoubleBracket]", 
         RowBox[{";;", 
          RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
      RowBox[{"Range", "[", "nMat", "]"}], ",", 
      RowBox[{"ControlType", "->", "CheckboxBar"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"materials3D", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{"Range", "[", "nMat", "]"}], ",", 
      RowBox[{"ControlType", "->", "CheckboxBar"}]}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.815751317065193*^9, 3.815751478098366*^9}, 
   3.815751534326501*^9, 3.8157516745863423`*^9, 3.815751718919986*^9, 
   3.830421889062169*^9, {3.8304233845573745`*^9, 3.830423385741331*^9}, {
   3.830423433371767*^9, 3.8304234644919214`*^9}, {3.8304242392093697`*^9, 
   3.8304242691458216`*^9}, 3.830424569817073*^9, {3.8304246567528954`*^9, 
   3.830424660408496*^9}, {3.8304247345530148`*^9, 3.8304247390560966`*^9}, {
   3.830424821912881*^9, 3.830424852224167*^9}, 3.8304261859201736`*^9, {
   3.8304264727644477`*^9, 3.83042651837175*^9}, 3.8304269780279703`*^9, 
   3.830427878951784*^9},
 CellLabel->"In[52]:=",ExpressionUUID->"75088ee7-36ef-4611-a2e6-e96f7d50f2ee"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{576., 574.8},
WindowMargins->{{Automatic, 0.6000000000001364}, {Automatic, 0}},
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"74b61746-89c2-4cc4-bc79-c10ba01ddad2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 193, 3, 160, "Title",ExpressionUUID->"aa7319c9-a1ab-44fd-99f1-ab7c41d8f07e"],
Cell[776, 27, 165, 3, 53, "Subtitle",ExpressionUUID->"2bcf7d08-5db1-4962-b83e-c47cef2fe944"],
Cell[CellGroupData[{
Cell[966, 34, 153, 3, 67, "Section",ExpressionUUID->"c03e6af6-610e-4b74-884b-27085b74b71b"],
Cell[1122, 39, 381, 8, 35, "Text",ExpressionUUID->"3453067a-3e33-4d4b-887b-307016384b8c"],
Cell[CellGroupData[{
Cell[1528, 51, 158, 3, 54, "Subsection",ExpressionUUID->"0c54e5a9-25c0-4559-8d4f-68a70a8e16ba"],
Cell[1689, 56, 1055, 31, 58, "Text",ExpressionUUID->"6c6d3fea-004d-4ecc-b25a-264b9b778cf7"],
Cell[2747, 89, 3534, 89, 225, "Input",ExpressionUUID->"8007f3b2-945b-4f19-b9a5-f27fa32b6236"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6318, 183, 159, 3, 54, "Subsection",ExpressionUUID->"dc029ada-62df-45e8-8eac-ce37a75654da"],
Cell[6480, 188, 458, 11, 105, "Input",ExpressionUUID->"91f9d196-3f9e-4486-8186-85981a9dcb4b"],
Cell[6941, 201, 1406, 25, 219, "Text",ExpressionUUID->"6f40898d-0c7a-41b3-a001-48761a349764"],
Cell[8350, 228, 352, 7, 48, "Input",ExpressionUUID->"be1f8e57-3986-4ce2-83e0-d0f786a49074"],
Cell[8705, 237, 14845, 349, 1437, "Input",ExpressionUUID->"0a801fe1-858d-42d7-bca4-bad4ab170a86"],
Cell[23553, 588, 547, 15, 35, "Text",ExpressionUUID->"55cc209b-f7f3-4139-b7aa-b3e24d1be777"],
Cell[24103, 605, 707, 18, 28, "Input",ExpressionUUID->"de5dd6c1-46d0-4823-9147-2bcad58941ee"],
Cell[24813, 625, 294, 7, 35, "Text",ExpressionUUID->"900e6303-4de9-4e09-8aa6-3cc06050e1c6"],
Cell[25110, 634, 4424, 105, 561, "Input",ExpressionUUID->"9d873f5d-84d3-4a9f-bd34-218664b7e974"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29571, 744, 159, 3, 54, "Subsection",ExpressionUUID->"acc245aa-57c4-4ef2-8402-96a69ee049d4"],
Cell[29733, 749, 569, 10, 81, "Text",ExpressionUUID->"5c8d01cf-4b9b-45a1-903a-6f4293beae9c"],
Cell[30305, 761, 3218, 81, 257, "Input",ExpressionUUID->"8ca24405-95f6-4caf-97fd-3d34dcdf1676"],
Cell[33526, 844, 216, 5, 35, "Text",ExpressionUUID->"f3b53dcd-2dec-45fa-8932-5ef65622f6af"],
Cell[33745, 851, 654, 16, 67, "Input",ExpressionUUID->"01ad5d79-2e2b-4b6b-b7b9-5b3b20134f6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34436, 872, 313, 5, 54, "Subsection",ExpressionUUID->"e749e80e-2ea2-484c-a9b7-3461176d002b"],
Cell[34752, 879, 285, 6, 58, "Text",ExpressionUUID->"ca9c1781-ad54-470d-9718-bcffb690a90e"],
Cell[35040, 887, 1524, 39, 162, "Input",ExpressionUUID->"a0c1a5da-d095-4e40-85fe-f78a9fe5c49f"],
Cell[36567, 928, 2791, 69, 143, "Input",ExpressionUUID->"3e347b3d-b25a-4280-a9c1-fc35991cd09e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39395, 1002, 157, 3, 54, "Subsection",ExpressionUUID->"e2a0c75c-87c9-4f20-b825-e873f9b64d9b"],
Cell[39555, 1007, 735, 21, 35, "Text",ExpressionUUID->"b7cb6ee8-f015-4f8f-8759-ea45484879d5"],
Cell[40293, 1030, 2645, 61, 162, "Input",ExpressionUUID->"fedd38e3-881c-4f7e-adff-9bc784db2c62"],
Cell[42941, 1093, 2683, 63, 162, "Input",ExpressionUUID->"065dad0a-17c8-43a5-bd5a-cb8c1a468691"],
Cell[45627, 1158, 2101, 50, 162, "Input",ExpressionUUID->"52e700e5-3c44-4b71-a8b3-466f4f075413"],
Cell[47731, 1210, 9723, 231, 828, "Input",ExpressionUUID->"ad2eaf6f-a874-40ba-a7eb-02f944dd33ab"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57503, 1447, 151, 3, 67, "Section",ExpressionUUID->"9238b1c6-6f23-40f9-9bfd-5ce822384b15"],
Cell[CellGroupData[{
Cell[57679, 1454, 164, 3, 54, "Subsection",ExpressionUUID->"3a30eb08-693d-453b-84db-149beb708ad2"],
Cell[CellGroupData[{
Cell[57868, 1461, 156, 3, 45, "Subsubsection",ExpressionUUID->"566c908e-c1c3-4599-8cf0-517242780ba5"],
Cell[CellGroupData[{
Cell[58049, 1468, 1742, 47, 124, "Input",ExpressionUUID->"c74d8b9b-ad27-4ad7-9954-32ceb9f077cf"],
Cell[59794, 1517, 5966, 101, 377, "Output",ExpressionUUID->"9e34e2a4-9563-4a8e-96f4-daaee3ddef33"]
}, Open  ]],
Cell[65775, 1621, 285, 6, 28, "Input",ExpressionUUID->"1f1bd815-81df-41e0-a846-ddaa75dc9dc9"],
Cell[CellGroupData[{
Cell[66085, 1631, 1528, 42, 124, "Input",ExpressionUUID->"f5a2af76-969d-4a6c-971c-cb7300ebb56a"],
Cell[67616, 1675, 1329, 22, 83, "Message",ExpressionUUID->"33682d5b-e1d2-41cd-a0b6-ad51a68b24a4"],
Cell[68948, 1699, 1331, 22, 83, "Message",ExpressionUUID->"17c42ee4-5e40-4245-b0d9-57a059ccc5fb"],
Cell[70282, 1723, 1328, 22, 83, "Message",ExpressionUUID->"e53142cd-75dc-4207-bde5-9c1fadd7021f"],
Cell[71613, 1747, 1331, 22, 83, "Message",ExpressionUUID->"d21e99fd-2428-46de-999b-b2add08a7b25"],
Cell[72947, 1771, 454, 10, 46, "Message",ExpressionUUID->"7b9c05d8-7704-4c55-bdf9-41cdcedb9f5c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[73450, 1787, 166, 3, 45, "Subsubsection",ExpressionUUID->"4bf27cb5-72d0-4197-a3b0-fca1f1fd89f4"],
Cell[73619, 1792, 275, 5, 28, "Input",ExpressionUUID->"80eca101-fd87-4149-9d67-ae943ce94659"],
Cell[CellGroupData[{
Cell[73919, 1801, 597, 11, 48, "Input",ExpressionUUID->"6c5a8e1e-ab6a-430b-8741-4cd96827f2f0"],
Cell[74519, 1814, 1680, 28, 101, "Message",ExpressionUUID->"af456350-62af-4131-8ed8-05aac128c6b2"],
Cell[76202, 1844, 456, 10, 28, "Message",ExpressionUUID->"b87be95b-ec84-4f6f-af5d-420c5d29e47d"],
Cell[76661, 1856, 488, 11, 28, "Message",ExpressionUUID->"6b3f5af2-6c49-416e-a996-43f31f50a072"],
Cell[77152, 1869, 483, 11, 28, "Message",ExpressionUUID->"88099e59-7aaf-476e-8532-30f73b619f01"],
Cell[77638, 1882, 454, 10, 28, "Message",ExpressionUUID->"1ea6bcf7-01c5-4a33-ba34-c6efab549f41"],
Cell[78095, 1894, 457, 10, 28, "Message",ExpressionUUID->"52a5ce18-9f7e-4bf6-bc4b-61720548b276"],
Cell[78555, 1906, 456, 10, 28, "Message",ExpressionUUID->"bbfbbc35-1341-4fd0-bd5a-96af8141188e"],
Cell[79014, 1918, 450, 10, 28, "Message",ExpressionUUID->"926be006-a60e-4fb3-bffd-d8bd09b87774"],
Cell[79467, 1930, 488, 11, 28, "Message",ExpressionUUID->"af336c02-7dfa-46d0-833f-90ff78534000"],
Cell[79958, 1943, 455, 10, 28, "Message",ExpressionUUID->"f14bdeb3-7158-42e2-a6f4-fa77a623a9cf"],
Cell[80416, 1955, 456, 10, 28, "Message",ExpressionUUID->"01eee32d-5cf6-45f0-9cc7-76b85dbc8708"],
Cell[80875, 1967, 456, 10, 28, "Message",ExpressionUUID->"0ff7faf6-b964-400b-a569-95837082f612"],
Cell[81334, 1979, 452, 10, 28, "Message",ExpressionUUID->"159ace04-beab-4623-8f34-030bf4eee374"],
Cell[81789, 1991, 2257, 35, 113, "Message",ExpressionUUID->"c3f3ea56-2a9e-466f-a749-fcaa59d0e561"],
Cell[84049, 2028, 1861, 30, 101, "Message",ExpressionUUID->"421f92b5-c896-4a84-a55f-fb5473b1814d"],
Cell[85913, 2060, 451, 10, 28, "Message",ExpressionUUID->"c11c5022-8f87-4f49-8e67-5e1bc1618e98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86401, 2075, 1243, 30, 124, "Input",ExpressionUUID->"cb3e0fc5-e239-4fa2-8956-c4e4d9bb97c7"],
Cell[87647, 2107, 389, 9, 28, "Message",ExpressionUUID->"758ba8e3-7814-41d3-b7de-fdaf870f4c30"],
Cell[88039, 2118, 502, 11, 28, "Message",ExpressionUUID->"ed16295f-4809-4b12-9a30-2f19d3bf9632"],
Cell[88544, 2131, 388, 9, 28, "Message",ExpressionUUID->"34d7a99e-d053-4a5a-aac3-5a315b5b6f1b"],
Cell[88935, 2142, 454, 10, 28, "Message",ExpressionUUID->"d3a89d28-47e8-4791-96a2-881d7b7286a6"],
Cell[89392, 2154, 9805, 219, 377, "Output",ExpressionUUID->"4f1f3afd-c8fb-4fb4-9e8d-de4394edac3b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99234, 2378, 1064, 26, 86, "Input",ExpressionUUID->"74b00150-5abb-4cc8-95fc-80e5962f7c5c"],
Cell[100301, 2406, 391, 9, 28, "Message",ExpressionUUID->"b3e0a95f-2c41-47a2-bae6-3c401b8eb66a"],
Cell[100695, 2417, 502, 11, 28, "Message",ExpressionUUID->"7473dafb-e50e-49fe-8ac5-3736b12d9152"],
Cell[101200, 2430, 390, 9, 28, "Message",ExpressionUUID->"f1fb0382-e1b3-4d3d-a855-16d544ee35c1"],
Cell[101593, 2441, 452, 10, 28, "Message",ExpressionUUID->"c5fdbec6-ca5c-41d7-bea1-7fba3b119146"],
Cell[102048, 2453, 2854, 44, 173, "Message",ExpressionUUID->"ea13ac1f-53d9-46d3-bb81-bc55c78a5f45"],
Cell[104905, 2499, 5570, 154, 202, "Output",ExpressionUUID->"723ac7c6-74fc-4522-bcd1-9358d39c56e2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[110524, 2659, 166, 3, 45, "Subsubsection",ExpressionUUID->"d5b22986-f191-4168-8cbd-3d138fcef4f3"],
Cell[110693, 2664, 623, 13, 48, "Input",ExpressionUUID->"cb0a2943-18a1-4cf6-836e-f3f240885a6f"],
Cell[CellGroupData[{
Cell[111341, 2681, 311, 6, 28, "Input",ExpressionUUID->"24a3fba4-e601-4bd9-b6ce-481ceaf93404"],
Cell[111655, 2689, 614, 13, 46, "Message",ExpressionUUID->"832660d2-ce91-47c7-beb5-210cb2a155fe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112306, 2707, 1341, 31, 162, "Input",ExpressionUUID->"51433e1e-a20e-4787-89f0-b80454a0cefa"],
Cell[113650, 2740, 391, 9, 28, "Message",ExpressionUUID->"8a1ea3c9-e6fa-4a92-84d6-8f4e4ff401aa"],
Cell[114044, 2751, 502, 11, 28, "Message",ExpressionUUID->"a064de8a-7919-40c9-a72f-04a0ee0e2159"],
Cell[114549, 2764, 388, 9, 28, "Message",ExpressionUUID->"777e4b8e-956f-401b-a36c-40d0e7356a23"],
Cell[114940, 2775, 452, 10, 28, "Message",ExpressionUUID->"fbb8596a-2d31-43a5-be04-031d919a3017"],
Cell[115395, 2787, 2193, 36, 184, "Message",ExpressionUUID->"efd23a6d-2e0a-4944-888d-53bcf1c38815"],
Cell[117591, 2825, 11937, 302, 280, "Output",ExpressionUUID->"c5a1eda5-4f1b-4433-8ef4-682bedbbe839"]
}, Open  ]],
Cell[129543, 3130, 1644, 43, 143, "Input",ExpressionUUID->"8953a462-8afc-47c2-8017-6dd4e1e271aa"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[131236, 3179, 164, 3, 54, "Subsection",ExpressionUUID->"b30cdcd0-07ca-4da4-95d3-8771a32923f9"],
Cell[CellGroupData[{
Cell[131425, 3186, 273, 4, 45, "Subsubsection",ExpressionUUID->"12096f98-c9ed-4b0c-a51f-09bcc71f0ee3"],
Cell[131701, 3192, 591, 10, 28, "Input",ExpressionUUID->"a2438075-0a9d-4410-b2dc-f599fa09b3c7"],
Cell[132295, 3204, 1697, 38, 48, "Input",ExpressionUUID->"f95b3fb1-ecd8-43dc-863a-414998fb7c2a"],
Cell[CellGroupData[{
Cell[134017, 3246, 3785, 102, 276, "Input",ExpressionUUID->"a729648a-8239-451a-bff9-d98660e89aa5"],
Cell[137805, 3350, 1704, 27, 65, "Message",ExpressionUUID->"770fb255-8630-4e46-b1ae-e1900dad2053"],
Cell[139512, 3379, 1704, 27, 65, "Message",ExpressionUUID->"3c3e5911-e767-4129-8919-d046db487461"],
Cell[141219, 3408, 2446, 37, 104, "Message",ExpressionUUID->"d58f134e-024f-42a2-8aff-0cd1889574e3"],
Cell[143668, 3447, 1702, 27, 65, "Message",ExpressionUUID->"a558d4ee-2985-43f4-b0ef-e38a92194f31"],
Cell[145373, 3476, 2420, 37, 108, "Message",ExpressionUUID->"62458798-929f-48ca-ae4b-d38299c4c792"],
Cell[147796, 3515, 1702, 27, 65, "Message",ExpressionUUID->"7f86f395-b8e4-4f7c-91c2-1fee8436267a"],
Cell[149501, 3544, 457, 10, 46, "Message",ExpressionUUID->"13606430-63ed-423d-9f20-d7d17d867ead"],
Cell[149961, 3556, 2420, 37, 108, "Message",ExpressionUUID->"147fa611-c57a-4edd-a6da-28bd65b5484d"],
Cell[152384, 3595, 458, 10, 46, "Message",ExpressionUUID->"df922885-80ea-4c39-9939-838c24133bf4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152879, 3610, 182, 2, 28, "Input",ExpressionUUID->"2ca92df7-fc68-4aea-b85d-01aace17a949"],
Cell[153064, 3614, 10295, 256, 158, "Output",ExpressionUUID->"e419842a-52a1-4a2b-a215-23d165a6f53d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[163408, 3876, 166, 3, 45, "Subsubsection",ExpressionUUID->"22c41ed2-3bab-4671-8c9f-cd97e7050d5a"],
Cell[163577, 3881, 224, 4, 28, "Input",ExpressionUUID->"a0d42bc1-6476-4471-843b-61d010a52683"],
Cell[CellGroupData[{
Cell[163826, 3889, 573, 11, 48, "Input",ExpressionUUID->"1f108619-b55d-4770-90dd-b9c6934c063e"],
Cell[164402, 3902, 595, 12, 46, "Message",ExpressionUUID->"e895f0c7-98f9-4d7e-bc7b-adf818938382"],
Cell[165000, 3916, 459, 10, 28, "Message",ExpressionUUID->"a26eda67-b87e-421c-b88c-6b3614ff0a88"],
Cell[165462, 3928, 491, 11, 28, "Message",ExpressionUUID->"942f0052-77fb-433d-9e57-06fda8a34b01"],
Cell[165956, 3941, 482, 11, 28, "Message",ExpressionUUID->"5871614d-6101-486d-8f6d-469e22688c94"],
Cell[166441, 3954, 454, 10, 28, "Message",ExpressionUUID->"493ffad3-7a71-46f7-8691-484fd490a266"],
Cell[166898, 3966, 459, 10, 28, "Message",ExpressionUUID->"d6e18e05-4b52-4fe2-aa57-84734c6b50ad"],
Cell[167360, 3978, 458, 10, 28, "Message",ExpressionUUID->"ccbd5fd4-7341-4dbb-bfc5-94808c772879"],
Cell[167821, 3990, 450, 10, 28, "Message",ExpressionUUID->"7f204e7d-f12a-46cf-bbae-dc91ebe3e054"],
Cell[168274, 4002, 490, 11, 28, "Message",ExpressionUUID->"4bfc16f4-d416-4c24-8318-d79efb6792e2"],
Cell[168767, 4015, 453, 10, 28, "Message",ExpressionUUID->"781e1d08-abb6-4aa4-879a-0c49eb2355fe"],
Cell[169223, 4027, 453, 10, 28, "Message",ExpressionUUID->"33cddeed-8e4b-4037-bc57-0732090928ac"],
Cell[169679, 4039, 456, 10, 28, "Message",ExpressionUUID->"d2d444da-777c-4dc6-aec9-724e8389018c"],
Cell[170138, 4051, 454, 10, 28, "Message",ExpressionUUID->"8c3d9635-15f2-4299-a8f7-287ec2fa2a66"],
Cell[170595, 4063, 2445, 37, 104, "Message",ExpressionUUID->"dc0f11cc-5d6c-481e-a686-16765aa4d0d6"],
Cell[173043, 4102, 2420, 37, 108, "Message",ExpressionUUID->"ac6f0bf3-5729-4849-9321-3f71c5aa9d1c"],
Cell[175466, 4141, 2420, 37, 108, "Message",ExpressionUUID->"be90fc06-28a4-459d-aad1-30c64f3c10d9"],
Cell[177889, 4180, 460, 10, 46, "Message",ExpressionUUID->"b93fd9ba-dcef-4f89-bd03-c2759479faba"],
Cell[178352, 4192, 601, 12, 46, "Message",ExpressionUUID->"1c3ae3f9-f8de-4af6-aeb8-fc93a2432cbd"],
Cell[178956, 4206, 601, 12, 46, "Message",ExpressionUUID->"a697ecb2-1160-4065-8e5c-8dc1a4f3b655"],
Cell[179560, 4220, 451, 10, 28, "Message",ExpressionUUID->"355b7d6d-26c2-4bb0-8b4a-4fbb239794cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180048, 4235, 404, 8, 48, "Input",ExpressionUUID->"86ffd5d9-942f-4261-b5ee-89b568f7fc61"],
Cell[180455, 4245, 391, 9, 28, "Message",ExpressionUUID->"98fcf57f-97ad-43bf-a2e2-45d82cdb7ba5"],
Cell[180849, 4256, 502, 11, 28, "Message",ExpressionUUID->"a3dc8df5-9320-4980-a356-2670244262e1"],
Cell[181354, 4269, 388, 9, 28, "Message",ExpressionUUID->"aff1f859-2d3b-42cb-b549-31a804231c43"],
Cell[181745, 4280, 452, 10, 28, "Message",ExpressionUUID->"bf40ddfe-5d6b-438a-b8a8-dcc399c37587"],
Cell[182200, 4292, 11048, 333, 377, "Output",ExpressionUUID->"9005cd1e-5c3a-4dae-b9b7-c82e21c681b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[193285, 4630, 1424, 31, 105, "Input",ExpressionUUID->"9c2d9517-1690-43b4-a986-24f02ddcf54f"],
Cell[194712, 4663, 389, 9, 28, "Message",ExpressionUUID->"04e69fae-9ad3-4822-b52e-142112520ca5"],
Cell[195104, 4674, 504, 11, 28, "Message",ExpressionUUID->"3b56bc01-a2f1-4875-9b64-bb008fd02384"],
Cell[195611, 4687, 390, 9, 28, "Message",ExpressionUUID->"c945bf69-d247-410b-93ff-e56079d1dc3a"],
Cell[196004, 4698, 452, 10, 28, "Message",ExpressionUUID->"f48cb506-c2dc-4463-bcea-9ce9413a37ce"],
Cell[196459, 4710, 5198, 80, 192, "Message",ExpressionUUID->"8205e3ce-f8f4-4f69-883c-6438452e125e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[201706, 4796, 166, 3, 45, "Subsubsection",ExpressionUUID->"c6e0cb55-86e6-449f-be8d-8bcb2c9454e5"],
Cell[CellGroupData[{
Cell[201897, 4803, 1062, 27, 67, "Input",ExpressionUUID->"844d5003-ac54-4275-9f9f-b5634c45f3d9"],
Cell[202962, 4832, 2446, 37, 104, "Message",ExpressionUUID->"a0e303f8-86f0-4bf2-aa02-6c7c11ffe5ed"],
Cell[205411, 4871, 2420, 37, 108, "Message",ExpressionUUID->"36874d4c-fd83-4dad-b390-36bf753b659f"],
Cell[207834, 4910, 2420, 37, 108, "Message",ExpressionUUID->"7e8c379f-ee9a-4841-8e84-2460a1dfc360"],
Cell[210257, 4949, 460, 10, 46, "Message",ExpressionUUID->"f1acb646-5144-4895-816b-8745b6a57a3f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210754, 4964, 311, 6, 28, "Input",ExpressionUUID->"a15b96a1-2f6c-4d0d-a9ee-7aa32cf75f13"],
Cell[211068, 4972, 506, 11, 46, "Message",ExpressionUUID->"49121ba2-298c-4614-b314-91d5e3b9a844"],
Cell[211577, 4985, 2448, 37, 104, "Message",ExpressionUUID->"bda5758f-25d9-4ceb-9e61-affd326a8c1d"],
Cell[214028, 5024, 2418, 37, 108, "Message",ExpressionUUID->"3aa93de7-e37d-4722-a801-f6073efd3ced"],
Cell[216449, 5063, 2420, 37, 108, "Message",ExpressionUUID->"48c1dde3-a81d-422f-80a1-4b51107abe9b"],
Cell[218872, 5102, 458, 10, 46, "Message",ExpressionUUID->"36a481b8-723d-41e0-badd-a9c21697c72e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219367, 5117, 1368, 31, 143, "Input",ExpressionUUID->"59066f84-16e1-464f-b7f7-db6c3ccf977e"],
Cell[220738, 5150, 391, 9, 28, "Message",ExpressionUUID->"d6e8317d-be68-47ba-ae7a-5b770ba3ae18"],
Cell[221132, 5161, 502, 11, 28, "Message",ExpressionUUID->"53d5e5cd-7313-407c-8e3d-afb7fadb525d"],
Cell[221637, 5174, 388, 9, 28, "Message",ExpressionUUID->"3cae2609-b0be-46d0-a5b5-2f922bd17a37"],
Cell[222028, 5185, 454, 10, 28, "Message",ExpressionUUID->"63c665a8-6d96-4a6b-b2f6-c210377d4c81"],
Cell[222485, 5197, 1545, 28, 182, "Message",ExpressionUUID->"1a6e854c-ac4c-49f5-93d8-a174ea622398"],
Cell[224033, 5227, 2836, 75, 164, "Output",ExpressionUUID->"b44b23d2-68d5-4c1f-a8e2-4989b83750b2"]
}, Open  ]],
Cell[226884, 5305, 2962, 69, 162, "Input",ExpressionUUID->"75088ee7-36ef-4611-a2e6-e96f7d50f2ee"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

